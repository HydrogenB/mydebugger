"use strict";exports.id=326,exports.ids=[326],exports.modules={9326:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var s=r(6689),a=r(2791),n=r(2559),i=r(3539),l=r(997);let c=["variant","size","isLoading","isFullWidth","leftIcon","rightIcon","children","className","disabled"];function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var s,a;s=t,a=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let m=e=>{let{variant:t="primary",size:r="md",isLoading:s=!1,isFullWidth:a=!1,leftIcon:n,rightIcon:i,children:o,className:m="",disabled:g}=e,u=function(e,t){if(null==e)return{};var r,s,a=function(e,t){if(null==e)return{};var r,s,a={},n=Object.keys(e);for(s=0;s<n.length;s++)r=n[s],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,c),h=["font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-opacity-50 transition-colors",{primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-800",tertiary:"bg-transparent border border-gray-300 hover:bg-gray-100 text-gray-700",danger:"bg-red-600 hover:bg-red-700 text-white",ghost:"bg-transparent hover:bg-gray-100 text-gray-700"}[t],{sm:"py-1 px-3 text-sm",md:"py-2 px-4 text-base",lg:"py-3 px-6 text-lg"}[r],a?"w-full":"",g||s?"opacity-50 cursor-not-allowed":"",m].join(" ");return l.jsx("button",d(d({className:h,disabled:g||s},u),{},{children:s?(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-gray-300 border-t-white mr-2"}),o]}):(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[n&&l.jsx("span",{className:"mr-2",children:n}),o,i&&l.jsx("span",{className:"ml-2",children:i})]})}))},g=({size:e="md",color:t="currentColor",className:r=""})=>{let s=`animate-spin ${{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[e]} ${r}`;return(0,l.jsxs)("svg",{className:s,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:t,strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:t,d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},u=()=>{try{let e=localStorage.getItem("clickjacking-history");return e?JSON.parse(e):[]}catch(e){return console.error("Error loading validation history:",e),[]}},h=e=>{try{let t=u(),r=[{id:Date.now().toString(),result:e},...t].slice(0,20);return localStorage.setItem("clickjacking-history",JSON.stringify(r)),r}catch(e){return console.error("Error saving to history:",e),u()}},x=()=>{try{return localStorage.removeItem("clickjacking-history"),[]}catch(e){return console.error("Error clearing history:",e),[]}},y=e=>e?(e=e.trim()).startsWith("http://")||e.startsWith("https://")?e:`https://${e}`:"";function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){var s,a;s=t,a=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let b=e=>{let{0:t,1:r}=(0,s.useState)(e||""),{0:a,1:n}=(0,s.useState)(""),{0:i,1:l}=(0,s.useState)(!1),{0:c,1:o}=(0,s.useState)(null),{0:d,1:m}=(0,s.useState)(null),{0:g,1:p}=(0,s.useState)([]),{0:b,1:j}=(0,s.useState)(!1),{0:k,1:v}=(0,s.useState)(!1);(0,s.useEffect)(()=>{p(u()),e&&r(e)},[e]),(0,s.useEffect)(()=>{n(y(t))},[t]);let w=(0,s.useCallback)(async()=>{if(!a){m("Please enter a URL");return}l(!0),m(null),o(null);try{let e=await fetch("/api/security/clickjacking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:a})});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to validate URL")}let t=await e.json(),r=f(f({},t),{},{timestamp:new Date});o(r);let s=h(r);p(s)}catch(e){m(e instanceof Error?e.message:"An unexpected error occurred")}finally{l(!1)}},[a]),N=(0,s.useCallback)(e=>{r(e.result.url),o(e.result)},[]);return{url:t,formattedUrl:a,loading:i,result:c,error:d,history:g,showHistory:b,showHelp:k,setUrl:r,validateUrl:w,loadFromHistory:N,clearHistory:(0,s.useCallback)(()=>{p(x())},[]),setShowHistory:j,setShowHelp:v}},j=()=>{let e=(0,n.C5)("/clickjacking"),{url:t,setUrl:r,loading:c,result:o,error:d,history:u,validateUrl:h}=b(),{0:x,1:y}=(0,s.useState)(!1),{0:p,1:f}=(0,s.useState)(!1),j=(0,s.useRef)(null),k="Click Jacking Validator | MyDebugger",v="Test if a website is vulnerable to click jacking attacks by examining headers and framing capability.",w=e=>{try{return new URL(e),!0}catch(e){return!1}},N=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:`https://${e}`:"",O=async()=>{setLoading(!0),setError(null),setResults(null),f(!1),y(!1);let e=N(t);if(!w(e)){setError("Please enter a valid URL"),setLoading(!1);return}try{let t=`/api/clickjacking-analysis?url=${encodeURIComponent(e)}`,r={url:e,headers:{},canBeFramed:!0,frameLoaded:!1,timestamp:new Date},s=await fetch(t);if(!s.ok){let e=await s.json();throw Error(e.error||`Server returned ${s.status}`)}let a=await s.json();r.statusCode=a.status,r.statusText=a.statusText,a.headers["x-frame-options"]&&(r.headers["x-frame-options"]=a.headers["x-frame-options"]),a.headers["content-security-policy"]&&(r.headers["content-security-policy"]=a.headers["content-security-policy"]),a.clickjackingProtection&&a.clickjackingProtection.frameAncestorsValue&&(r.headers["frame-ancestors"]=a.clickjackingProtection.frameAncestorsValue),r.canBeFramed=!a.clickjackingProtection.protected,r.canBeFramed?a.recommendations&&a.recommendations.length&&(r.message=`Recommendations: ${a.recommendations.join("; ")}`):a.clickjackingProtection.hasXFrameOptions?r.message=`X-Frame-Options header is set to ${a.headers["x-frame-options"]}`:a.clickjackingProtection.hasCSPProtection?r.message=`Content-Security-Policy header restricts framing with: ${a.clickjackingProtection.frameAncestorsValue}`:r.message="Site is protected against clickjacking",setResults(r)}catch(e){setError(`Error validating website: ${e instanceof Error?e.message:"Unknown error"}`)}finally{setLoading(!1)}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.Helmet,{children:[l.jsx("title",{children:k}),l.jsx("meta",{name:"description",content:v}),l.jsx("meta",{property:"og:title",content:k}),l.jsx("meta",{property:"og:description",content:v}),l.jsx("meta",{property:"og:type",content:"website"}),l.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/clickjacking"}),l.jsx("meta",{name:"twitter:card",content:"summary"}),l.jsx("meta",{name:"twitter:title",content:k}),l.jsx("meta",{name:"twitter:description",content:v}),l.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/clickjacking"})]}),l.jsx(i.Sj,{tool:e,children:(0,l.jsxs)("div",{className:"space-y-6",children:[l.jsx(i.Zb,{isElevated:!0,children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{htmlFor:"url-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Enter website URL to check for click jacking vulnerabilities"}),(0,l.jsxs)("div",{className:"flex",children:[l.jsx("input",{id:"url-input",type:"text",className:"flex-grow rounded-l-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:border-primary-500 focus:ring focus:ring-primary-200 dark:focus:ring-primary-900 focus:ring-opacity-50",placeholder:"example.com",value:t,onChange:e=>r(e.target.value),onKeyPress:e=>{"Enter"===e.key&&O()},disabled:c}),l.jsx(m,{onClick:O,isLoading:c,disabled:c||!t,className:"rounded-l-none",children:"Check"})]}),l.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Enter a URL to check if it's vulnerable to click jacking attacks"})]}),d&&l.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md text-red-700 dark:text-red-400 text-sm",children:d}),c&&l.jsx("div",{className:"flex justify-center py-8",children:l.jsx(g,{})}),results&&!c&&(0,l.jsxs)("div",{className:"animate-fade-in space-y-6",children:[(0,l.jsxs)("div",{className:"p-4 rounded-md border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"font-medium text-lg mb-3 text-gray-800 dark:text-gray-200",children:"Summary"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"p-3 rounded-md bg-gray-50 dark:bg-gray-800",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"font-medium",children:"URL"}),l.jsx("a",{href:results.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 text-sm",children:"Visit Site â†—"})]}),l.jsx("div",{className:"mt-1 text-sm break-all",children:results.url})]}),(0,l.jsxs)("div",{className:`p-3 rounded-md ${results.canBeFramed?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"}`,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("span",{className:"font-medium",children:"Click Jacking Protection"}),results.canBeFramed?l.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 rounded-full",children:"Vulnerable"}):l.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Protected"})]}),l.jsx("div",{className:"mt-1 text-sm",children:results.canBeFramed?"This site may be vulnerable to click jacking attacks":"This site is protected against click jacking"})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[l.jsx("h4",{className:"font-medium text-md mb-2 text-gray-800 dark:text-gray-200",children:"Security Headers"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{className:"font-medium",children:"X-Frame-Options"}),results.headers["x-frame-options"]?l.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Present"}):l.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 rounded-full",children:"Missing"})]}),(0,l.jsxs)("div",{className:"mt-1 text-sm",children:[results.headers["x-frame-options"]||"Not specified",!results.headers["x-frame-options"]&&l.jsx("p",{className:"text-xs mt-1 text-yellow-600 dark:text-yellow-400",children:'Recommendation: Add X-Frame-Options header with value "DENY" or "SAMEORIGIN"'})]})]}),(0,l.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{className:"font-medium",children:"CSP frame-ancestors"}),results.headers["frame-ancestors"]?l.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Present"}):l.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 rounded-full",children:"Missing"})]}),(0,l.jsxs)("div",{className:"mt-1 text-sm",children:[results.headers["frame-ancestors"]||"Not specified",!results.headers["frame-ancestors"]&&l.jsx("p",{className:"text-xs mt-1 text-yellow-600 dark:text-yellow-400",children:"Recommendation: Add Content-Security-Policy header with frame-ancestors directive set to \"'none'\" or \"'self'\""})]})]})]})]})]}),(0,l.jsxs)("div",{className:"p-4 rounded-md border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"font-medium text-lg mb-3 text-gray-800 dark:text-gray-200",children:"iframe Test"}),l.jsx("div",{className:"mb-3 text-sm text-gray-600 dark:text-gray-400",children:"This test attempts to load the website in an iframe. If the website has click jacking protection, the iframe should not display content."}),l.jsx("div",{className:"relative rounded-md overflow-hidden border border-gray-300 dark:border-gray-600",style:{height:"400px"},children:c?l.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50 dark:bg-gray-800",children:l.jsx(g,{})}):(0,l.jsxs)(l.Fragment,{children:[l.jsx("iframe",{ref:j,src:results.url,className:"w-full h-full",onLoad:handleIframeLoad,onError:handleIframeError,sandbox:"allow-same-origin allow-scripts",title:"Click Jacking Test"}),x&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50/90 dark:bg-gray-800/90",children:(0,l.jsxs)("div",{className:"text-center p-4",children:[l.jsx("div",{className:"text-red-500 dark:text-red-400 mb-2",children:l.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),l.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Failed to load content"}),l.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"The website could not be loaded in an iframe, which may indicate click jacking protection."})]})}),!x&&p&&l.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-500 text-white text-center py-1 text-sm",children:"This website can be embedded in iframes (potentially vulnerable to click jacking)"})]})})]})]}),results&&l.jsx("div",{className:"flex justify-center pt-2",children:l.jsx(m,{onClick:()=>{r(""),setResults(null),setError(null),f(!1),y(!1)},variant:"light",children:"Test Another Site"})})]})}),l.jsx(i.Zb,{title:"About Click Jacking",isElevated:!0,children:(0,l.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[l.jsx("p",{children:"Click jacking is a malicious technique where an attacker tricks a user into clicking something different from what they perceive, potentially causing them to perform unintended actions."}),l.jsx("h3",{children:"How Click Jacking Works"}),l.jsx("p",{children:"In a typical click jacking attack, the attacker loads the target website in a transparent iframe and overlays it with their own content. When users think they are clicking on the visible content, they are actually clicking on elements in the invisible, target website."}),l.jsx("h3",{children:"Protection Methods"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[l.jsx("strong",{children:"X-Frame-Options Header:"})," Prevents a webpage from being displayed in a frame. Values include:",(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[l.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"DENY"})," - prevents any domain from framing the content"]}),(0,l.jsxs)("li",{children:[l.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"SAMEORIGIN"})," - allows framing by the same site"]}),(0,l.jsxs)("li",{children:[l.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"ALLOW-FROM uri"})," - permits specified origins to frame"]})]})]}),(0,l.jsxs)("li",{children:[l.jsx("strong",{children:"Content Security Policy (frame-ancestors):"})," Modern alternative to X-Frame-Options that provides more flexibility. Examples:",(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[l.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"frame-ancestors 'none'"})," - prevents any framing"]}),(0,l.jsxs)("li",{children:[l.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"frame-ancestors 'self'"})," - allows same-origin framing only"]})]})]})]})]})})]})})]})}}};