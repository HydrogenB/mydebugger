"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[889],{5889:function(e,r,t){t.r(r),t.d(r,{default:function(){return _}});var s=t(7294),a=t(4593),n=t(6738),i=t(1579),l=t(8058),d=t(6835),c=t(29),o=t(7812),m=t(8307),u=t(4687),x=t.n(u),h=t(6961);t(9704);var p=t(5893);function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,s)}return t}function b(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach(function(r){(0,m.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var y={token:"",decoded:null,isVerified:null,verificationKey:"",error:null,history:[],securityIssues:[],parsingWarnings:[]};function f(e,r){switch(r.type){case"SET_TOKEN":return b(b({},e),{},{token:r.payload});case"SET_DECODED":return b(b({},e),{},{decoded:r.payload});case"SET_VERIFIED":return b(b({},e),{},{isVerified:r.payload});case"SET_VERIFICATION_KEY":return b(b({},e),{},{verificationKey:r.payload});case"SET_ERROR":return b(b({},e),{},{error:r.payload});case"ADD_HISTORY_ITEM":return b(b({},e),{},{history:[r.payload].concat((0,o.Z)(e.history.filter(function(e){return e.id!==r.payload.id}))).slice(0,10)});case"CLEAR_HISTORY":return b(b({},e),{},{history:[]});case"REMOVE_HISTORY_ITEM":return b(b({},e),{},{history:e.history.filter(function(e){return e.id!==r.payload})});case"SET_SECURITY_ISSUES":return b(b({},e),{},{securityIssues:r.payload});case"SET_PARSING_WARNINGS":return b(b({},e),{},{parsingWarnings:r.payload});case"RESET":return y;default:return e}}var j=(0,s.createContext)(void 0),v=function(e){var r,a,n,i=e.children,l=(0,s.useReducer)(f,y),d=l[0],o=l[1];s.useEffect(function(){b()},[]),s.useEffect(function(){try{localStorage.setItem("jwt.history",JSON.stringify(d.history))}catch(e){console.error("Failed to save JWT history:",e)}},[d.history]),s.useEffect(function(){try{var e=localStorage.getItem("jwt.history");e&&JSON.parse(e).forEach(function(e){o({type:"ADD_HISTORY_ITEM",payload:e})})}catch(e){console.error("Failed to load JWT history:",e)}},[]);var m=(r=(0,c.Z)(x().mark(function e(r){var s,a,n,i,l,d,c;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=6;break}return o({type:"SET_DECODED",payload:null}),o({type:"SET_ERROR",payload:null}),o({type:"SET_VERIFIED",payload:null}),o({type:"SET_PARSING_WARNINGS",payload:[]}),e.abrupt("return");case 6:return e.prev=6,(r=r.trim()).toLowerCase().startsWith("bearer ")&&(r=r.substring(7).trim()),e.next=11,t.e(23).then(t.bind(t,23));case 11:return s=e.sent,e.next=14,s.decode(r);case 14:if(a=e.sent,n=[],a.error&&n.push(a.error),!(a.header&&a.payload&&a.signature)){e.next=29;break}d={header:a.header,payload:a.payload,signature:a.signature,raw:a.raw},o({type:"SET_TOKEN",payload:r}),o({type:"SET_DECODED",payload:d}),o({type:"SET_ERROR",payload:null}),o({type:"SET_PARSING_WARNINGS",payload:n}),o({type:"SET_VERIFIED",payload:null}),c=(null===(i=a.payload)||void 0===i?void 0:i.sub)||(null===(l=a.payload)||void 0===l?void 0:l.name)||"Token ".concat(new Date().toLocaleDateString()),o({type:"ADD_HISTORY_ITEM",payload:{id:Math.random().toString(36).substring(2,9),token:r,timestamp:Date.now(),label:c}}),g(r),e.next=30;break;case 29:throw Error("Failed to decode JWT: Invalid token structure");case 30:e.next=38;break;case 32:e.prev=32,e.t0=e.catch(6),o({type:"SET_ERROR",payload:e.t0 instanceof Error?e.t0.message:"Failed to decode JWT"}),o({type:"SET_DECODED",payload:null}),o({type:"SET_VERIFIED",payload:null}),o({type:"SET_PARSING_WARNINGS",payload:[]});case 38:case"end":return e.stop()}},e,null,[[6,32]])})),function(e){return r.apply(this,arguments)}),u=(a=(0,c.Z)(x().mark(function e(r,s){var a,n;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!d.token||!s)){e.next=3;break}return o({type:"SET_VERIFIED",payload:null}),e.abrupt("return");case 3:return e.prev=3,e.next=6,t.e(23).then(t.bind(t,23));case 6:return a=e.sent,e.next=9,a.verify(d.token,s);case 9:n=e.sent,o({type:"SET_VERIFICATION_KEY",payload:s}),o({type:"SET_VERIFIED",payload:n}),!n&&d.decoded&&r&&d.decoded.header.alg!==r?o({type:"SET_ERROR",payload:"Algorithm mismatch: Token uses ".concat(d.decoded.header.alg," but ").concat(r," was specified for verification")}):n?o({type:"SET_ERROR",payload:null}):o({type:"SET_ERROR",payload:"Signature verification failed"}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),o({type:"SET_ERROR",payload:e.t0 instanceof Error?e.t0.message:"Failed to verify signature"}),o({type:"SET_VERIFIED",payload:!1});case 19:case"end":return e.stop()}},e,null,[[3,15]])})),function(e,r){return a.apply(this,arguments)}),g=function(e){if(d.decoded){var r=[];if("none"===d.decoded.header.alg&&r.push({id:"alg-none",severity:"high",title:"UNSIGNED TOKEN",description:'The token uses algorithm "none" and has no signature. Do not accept in production.'}),d.decoded.payload.exp){var t=1e3*d.decoded.payload.exp;Date.now()>t&&r.push({id:"token-expired",severity:"medium",title:"Token Expired",description:"Token expired on ".concat(new Date(t).toLocaleString(),".")}),t-Date.now()<864e5&&Date.now()<t&&r.push({id:"token-expiring",severity:"low",title:"Token Expiring Soon",description:"Token will expire on ".concat(new Date(t).toLocaleString(),".")})}else r.push({id:"no-expiration",severity:"medium",title:"No Expiration Time",description:"This token has no expiration time (exp claim), which is not recommended."});if(d.decoded.header.alg&&(["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512"].includes(d.decoded.header.alg)?["HS256","RS256"].includes(d.decoded.header.alg)&&r.push({id:"weak-algorithm",severity:"info",title:"Consider Stronger Algorithm",description:"Algorithm ".concat(d.decoded.header.alg," is widely used but consider stronger alternatives like ES256 or PS256 for better security.")}):r.push({id:"unsupported-algorithm",severity:"high",title:"Unsupported Algorithm",description:"Algorithm ".concat(d.decoded.header.alg," is not among the standard supported JWT algorithms.")})),!d.decoded.header.alg||d.decoded.header.alg.startsWith("HS")||d.decoded.header.kid||r.push({id:"missing-kid",severity:"low",title:"Missing Key Identifier",description:'This token uses an asymmetric algorithm but has no "kid" (key ID) claim in the header.'}),d.decoded.payload.iat&&"number"!=typeof d.decoded.payload.iat&&r.push({id:"invalid-iat",severity:"medium",title:"Invalid Issued At Claim",description:'The "iat" claim should be a numeric timestamp.'}),d.decoded.payload.nbf){var s=1e3*d.decoded.payload.nbf;s>Date.now()&&r.push({id:"future-nbf",severity:"medium",title:"Token Not Yet Valid",description:"This token is not valid until ".concat(new Date(s).toLocaleString(),".")})}o({type:"SET_SECURITY_ISSUES",payload:r})}},b=(n=(0,c.Z)(x().mark(function e(){var r,t;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=window.location.hash.substring(1))){e.next=13;break}if(e.prev=2,!(t=(0,h.decompressFromEncodedURIComponent)(r))){e.next=8;break}return e.next=7,m(t);case 7:return e.abrupt("return",!0);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("Failed to load token from URL hash:",e.t0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,null,[[2,10]])})),function(){return n.apply(this,arguments)});return(0,p.jsx)(j.Provider,{value:{state:d,dispatch:o,decodeToken:m,verifySignature:u,analyzeToken:g,shareToken:function(){if(!d.token)return window.location.href.split("#")[0];var e=(0,h.compressToEncodedURIComponent)(d.token);return"".concat(window.location.href.split("#")[0],"#").concat(e)},loadFromHash:b},children:i})},k=function(){var e=(0,s.useContext)(j);if(void 0===e)throw Error("useJwt must be used within a JwtProvider");return e},N=function(){var e,r,t,s,a,n,l,c,o=k(),m=o.state,u=o.decodeToken,x=o.verifySignature;o.clearState;var h=m.token,g=m.decoded,b=m.error,y=m.isVerified,f=m.verificationKey,j=m.securityIssues;!function(){if(g&&null!=j&&j.length){var e=100;j.forEach(function(r){switch(r.severity){case"high":e-=25;break;case"medium":e-=10;break;case"low":e-=5;break;case"info":e-=0}})}}(),useEffect(function(){setJwtToken(h)},[h]),useEffect(function(){setSecret(f)},[f]),useEffect(function(){var e=setTimeout(function(){jwtToken!==h&&u(jwtToken)},300);return function(){return clearTimeout(e)}},[jwtToken,h,u]),useEffect(function(){if(copied){var e=setTimeout(function(){setCopied(!1),setCopiedSection(null)},2e3);return function(){return clearTimeout(e)}}},[copied]),useEffect(function(){if(null!=g&&g.header&&null!=g&&g.payload){var e=setTimeout(function(){setShowIterationTooltip(!0)},1e3);return function(){return clearTimeout(e)}}setShowIterationTooltip(!1)},[g]);var v=function(e,r){navigator.clipboard.writeText(e),setCopied(!0),setCopiedSection(r)},N=function(){Date.now(),crypto.randomUUID().replace(/-/g,""),setJwtToken("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImV4YW1wbGUta2V5LWlkIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiZW1haWwiOiJqb2huLmRvZUBleGFtcGxlLmNvbSIsImlzcyI6Imh0dHBzOi8vYXV0aC5leGFtcGxlLmNvbSIsImF1ZCI6ImNsaWVudC1pZC0xMjMiLCJpYXQiOjE2ODMyMDM1MjQsImV4cCI6MTY4MzIwNzEyNCwibmJmIjoxNjgzMjAzNTI0LCJqdGkiOiI4OTg5OGVlOGQ1YjI0ZjdkYjkzM2MwZGFiZDQzMWJjOCIsImdpdmVuX25hbWUiOiJKb2huIiwiZmFtaWx5X25hbWUiOiJEb2UiLCJuaWNrbmFtZSI6IkpvaG5ueSIsInByZWZlcnJlZF91c2VybmFtZSI6ImpvaG4uZG9lIiwicGljdHVyZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vcHJvZmlsZS9qb2huZG9lLmpwZyIsIndlYnNpdGUiOiJodHRwczovL2pvaG5kb2UuZXhhbXBsZS5jb20iLCJnZW5kZXIiOiJtYWxlIiwiYmlydGhkYXRlIjoiMTk5MC0wMS0wMSIsInBob25lX251bWJlciI6IisxLTIwMi01NTUtMDEyMyIsImFkZHJlc3MiOnsic3RyZWV0X2FkZHJlc3MiOiIxMjMgTWFpbiBTdCIsImxvY2FsaXR5IjoiQW55dG93biIsInJlZ2lvbiI6IlN0YXRlIiwicG9zdGFsX2NvZGUiOiIxMjM0NSIsImNvdW50cnkiOiJVUyJ9LCJyb2xlcyI6WyJ1c2VyIiwiYWRtaW4iXSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImF1dGhfdGltZSI6MTY4MzIwMzIyNCwic2lkIjoic2Vzc2lvbl9pZF8xMjM0NTYiLCJhbXIiOlsicHdkIl0sImF6cCI6ImF1dGhvcml6ZWQtcGFydHktMTIzIn0.xlj7zV5XM7XQg6qNTDxXkpnyb9-4k9JSbzWl6YCGrX4")},S=function(e){try{return new Date(1e3*e).toLocaleString()}catch(e){return"Invalid date"}},w=function(e){return Date.now()>1e3*e},T=function(e){switch(e){case"sub":return"Subject (user) identifier";case"iss":return"Issuer of the token";case"aud":return"Audience the token is intended for";case"exp":return"Expiration time (when token becomes invalid)";case"nbf":return"Not before time (when token starts being valid)";case"iat":return"Issued at time (when token was issued)";case"jti":return"JWT ID (unique identifier for this token)";case"name":return"User name";case"given_name":return"User first name";case"family_name":return"User last name";case"email":return"User email address";case"roles":return"User roles/permissions";case"scope":return"OAuth 2.0 scopes";case"sid":return"Session ID";case"auth_time":return"Time when authentication occurred";default:return"Custom claim"}},C=function(e){switch(e){case"header":return"text-blue-600 dark:text-blue-400";case"payload":return"text-purple-600 dark:text-purple-400";case"signature":return"text-red-600 dark:text-red-400";default:return"text-gray-600"}},I=function(e){switch(e){case"high":return"text-red-600 dark:text-red-400";case"medium":return"text-orange-600 dark:text-orange-400";case"low":return"text-yellow-600 dark:text-yellow-400";case"info":return"text-blue-600 dark:text-blue-400";default:return"text-gray-600 dark:text-gray-400"}},E="JWT Decoder | MyDebugger",A="Decode and verify JSON Web Tokens. Analyze headers, payload claims, and verify signatures securely in your browser.";return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(Helmet,{children:[(0,p.jsx)("title",{children:E}),(0,p.jsx)("meta",{name:"description",content:A}),(0,p.jsx)("meta",{property:"og:title",content:E}),(0,p.jsx)("meta",{property:"og:description",content:A}),(0,p.jsx)("meta",{property:"og:type",content:"website"}),(0,p.jsx)("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),(0,p.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,p.jsx)("meta",{name:"twitter:title",content:E}),(0,p.jsx)("meta",{name:"twitter:description",content:A}),(0,p.jsx)("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),(0,p.jsx)("div",{className:"flex justify-center",children:(0,p.jsxs)("div",{className:"w-full max-w-5xl px-4 py-6",children:[(0,p.jsxs)("div",{className:"text-center mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"JSON Web Token (JWT) Debugger"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Decode, verify, and analyze JSON Web Tokens (JWT) instantly. All processing happens in your browser."})]}),(0,p.jsx)("div",{className:"mb-6 bg-yellow-50 dark:bg-yellow-900/20 p-4 border border-yellow-200 dark:border-yellow-800 rounded-md",children:(0,p.jsxs)("p",{className:"text-yellow-800 dark:text-yellow-200 flex items-center justify-center",children:[(0,p.jsx)("span",{className:"mr-2",children:"\uD83D\uDD12"}),(0,p.jsx)("span",{className:"font-bold",children:"For your protection:"})," All JWT debugging and validation happens entirely in your browser. Your tokens and keys are never sent to any server."]})}),(0,p.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,p.jsx)("div",{children:(0,p.jsxs)(i.Zb,{isElevated:!0,className:"h-full flex flex-col",children:[(0,p.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,p.jsx)("h2",{className:"text-xl font-semibold",children:"Encoded JWT"}),(0,p.jsx)(Button,{onClick:N,variant:"light",size:"sm",children:"Generate example"})]}),(0,p.jsxs)("div",{className:"p-4 flex-1 flex flex-col",children:[(0,p.jsx)("textarea",{id:"jwt-input",className:"w-full font-mono text-sm rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 flex-1 min-h-[300px]",value:jwtToken,onChange:function(e){return setJwtToken(e.target.value)},placeholder:"Paste your JWT token here... (supports Bearer tokens and plain JWT)",autoFocus:!0,spellCheck:"false"}),showIterationTooltip&&g&&(0,p.jsx)("div",{className:"mt-4 flex justify-end",children:(0,p.jsx)(Tooltip,{content:(a=[],null!=g&&g.header&&!y&&a.push((0,p.jsx)("li",{children:"Try to verify the token signature with a secret or public key"},"verify")),((null==g||null===(e=g.header)||void 0===e?void 0:e.alg)==="none"||(null==g||null===(r=g.header)||void 0===r?void 0:r.alg)==="HS256")&&a.push((0,p.jsx)("li",{children:"Test for algorithm confusion attacks by changing the algorithm"},"alg")),null!=g&&null!==(t=g.payload)&&void 0!==t&&t.exp&&(w(g.payload.exp)?a.push((0,p.jsx)("li",{children:"Generate a new token with a future expiration time"},"exp")):a.push((0,p.jsx)("li",{children:"Test token rejection by using an expired token"},"exp-test"))),null!=g&&null!==(s=g.payload)&&void 0!==s&&s.jti||a.push((0,p.jsx)("li",{children:"Add a JWT ID (jti) claim for better security"},"jti")),0===a.length&&a.push((0,p.jsx)("li",{children:"Modify the payload to test how the application handles different claims"},"general-1"),(0,p.jsx)("li",{children:"Test token with different signature algorithms"},"general-2")),(0,p.jsxs)("div",{className:"text-sm",children:[(0,p.jsx)(Text,{weight:"bold",className:"mb-1",children:"Next steps to try:"}),(0,p.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:a})]})),position:"bottom",size:"lg",children:(0,p.jsx)(Badge,{variant:"warning",className:"cursor-help flex items-center",children:(0,p.jsx)("span",{children:"\uD83D\uDC49 Continue to iterate?"})})})}),b&&(0,p.jsx)(Alert,{type:"error",className:"mt-4",children:b}),parsingWarnings&&parsingWarnings.length>0&&(0,p.jsxs)(Alert,{type:"warning",className:"mt-4",children:[(0,p.jsx)("div",{className:"font-medium mb-1",children:"Parsing Warnings:"}),(0,p.jsx)("ul",{className:"list-disc pl-5 text-sm",children:parsingWarnings.map(function(e,r){return(0,p.jsx)("li",{children:e},r)})})]}),g&&(0,p.jsxs)("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto break-all",children:[(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row",children:[(0,p.jsx)("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Header:"}),(0,p.jsx)("div",{className:"".concat(C("header")," flex-1"),children:g.raw.header})]}),(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row mt-2",children:[(0,p.jsx)("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Payload:"}),(0,p.jsx)("div",{className:"".concat(C("payload")," flex-1"),children:g.raw.payload})]}),(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row mt-2",children:[(0,p.jsx)("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Signature:"}),(0,p.jsx)("div",{className:"".concat(C("signature")," flex-1"),children:g.raw.signature})]})]}),(0,p.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,p.jsx)("div",{children:(0,p.jsx)(Button,{onClick:function(){setJwtToken(""),setSecret(""),setSelectedAlgorithm("")},variant:"light",children:"Reset"})}),(0,p.jsx)("div",{children:(0,p.jsx)(Button,{onClick:function(){return v(jwtToken,"token")},variant:"primary",disabled:!jwtToken,children:copied&&"token"===copiedSection?"Copied!":"Copy Token"})})]})]})]})}),(0,p.jsx)("div",{children:(0,p.jsxs)(i.Zb,{isElevated:!0,className:"h-full flex flex-col",children:[(0,p.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,p.jsx)("h2",{className:"text-xl font-semibold",children:"Decoded Data"}),(0,p.jsxs)("div",{className:"flex border border-gray-200 dark:border-gray-700 rounded",children:[(0,p.jsx)("button",{className:"px-3 py-1 text-sm rounded-l ".concat("json"===activeTab?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"),onClick:function(){return setActiveTab("json")},children:"JSON"}),(0,p.jsx)("button",{className:"px-3 py-1 text-sm rounded-r ".concat("table"===activeTab?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"),onClick:function(){return setActiveTab("table")},children:"Table"})]})]}),(0,p.jsx)("div",{className:"p-4 flex-1 flex flex-col overflow-y-auto",children:g?(0,p.jsxs)("div",{className:"flex-1",children:[(0,p.jsxs)("div",{children:[(0,p.jsxs)("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[(0,p.jsx)("span",{className:C("header"),children:"HEADER"}),(0,p.jsx)(Button,{onClick:function(){return v(JSON.stringify(g.header,null,2),"header")},variant:"light",size:"xs",className:"ml-2",children:copied&&"header"===copiedSection?"Copied!":"Copy"})]}),"json"===activeTab?(0,p.jsx)("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4 text-sm",children:JSON.stringify(g.header,null,2)}):(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto mb-4",children:(0,p.jsxs)("table",{className:"w-full text-sm",children:[(0,p.jsx)("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Name"}),(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Value"})]})}),(0,p.jsx)("tbody",{children:Object.entries(g.header).map(function(e){var r=(0,d.Z)(e,2),t=r[0],s=r[1];return(0,p.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[(0,p.jsx)("td",{className:"py-2 px-3 font-medium",children:t}),(0,p.jsx)("td",{className:"py-2 px-3",children:(0,p.jsx)(Tooltip,{content:"alg"===t?"Algorithm used to sign the token":"typ"===t?"Token type":"Header claim: ".concat(t),children:(0,p.jsx)("span",{className:"cursor-help border-b border-dotted border-gray-400",children:String(s)})})})]},t)})})]})}),(0,p.jsxs)("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[(0,p.jsx)("span",{className:C("payload"),children:"PAYLOAD"}),(0,p.jsx)(Button,{onClick:function(){return v(JSON.stringify(g.payload,null,2),"payload")},variant:"light",size:"xs",className:"ml-2",children:copied&&"payload"===copiedSection?"Copied!":"Copy"})]}),"json"===activeTab?(0,p.jsx)("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto text-sm",children:JSON.stringify(g.payload,null,2)}):(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto",children:(0,p.jsxs)("table",{className:"w-full text-sm",children:[(0,p.jsx)("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Claim"}),(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Value"})]})}),(0,p.jsx)("tbody",{children:Object.entries(g.payload).map(function(e){var r=(0,d.Z)(e,2),t=r[0],s=r[1];return(0,p.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[(0,p.jsx)("td",{className:"py-2 px-3 font-medium",children:t}),(0,p.jsx)("td",{className:"py-2 px-3",children:(0,p.jsx)(Tooltip,{content:T(t),children:(0,p.jsx)("span",{className:"cursor-help border-b border-dotted border-gray-400",children:"exp"===t||"iat"===t||"nbf"===t?(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{children:String(s)}),(0,p.jsxs)("div",{className:"text-xs mt-1 ".concat("exp"===t&&w(s)?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"),children:[S(s),"exp"===t&&(0,p.jsx)("span",{className:"ml-2",children:w(s)?(0,p.jsx)(Badge,{color:"danger",size:"sm",children:"Expired"}):(0,p.jsx)(Badge,{color:"success",size:"sm",children:"Valid"})})]})]}):"boolean"==typeof s?(0,p.jsx)("span",{className:s?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:String(s)}):"object"==typeof s&&null!==s?(0,p.jsxs)("details",{children:[(0,p.jsx)("summary",{className:"cursor-pointer",children:"View Object"}),(0,p.jsx)("pre",{className:"mt-2 p-2 bg-gray-100 dark:bg-gray-900 rounded text-xs overflow-auto max-h-40",children:JSON.stringify(s,null,2)})]}):String(s)})})})]},t)})})]})})]}),showIterationTooltip&&(0,p.jsx)("div",{className:"relative ml-4",children:(0,p.jsx)(Button,{variant:"outline-info",onClick:function(){return setShowIterationTooltip(!1)},size:"sm",className:"animate-pulse",children:"Next steps"})}),(0,p.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,p.jsxs)("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[(0,p.jsx)("span",{className:C("signature"),children:"SIGNATURE"}),(0,p.jsx)(Badge,{color:!0===y?"success":!1===y?"danger":"light",className:"ml-2",children:!0===y?"Verified":!1===y?"Invalid":"Not verified"})]}),(0,p.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md text-sm",children:[(0,p.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:["Signature algorithm: ",(0,p.jsx)("span",{className:"font-medium",children:g.header.alg||"HS256"})]}),(0,p.jsxs)("div",{className:"flex flex-col",children:[(0,p.jsxs)("div",{className:"flex-grow mb-2",children:[(0,p.jsx)("label",{htmlFor:"algorithm-select",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Algorithm (optional, override header)"}),(0,p.jsxs)("select",{id:"algorithm-select",className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:selectedAlgorithm,onChange:function(e){return setSelectedAlgorithm(e.target.value)},children:[(0,p.jsx)("option",{value:"",children:"Use algorithm from header"}),(0,p.jsxs)("optgroup",{label:"HMAC",children:[(0,p.jsx)("option",{value:"HS256",children:"HS256"}),(0,p.jsx)("option",{value:"HS384",children:"HS384"}),(0,p.jsx)("option",{value:"HS512",children:"HS512"})]}),(0,p.jsxs)("optgroup",{label:"RSA",children:[(0,p.jsx)("option",{value:"RS256",children:"RS256"}),(0,p.jsx)("option",{value:"RS384",children:"RS384"}),(0,p.jsx)("option",{value:"RS512",children:"RS512"})]}),(0,p.jsxs)("optgroup",{label:"RSA-PSS",children:[(0,p.jsx)("option",{value:"PS256",children:"PS256"}),(0,p.jsx)("option",{value:"PS384",children:"PS384"}),(0,p.jsx)("option",{value:"PS512",children:"PS512"})]}),(0,p.jsxs)("optgroup",{label:"ECDSA",children:[(0,p.jsx)("option",{value:"ES256",children:"ES256"}),(0,p.jsx)("option",{value:"ES384",children:"ES384"}),(0,p.jsx)("option",{value:"ES512",children:"ES512"})]})]})]}),(0,p.jsxs)("div",{className:"flex-grow mb-2",children:[(0,p.jsx)("label",{htmlFor:"secret-key",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Secret/Verification key"}),(0,p.jsx)("textarea",{id:"secret-key",rows:3,className:"w-full font-mono text-xs rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:secret,onChange:function(e){return setSecret(e.target.value)},placeholder:null!==(n=g.header.alg)&&void 0!==n&&n.startsWith("HS")?"Enter your secret key... (raw string or base64 encoded)":null!==(l=g.header.alg)&&void 0!==l&&l.startsWith("RS")||null!==(c=g.header.alg)&&void 0!==c&&c.startsWith("PS")?"Enter your RSA public key (PEM format supported)":"Enter your verification key..."})]}),(0,p.jsx)("div",{className:"flex justify-end",children:(0,p.jsx)(Button,{onClick:function(){x(selectedAlgorithm,secret)},variant:"primary",size:"sm",disabled:!secret,children:"Verify"})})]}),null!==y&&(0,p.jsx)("div",{className:"mt-3 p-2 rounded-md text-sm ".concat(y?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"),children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:y?(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,p.jsx)("span",{children:y?"Signature verified successfully":"Invalid signature"})]})})]})]}),j&&j.length>0&&(0,p.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,p.jsxs)("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[(0,p.jsx)("span",{children:"SECURITY ANALYSIS"}),(0,p.jsxs)(Badge,{color:j.some(function(e){return"high"===e.severity})?"danger":j.some(function(e){return"medium"===e.severity})?"warning":"info",className:"ml-2",children:[j.length," Issue",1!==j.length?"s":""]})]}),(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md text-sm",children:j.map(function(e){return(0,p.jsxs)("div",{className:"p-3 border-b last:border-b-0 border-gray-100 dark:border-gray-700",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,p.jsx)("h4",{className:"font-medium ".concat(I(e.severity)),children:e.title}),(0,p.jsx)(Badge,{color:"high"===e.severity?"danger":"medium"===e.severity?"warning":(e.severity,"info"),size:"sm",children:e.severity})]}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e.description})]},e.id)})})]}),showIterationTooltip&&(0,p.jsx)("div",{className:"relative ml-4",children:(0,p.jsx)(Button,{variant:"outline-info",onClick:function(){return setShowIterationTooltip(!1)},size:"sm",className:"animate-pulse",children:"Next steps"})})]}):(0,p.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400 text-center p-6",children:(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"mb-2",children:"Paste a JWT token on the left to decode it"}),(0,p.jsx)("div",{className:"text-sm",children:(0,p.jsx)(Button,{onClick:N,variant:"light",size:"sm",children:"Or try an example token"})})]})})})]})})]}),(0,p.jsx)("div",{className:"mt-8",children:(0,p.jsxs)(i.Zb,{children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h2",{className:"text-lg font-semibold",children:"About JWT"})}),(0,p.jsxs)("div",{className:"p-4 text-sm",children:[(0,p.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:"JSON Web Tokens (JWTs) are an open, industry standard RFC 7519 method for representing claims securely between two parties."}),(0,p.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,p.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md",children:[(0,p.jsx)("h3",{className:"font-medium mb-1 ".concat(C("header")),children:"Header"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains metadata about the token's type and the signing algorithm."})]}),(0,p.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-md",children:[(0,p.jsx)("h3",{className:"font-medium mb-1 ".concat(C("payload")),children:"Payload"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains the token claims - statements about the user and additional metadata."})]}),(0,p.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[(0,p.jsx)("h3",{className:"font-medium mb-1 ".concat(C("signature")),children:"Signature"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Used to verify that the token wasn't changed along the way and came from an authentic source."})]})]}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-3",children:(0,p.jsxs)("a",{href:"https://jwt.io/introduction",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 inline-flex items-center",children:["Learn more about JWT",(0,p.jsx)("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})]})})]})})]})},S={xs:"0.75rem",sm:"0.875rem",base:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem"},w={normal:400,medium:500,semibold:600,bold:700},T={tight:1.25,normal:1.5};S["4xl"],w.bold,T.tight,S["3xl"],w.bold,T.tight,S["2xl"],w.semibold,T.tight,S.xl,w.semibold,T.tight,S.lg,w.semibold,T.tight,S.base,w.semibold,T.tight,S.base,w.normal,T.normal,S.sm,w.normal,T.normal,S.xs,w.normal,T.normal,S.sm,w.medium,T.normal,t(2521),t(4984),t(4034);var C=t(3596),I=t(4623),E=t(5602),A=t(8870);function J(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return W(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return W(e,r)}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var s=0,a=function(){};return{s:a,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){l=!0,n=e},f:function(){try{i||null==t.return||t.return()}finally{if(l)throw n}}}}function W(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,s=Array(r);t<r;t++)s[t]=e[t];return s}t(5081);var O=function(){var e,r,a,n,d=(0,s.useState)("header"),m=d[0],u=d[1],h=(0,s.useState)("HS256"),g=h[0],b=h[1],y=(0,s.useState)(""),f=y[0],j=y[1],v=(0,s.useState)("JWT"),k=v[0],N=v[1],S=(0,s.useState)([{name:"sub",value:"1234567890",type:"string"},{name:"name",value:"John Doe",type:"string"},{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}]),w=S[0],T=S[1],I=(0,s.useState)(""),A=I[0],W=I[1],O=(0,s.useState)(""),R=O[0],D=O[1],H=(0,s.useState)("string"),P=H[0],Z=H[1],z=(0,s.useState)("your-256-bit-secret"),M=z[0],_=z[1],F=(0,s.useState)({algorithm:"HS256"});F[0],F[1];var K=(0,s.useState)(!1);K[0],K[1];var U=(0,s.useState)(null);U[0],U[1];var V=(0,s.useState)(""),G=V[0],L=V[1],B=(0,s.useState)(0),Y=B[0],X=B[1],Q=(0,s.useState)(!1),q=Q[0],$=Q[1],ee=(0,s.useState)(null),er=ee[0],et=ee[1],es=(0,s.useState)(!1),ea=es[0],en=es[1];(0,s.useEffect)(function(){if(ea){var e=setTimeout(function(){return en(!1)},2e3);return function(){return clearTimeout(e)}}},[ea]),(0,s.useEffect)(function(){ei()},[g,f,k,w]);var ei=(e=(0,c.Z)(x().mark(function e(){var r,s,a,n,i,l,d,c,o;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r={alg:g,typ:k},f&&(r.kid=f),s={},a=J(w),e.prev=5,a.s();case 7:if((n=a.n()).done){e.next=28;break}i=n.value,e.prev=9,e.t0=i.type,e.next="string"===e.t0?13:"number"===e.t0?15:"boolean"===e.t0?17:"json"===e.t0?19:21;break;case 13:return s[i.name]=i.value,e.abrupt("break",21);case 15:return s[i.name]=Number(i.value),e.abrupt("break",21);case 17:return s[i.name]="true"===i.value.toLowerCase(),e.abrupt("break",21);case 19:return s[i.name]=JSON.parse(i.value),e.abrupt("break",21);case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(9),s[i.name]=i.value;case 26:e.next=7;break;case 28:e.next=33;break;case 30:e.prev=30,e.t2=e.catch(5),a.e(e.t2);case 33:return e.prev=33,a.f(),e.finish(33);case 36:return e.next=38,t.e(23).then(t.bind(t,23));case 38:d=(l=e.sent).base64UrlEncode(JSON.stringify(r)),c=l.base64UrlEncode(JSON.stringify(s)),L(o="".concat(d,".").concat(c,".SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c")),X(new TextEncoder().encode(o).length),e.next=49;break;case 46:e.prev=46,e.t3=e.catch(0),console.error("Error generating token preview:",e.t3);case 49:case"end":return e.stop()}},e,null,[[0,46],[5,30,33,36],[9,23]])})),function(){return e.apply(this,arguments)}),el=function(e){var r=(0,o.Z)(w);r.splice(e,1),T(r)},ed=function(e,r,t){var s=(0,o.Z)(w);s[e][r]=t,T(s)},ec=(r=(0,c.Z)(x().mark(function e(){var r,s,a,n,i,l,d;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $(!0),et(null),e.prev=2,e.next=5,t.e(23).then(t.bind(t,23));case 5:r=e.sent,s={alg:g,typ:k},f&&(s.kid=f),a={},n=J(w),e.prev=10,n.s();case 12:if((i=n.n()).done){e.next=33;break}l=i.value,e.prev=14,e.t0=l.type,e.next="string"===e.t0?18:"number"===e.t0?20:"boolean"===e.t0?22:"json"===e.t0?24:26;break;case 18:return a[l.name]=l.value,e.abrupt("break",26);case 20:return a[l.name]=Number(l.value),e.abrupt("break",26);case 22:return a[l.name]="true"===l.value.toLowerCase(),e.abrupt("break",26);case 24:return a[l.name]=JSON.parse(l.value),e.abrupt("break",26);case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(14),a[l.name]=l.value;case 31:e.next=12;break;case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(10),n.e(e.t2);case 38:return e.prev=38,n.f(),e.finish(38);case 41:return e.next=43,r.sign(s,a,M);case 43:L(d=e.sent),X(new TextEncoder().encode(d).length),e.next=51;break;case 48:e.prev=48,e.t3=e.catch(2),et("Error signing token: ".concat(e.t3 instanceof Error?e.t3.message:String(e.t3)));case 51:$(!1);case 52:case"end":return e.stop()}},e,null,[[2,48],[10,35,38,41],[14,28]])})),function(){return r.apply(this,arguments)});return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{className:"flex justify-center",children:(0,p.jsxs)("div",{className:"w-full max-w-5xl px-4 py-6",children:[(0,p.jsxs)("div",{className:"text-center mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"JWT Builder"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Create and sign custom JSON Web Tokens with our step-by-step wizard."})]}),(0,p.jsx)(i.Zb,{className:"mb-6",children:(0,p.jsxs)(l.v0,{children:[(0,p.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,p.jsx)(l.OK,{id:"header-tab",isActive:"header"===m,onClick:function(){return u("header")},children:"1. Header"}),(0,p.jsx)(l.OK,{id:"payload-tab",isActive:"payload"===m,onClick:function(){return u("payload")},children:"2. Payload"}),(0,p.jsx)(l.OK,{id:"signature-tab",isActive:"signature"===m,onClick:function(){return u("signature")},children:"3. Signature"})]}),"header"===m&&(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Algorithm (alg)"}),(0,p.jsxs)("select",{value:g,onChange:function(e){return b(e.target.value)},className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[(0,p.jsxs)("optgroup",{label:"HMAC",children:[(0,p.jsx)("option",{value:"HS256",children:"HS256 (HMAC + SHA256)"}),(0,p.jsx)("option",{value:"HS384",children:"HS384 (HMAC + SHA384)"}),(0,p.jsx)("option",{value:"HS512",children:"HS512 (HMAC + SHA512)"})]}),(0,p.jsxs)("optgroup",{label:"RSA",children:[(0,p.jsx)("option",{value:"RS256",children:"RS256 (RSA + SHA256)"}),(0,p.jsx)("option",{value:"RS384",children:"RS384 (RSA + SHA384)"}),(0,p.jsx)("option",{value:"RS512",children:"RS512 (RSA + SHA512)"})]}),(0,p.jsxs)("optgroup",{label:"ECDSA",children:[(0,p.jsx)("option",{value:"ES256",children:"ES256 (ECDSA + SHA256)"}),(0,p.jsx)("option",{value:"ES384",children:"ES384 (ECDSA + SHA384)"}),(0,p.jsx)("option",{value:"ES512",children:"ES512 (ECDSA + SHA512)"})]}),(0,p.jsx)("optgroup",{label:"Unsafe",children:(0,p.jsx)("option",{value:"none",children:"none (Unsigned Token)"})})]}),"none"===g&&(0,p.jsx)("div",{className:"mt-2 text-red-600 dark:text-red-400 text-sm",children:'Warning: The "none" algorithm creates unsigned tokens which provide no security.'})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Token Type (typ)"}),(0,p.jsx)(C.oi,{value:k,onChange:function(e){return N(e.target.value)},placeholder:"JWT"}),(0,p.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:'Usually "JWT" for JSON Web Token'})]})]}),(0,p.jsxs)("div",{className:"mt-4",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Key ID (kid)"}),(0,p.jsx)(C.oi,{value:f,onChange:function(e){return j(e.target.value)},placeholder:"Optional Key ID"}),(0,p.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Optional identifier for the key used to sign this token"})]}),(0,p.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,p.jsx)("div",{}),(0,p.jsx)(C.zx,{variant:"primary",onClick:function(){return u("payload")},children:"Continue to Payload"})]})]}),"payload"===m&&(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("div",{className:"mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:[(0,p.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Current Claims"}),(0,p.jsx)("div",{className:"overflow-x-auto",children:(0,p.jsxs)("table",{className:"w-full text-sm",children:[(0,p.jsx)("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Claim"}),(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Type"}),(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Value"}),(0,p.jsx)("th",{className:"text-right py-2 px-3",children:"Action"})]})}),(0,p.jsx)("tbody",{children:w.map(function(e,r){return(0,p.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[(0,p.jsx)("td",{className:"py-2 px-3",children:(0,p.jsx)(C.oi,{value:e.name,onChange:function(e){return ed(r,"name",e.target.value)},size:"sm"})}),(0,p.jsx)("td",{className:"py-2 px-3",children:(0,p.jsxs)("select",{value:e.type,onChange:function(e){return ed(r,"type",e.target.value)},className:"p-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800",children:[(0,p.jsx)("option",{value:"string",children:"String"}),(0,p.jsx)("option",{value:"number",children:"Number"}),(0,p.jsx)("option",{value:"boolean",children:"Boolean"}),(0,p.jsx)("option",{value:"json",children:"JSON"})]})}),(0,p.jsx)("td",{className:"py-2 px-3",children:(0,p.jsx)(C.oi,{value:e.value,onChange:function(e){return ed(r,"value",e.target.value)},size:"sm"})}),(0,p.jsx)("td",{className:"py-2 px-3 text-right",children:(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){return el(r)},children:"Remove"})})]},r)})})]})}),(0,p.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,p.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Add Claim"}),(0,p.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),(0,p.jsx)(C.oi,{value:A,onChange:function(e){return W(e.target.value)},placeholder:"Claim name",size:"sm"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),(0,p.jsxs)("select",{value:P,onChange:function(e){return Z(e.target.value)},className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[(0,p.jsx)("option",{value:"string",children:"String"}),(0,p.jsx)("option",{value:"number",children:"Number"}),(0,p.jsx)("option",{value:"boolean",children:"Boolean"}),(0,p.jsx)("option",{value:"json",children:"JSON"})]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Value"}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)(C.oi,{value:R,onChange:function(e){return D(e.target.value)},placeholder:"Value",size:"sm",className:"flex-grow"}),(0,p.jsx)(C.zx,{variant:"primary",size:"sm",className:"ml-2",onClick:function(){A&&A.trim()&&(T([].concat((0,o.Z)(w),[{name:A.trim(),value:R,type:P}])),W(""),D(""))},children:"Add"})]})]})]})]}),(0,p.jsxs)("div",{className:"mt-4",children:[(0,p.jsx)("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-1",children:"Common Claims"}),(0,p.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){w.some(function(e){return"exp"===e.name})||T([].concat((0,o.Z)(w),[{name:"exp",value:String(Math.floor(Date.now()/1e3)+3600),type:"number"}]))},children:"Add exp (Expiry)"}),(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){w.some(function(e){return"iat"===e.name})||T([].concat((0,o.Z)(w),[{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}]))},children:"Add iat (Issued At)"}),(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){w.some(function(e){return"nbf"===e.name})||T([].concat((0,o.Z)(w),[{name:"nbf",value:String(Math.floor(Date.now()/1e3)),type:"number"}]))},children:"Add nbf (Not Before)"}),(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){w.some(function(e){return"iss"===e.name})||T([].concat((0,o.Z)(w),[{name:"iss",value:"https://example.com",type:"string"}]))},children:"Add iss (Issuer)"}),(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){w.some(function(e){return"aud"===e.name})||T([].concat((0,o.Z)(w),[{name:"aud",value:"client-id",type:"string"}]))},children:"Add aud (Audience)"}),(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){w.some(function(e){return"jti"===e.name})||T([].concat((0,o.Z)(w),[{name:"jti",value:crypto.randomUUID(),type:"string"}]))},children:"Add jti (JWT ID)"})]})]})]}),(0,p.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,p.jsx)(C.zx,{variant:"light",onClick:function(){return u("header")},children:"Back to Header"}),(0,p.jsx)(C.zx,{variant:"primary",onClick:function(){return u("signature")},children:"Continue to Signature"})]})]}),"signature"===m&&(a="Secret Key",n="Enter the secret key for HMAC signing",g.startsWith("RS")?(a="Private Key (PKCS#8)",n="Enter the PEM-formatted RSA private key"):g.startsWith("ES")?(a="Private Key (PKCS#8)",n="Enter the PEM-formatted EC private key"):"none"===g&&(a="No Key Required",n="The 'none' algorithm does not use a key"),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsx)("div",{className:"mb-4 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md border border-blue-200 dark:border-blue-800",children:(0,p.jsxs)("p",{className:"text-blue-800 dark:text-blue-200 text-sm flex items-center",children:[(0,p.jsx)("span",{className:"mr-2",children:"ℹ️"}),"You're creating a token with algorithm ",(0,p.jsx)("strong",{children:g})," and ",w.length," claims.","none"===g&&(0,p.jsx)("span",{className:"text-red-600 dark:text-red-400 ml-1",children:" (Unsigned Token - Not secure)"})]})}),(0,p.jsxs)("div",{className:"mt-4",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a}),(0,p.jsx)("textarea",{value:M,onChange:function(e){return _(e.target.value)},placeholder:"none"===g?'No key needed for "none" algorithm':"Enter key here...",disabled:"none"===g,className:"w-full font-mono h-32 p-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 dark:text-gray-200"}),(0,p.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:n})]}),(0,p.jsx)("div",{className:"mt-4",children:(0,p.jsx)(C.zx,{variant:"primary",className:"w-full",onClick:ec,disabled:q||"none"!==g&&!M,children:q?"Signing...":"Sign Token"})}),er&&(0,p.jsx)("div",{className:"mt-4 bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:(0,p.jsx)("p",{className:"text-red-800 dark:text-red-300 text-sm",children:er})}),(0,p.jsx)("div",{className:"mt-6 flex justify-between",children:(0,p.jsx)(C.zx,{variant:"light",onClick:function(){return u("payload")},children:"Back to Payload"})})]}))]})}),(0,p.jsxs)(i.Zb,{children:[(0,p.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold",children:"Generated Token"}),(0,p.jsxs)(E.Ct,{color:"info",children:["Size: ",Y," bytes"]})]}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto whitespace-nowrap",children:G||"Your token will appear here..."}),(0,p.jsx)("div",{className:"mt-4 flex justify-end",children:(0,p.jsx)(C.zx,{onClick:function(){navigator.clipboard.writeText(G),en(!0)},variant:"primary",disabled:!G,children:ea?"Copied!":"Copy Token"})})]})]})]})})})},R=function(){var e=k(),r=e.state,t=e.dispatch,a=e.decodeToken,n=e.verifySignature,c=e.analyzeToken,m=r.token,u=r.decoded,x=r.isVerified,h=r.error,g=r.securityIssues,b=(0,s.useState)(""),y=b[0],f=b[1],j=(0,s.useState)("json"),v=j[0],N=j[1],S=(0,s.useState)(!1),w=S[0],T=S[1],J=(0,s.useState)(null),W=J[0],O=J[1],R=(0,s.useState)(!1);R[0],R[1];var D=(0,s.useState)(null),H=D[0],P=D[1];(0,s.useEffect)(function(){if(w){var e=setTimeout(function(){T(!1),O(null)},2e3);return function(){return clearTimeout(e)}}},[w]),(0,s.useEffect)(function(){g.length>0&&u?P(Math.max(0,100-(25*g.filter(function(e){return"high"===e.severity}).length+10*g.filter(function(e){return"medium"===e.severity}).length+5*g.filter(function(e){return"low"===e.severity}).length))):P(null)},[g,u]);var Z=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"token";navigator.clipboard.writeText(e),T(!0),O(r)},z=function(e){try{return new Date(1e3*e).toLocaleString()}catch(e){return"Invalid date"}},M=function(e){return Date.now()>1e3*e},_=function(e){switch(e){case"sub":return"Subject (user) identifier";case"iss":return"Issuer of the token";case"aud":return"Audience the token is intended for";case"exp":return"Expiration time (when token becomes invalid)";case"nbf":return"Not before time (when token starts being valid)";case"iat":return"Issued at time (when token was issued)";case"jti":return"JWT ID (unique identifier for this token)";case"name":return"User name";case"given_name":return"User first name";case"family_name":return"User last name";case"email":return"User email address";case"roles":return"User roles/permissions";case"scope":return"OAuth 2.0 scopes";case"sid":return"Session ID";case"auth_time":return"Time when authentication occurred";default:return"Custom claim"}},F=function(e){switch(e){case"high":return"⚠️";case"medium":return"⚠";default:return"ℹ️"}},K=function(e){switch(e){case"header":return"text-blue-600 dark:text-blue-400";case"payload":return"text-purple-600 dark:text-purple-400";case"signature":return"text-red-600 dark:text-red-400";default:return"text-gray-600"}};return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{className:"flex justify-center",children:(0,p.jsxs)("div",{className:"w-full max-w-5xl px-4 py-6",children:[(0,p.jsxs)("div",{className:"text-center mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"JWT Token Inspector"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Decode, verify, and analyze JSON Web Tokens with advanced security analysis."})]}),(0,p.jsxs)(i.Zb,{className:"mb-6",children:[(0,p.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold",children:"JWT Token"}),(0,p.jsx)(C.zx,{onClick:function(){var e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNjE2MjM5MDIyLCJleHAiOjE5MTYyMzkwMjIsInJvbGUiOiJhZG1pbiJ9.8TT2jkQV3a9lQfNSJz7USP9vgKzlhWPMnDxCQfFgj3w";a(e),c(e)},size:"sm",variant:"light",children:"Generate Demo"})]}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:(0,p.jsxs)("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[(0,p.jsx)("span",{className:"mr-2",children:"\uD83D\uDD12"}),"All JWT processing happens locally in your browser. Your tokens are never sent to a server."]})}),(0,p.jsx)("textarea",{className:"w-full font-mono text-sm p-3 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 h-28 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:m,onChange:function(e){var r=e.target.value.trim();r!==m&&(a(r),r&&c(r))},placeholder:"Paste your JWT token here...",spellCheck:"false"}),h&&(0,p.jsx)(I.bZ,{type:"error",className:"mt-4",children:h}),u&&(0,p.jsxs)("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto break-all",children:[(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row",children:[(0,p.jsx)("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Header:"}),(0,p.jsx)("div",{className:"".concat(K("header")," flex-1"),children:u.raw.header})]}),(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row mt-2",children:[(0,p.jsx)("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Payload:"}),(0,p.jsx)("div",{className:"".concat(K("payload")," flex-1"),children:u.raw.payload})]}),(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row mt-2",children:[(0,p.jsx)("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Signature:"}),(0,p.jsx)("div",{className:"".concat(K("signature")," flex-1"),children:u.raw.signature})]})]}),(0,p.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,p.jsx)("div",{children:(0,p.jsx)(C.zx,{onClick:function(){t({type:"RESET"}),f(""),P(null)},variant:"light",children:"Reset"})}),(0,p.jsx)(C.zx,{onClick:function(){return Z(m)},variant:"primary",children:w&&"token"===W?"Copied!":"Copy Token"})]})]})]}),function(){if(!g||0===g.length)return null;var e=g.filter(function(e){return"high"===e.severity}),r=g.filter(function(e){return"medium"===e.severity}),t=g.filter(function(e){return"low"===e.severity}),s=g.filter(function(e){return"info"===e.severity});return(0,p.jsxs)(i.Zb,{className:"mb-6",children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:["Security Analysis",null!==H&&(0,p.jsxs)("div",{className:"ml-auto flex items-center",children:[(0,p.jsx)("div",{className:"text-sm mr-2",children:"Security Score:"}),(0,p.jsx)("div",{className:"rounded-full w-10 h-10 flex items-center justify-center ".concat(H>=90?"bg-green-100 text-green-800":H>=80?"bg-green-50 text-green-600":H>=60?"bg-yellow-100 text-yellow-800":H>=40?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"),children:H}),(0,p.jsx)("div",{className:"ml-2 text-sm font-medium",children:H>=90?"Excellent":H>=80?"Good":H>=60?"Moderate":H>=40?"Poor":"Critical"})]})]})}),(0,p.jsxs)("div",{className:"p-4",children:[e.length>0&&(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("h4",{className:"text-red-600 dark:text-red-400 font-medium mb-2",children:"Critical Issues"}),e.map(function(e){return(0,p.jsx)(I.bZ,{type:"error",className:"mb-2",children:(0,p.jsxs)("div",{className:"flex items-start",children:[(0,p.jsx)("span",{className:"mr-2 mt-0.5",children:F(e.severity)}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"font-medium",children:e.title}),(0,p.jsx)("div",{className:"text-sm",children:e.description})]})]})},e.id)})]}),r.length>0&&(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("h4",{className:"text-yellow-600 dark:text-yellow-400 font-medium mb-2",children:"Warning Issues"}),r.map(function(e){return(0,p.jsx)(I.bZ,{type:"warning",className:"mb-2",children:(0,p.jsxs)("div",{className:"flex items-start",children:[(0,p.jsx)("span",{className:"mr-2 mt-0.5",children:F(e.severity)}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"font-medium",children:e.title}),(0,p.jsx)("div",{className:"text-sm",children:e.description})]})]})},e.id)})]}),(t.length>0||s.length>0)&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{className:"text-blue-600 dark:text-blue-400 font-medium mb-2",children:"Informational"}),[].concat((0,o.Z)(t),(0,o.Z)(s)).map(function(e){return(0,p.jsx)(I.bZ,{type:"info",className:"mb-2",children:(0,p.jsxs)("div",{className:"flex items-start",children:[(0,p.jsx)("span",{className:"mr-2 mt-0.5",children:F(e.severity)}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"font-medium",children:e.title}),(0,p.jsx)("div",{className:"text-sm",children:e.description})]})]})},e.id)})]})]})]})}(),u&&(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,p.jsx)("div",{className:"md:col-span-2",children:(0,p.jsx)(i.Zb,{children:(0,p.jsxs)(l.v0,{children:[(0,p.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,p.jsx)(l.OK,{id:"tab-json",isActive:"json"===v,onClick:function(){return N("json")},children:"JSON"}),(0,p.jsx)(l.OK,{id:"tab-claims",isActive:"claims"===v,onClick:function(){return N("claims")},children:"Claims Table"})]}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[(0,p.jsx)("span",{className:K("header"),children:"HEADER"}),(0,p.jsx)(C.zx,{onClick:function(){return Z(JSON.stringify(u.header,null,2),"header")},variant:"light",size:"xs",className:"ml-2",children:w&&"header"===W?"Copied!":"Copy"})]}),(0,p.jsx)(l.x4,{id:"panel-json-header",isActive:"json"===v,children:(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4",children:(0,p.jsx)("pre",{className:"text-sm",children:JSON.stringify(u.header,null,2)})})}),(0,p.jsx)(l.x4,{id:"panel-claims-header",isActive:"claims"===v,children:(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4",children:(0,p.jsxs)("table",{className:"w-full text-sm",children:[(0,p.jsx)("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Name"}),(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Value"})]})}),(0,p.jsx)("tbody",{children:Object.entries(u.header).map(function(e){var r=(0,d.Z)(e,2),t=r[0],s=r[1];return(0,p.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[(0,p.jsx)("td",{className:"py-2 px-3 font-medium",children:t}),(0,p.jsx)("td",{className:"py-2 px-3",children:(0,p.jsx)(A.u,{content:"alg"===t?"Algorithm used to sign the token":"typ"===t?"Token type":"kid"===t?"Key identifier":"Header claim: ".concat(t),children:(0,p.jsx)("span",{className:"cursor-help border-b border-dotted border-gray-400",children:String(s)})})})]},t)})})]})})}),(0,p.jsxs)("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[(0,p.jsx)("span",{className:K("payload"),children:"PAYLOAD"}),(0,p.jsx)(C.zx,{onClick:function(){return Z(JSON.stringify(u.payload,null,2),"payload")},variant:"light",size:"xs",className:"ml-2",children:w&&"payload"===W?"Copied!":"Copy"})]}),(0,p.jsx)(l.x4,{id:"panel-json-payload",isActive:"json"===v,children:(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:(0,p.jsx)("pre",{className:"text-sm",children:JSON.stringify(u.payload,null,2)})})}),(0,p.jsx)(l.x4,{id:"panel-claims-payload",isActive:"claims"===v,children:(0,p.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:(0,p.jsxs)("table",{className:"w-full text-sm",children:[(0,p.jsx)("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Claim"}),(0,p.jsx)("th",{className:"text-left py-2 px-3",children:"Value"})]})}),(0,p.jsx)("tbody",{children:Object.entries(u.payload).map(function(e){var r=(0,d.Z)(e,2),t=r[0],s=r[1];return(0,p.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[(0,p.jsx)("td",{className:"py-2 px-3 font-medium",children:t}),(0,p.jsx)("td",{className:"py-2 px-3",children:(0,p.jsx)(A.u,{content:_(t),children:(0,p.jsx)("span",{className:"cursor-help border-b border-dotted border-gray-400",children:"exp"===t||"iat"===t||"nbf"===t?(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{children:String(s)}),(0,p.jsxs)("div",{className:"text-xs mt-1 ".concat("exp"===t&&M(s)?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"),children:[z(s),"exp"===t&&(0,p.jsx)("span",{className:"ml-2",children:M(s)?(0,p.jsx)(E.Ct,{color:"danger",size:"sm",children:"Expired"}):(0,p.jsx)(E.Ct,{color:"success",size:"sm",children:"Valid"})})]})]}):"boolean"==typeof s?(0,p.jsx)("span",{className:s?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:String(s)}):String(s)})})})]},t)})})]})})})]})]})})}),(0,p.jsxs)("div",{children:[(0,p.jsxs)(i.Zb,{className:"mb-6",children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h3",{className:"font-semibold",children:"Signature Verification"})}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Verify the signature using your secret key. Algorithm: ",u.header.alg||"unknown"]}),(0,p.jsxs)("div",{className:"mt-2",children:[(0,p.jsx)("label",{htmlFor:"secret-key",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secret/Public Key"}),(0,p.jsx)(C.oi,{id:"secret-key",value:y,onChange:function(e){return f(e.target.value)},placeholder:"Enter secret key or paste public key...",className:"font-mono"})]}),(0,p.jsx)(C.zx,{onClick:function(){u&&y&&n(u.header.alg,y)},variant:"primary",className:"w-full mt-3",disabled:!y,children:"Verify Signature"}),null!==x&&(0,p.jsx)("div",{className:"mt-4 p-3 rounded-md ".concat(x?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"),children:(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("span",{className:"mr-2",children:x?"✅":"❌"}),(0,p.jsx)("span",{className:"font-medium",children:x?"Signature Verified":"Invalid Signature"})]})})]})]}),u.payload.exp&&(0,p.jsxs)(i.Zb,{children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h3",{className:"font-semibold",children:"Token Status"})}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("div",{className:"p-3 rounded-md ".concat(M(u.payload.exp)?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"),children:[(0,p.jsx)("div",{className:"font-medium",children:M(u.payload.exp)?"\uD83D\uDD52 Expired":"✅ Valid"}),(0,p.jsx)("div",{className:"text-sm mt-1",children:z(u.payload.exp)})]}),u.payload.iat&&(0,p.jsxs)("div",{className:"mt-3",children:[(0,p.jsx)("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issued at:"}),(0,p.jsx)("div",{className:"text-sm",children:z(u.payload.iat)})]}),u.payload.nbf&&(0,p.jsxs)("div",{className:"mt-3",children:[(0,p.jsx)("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Not valid before:"}),(0,p.jsx)("div",{className:"text-sm",children:z(u.payload.nbf)})]})]})]})]})]})}),(0,p.jsx)("div",{className:"mt-8",children:(0,p.jsxs)(i.Zb,{children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h2",{className:"text-lg font-semibold",children:"JWT Security Best Practices"})}),(0,p.jsx)("div",{className:"p-4 text-sm",children:(0,p.jsxs)("ul",{className:"space-y-3",children:[(0,p.jsxs)("li",{className:"flex",children:[(0,p.jsx)("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),(0,p.jsx)("span",{children:"Use short-lived tokens with expiration times (exp claim)"})]}),(0,p.jsxs)("li",{className:"flex",children:[(0,p.jsx)("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),(0,p.jsx)("span",{children:"Prefer asymmetric algorithms (RS256, ES256) over symmetric ones (HS256) for public clients"})]}),(0,p.jsxs)("li",{className:"flex",children:[(0,p.jsx)("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),(0,p.jsx)("span",{children:"Include audience (aud) and issuer (iss) claims to prevent token misuse"})]}),(0,p.jsxs)("li",{className:"flex",children:[(0,p.jsx)("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),(0,p.jsx)("span",{children:"Use strong, unique keys for signing tokens"})]}),(0,p.jsxs)("li",{className:"flex",children:[(0,p.jsx)("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"✗"}),(0,p.jsx)("span",{children:"Never store sensitive data like passwords or API keys in tokens"})]}),(0,p.jsxs)("li",{className:"flex",children:[(0,p.jsx)("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"✗"}),(0,p.jsx)("span",{children:"Never use the 'none' algorithm in production"})]}),(0,p.jsxs)("li",{className:"flex",children:[(0,p.jsx)("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"✗"}),(0,p.jsx)("span",{children:"Avoid very long-lived tokens (> 24 hours) for sensitive operations"})]})]})})]})})]})})})},D=function(){var e,r,t,a,n,l,d,o=k().state.decoded,m=(0,s.useState)(""),u=m[0],h=m[1],g=(0,s.useState)("jwks"),b=g[0],y=g[1],f=(0,s.useState)(!1),j=f[0],v=f[1],N=(0,s.useState)([]),S=N[0],w=N[1],T=(0,s.useState)(null),A=T[0],J=T[1],W=(0,s.useState)(null),O=W[0],R=W[1],D=(0,s.useState)(null),H=D[0],P=D[1],Z=(0,s.useState)(!1),z=Z[0],M=Z[1],_=(0,s.useState)(null),F=_[0],K=_[1];(0,s.useEffect)(function(){var e;if(null!=o&&null!==(e=o.payload)&&void 0!==e&&e.iss&&!u){var r=o.payload.iss;r.endsWith("/")?h("".concat(r,".well-known/openid-configuration")):h("".concat(r,"/.well-known/openid-configuration")),y("oidc")}},[o]),(0,s.useEffect)(function(){if(z){var e=setTimeout(function(){M(!1),K(null)},2e3);return function(){return clearTimeout(e)}}},[z]),(0,s.useEffect)(function(){var e;if(null!=o&&null!==(e=o.header)&&void 0!==e&&e.kid&&S.length>0){var r=o.header.kid;P(S.find(function(e){return e.kid===r})||null)}else P(null)},[o,S]);var U=(l=(0,c.Z)(x().mark(function e(){var r,t;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:return v(!0),R(null),w([]),J(null),e.prev=6,e.next=9,fetch(u);case 9:if((r=e.sent).ok){e.next=12;break}throw Error("HTTP error: ".concat(r.status," ").concat(r.statusText));case 12:return e.next=14,r.json();case 14:t=e.sent;try{sessionStorage.setItem("jwks_".concat(u),JSON.stringify(t))}catch(e){console.warn("Failed to cache JWKS in sessionStorage:",e)}if(!t.keys){e.next=20;break}w(t.keys),e.next=21;break;case 20:throw Error("No keys found in the JWKS response");case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),R("Failed to fetch JWKS: ".concat(e.t0 instanceof Error?e.t0.message:String(e.t0)));case 26:return e.prev=26,v(!1),e.finish(26);case 29:case"end":return e.stop()}},e,null,[[6,23,26,29]])})),function(){return l.apply(this,arguments)}),V=(d=(0,c.Z)(x().mark(function e(){var r,t,s,a;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:return v(!0),R(null),w([]),J(null),e.prev=6,e.next=9,fetch(u);case 9:if((r=e.sent).ok){e.next=12;break}throw Error("HTTP error: ".concat(r.status," ").concat(r.statusText));case 12:return e.next=14,r.json();case 14:J(t=e.sent);try{sessionStorage.setItem("oidc_".concat(u),JSON.stringify(t))}catch(e){console.warn("Failed to cache OIDC config in sessionStorage:",e)}if(t.jwks_uri){e.next=19;break}throw Error("No JWKS URI found in the OIDC configuration");case 19:return e.next=21,fetch(t.jwks_uri);case 21:if((s=e.sent).ok){e.next=24;break}throw Error("HTTP error fetching JWKS: ".concat(s.status," ").concat(s.statusText));case 24:return e.next=26,s.json();case 26:a=e.sent;try{sessionStorage.setItem("jwks_".concat(t.jwks_uri),JSON.stringify(a))}catch(e){console.warn("Failed to cache JWKS in sessionStorage:",e)}if(!a.keys){e.next=32;break}w(a.keys),e.next=33;break;case 32:throw Error("No keys found in the JWKS response");case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(6),R("Failed to fetch OIDC configuration or JWKS: ".concat(e.t0 instanceof Error?e.t0.message:String(e.t0)));case 38:return e.prev=38,v(!1),e.finish(38);case 41:case"end":return e.stop()}},e,null,[[6,35,38,41]])})),function(){return d.apply(this,arguments)}),G=function(e,r){navigator.clipboard.writeText(e),M(!0),K(r)},L=function(e,r){var t,s=(null==o||null===(t=o.header)||void 0===t?void 0:t.kid)&&e.kid===o.header.kid,a=JSON.stringify(e,null,2);return(0,p.jsxs)(i.Zb,{className:"mb-4 ".concat(s?"border-green-500 dark:border-green-500":""),children:[(0,p.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,p.jsxs)("h4",{className:"font-semibold flex items-center",children:[s&&(0,p.jsx)("span",{className:"mr-2 text-green-500",children:"✓ "}),"Key ",e.kid?"ID: ".concat(e.kid):r+1]}),(0,p.jsxs)("div",{className:"flex gap-2",children:[e.alg&&(0,p.jsx)(E.Ct,{color:"primary",children:e.alg}),(0,p.jsx)(E.Ct,{color:"info",children:e.kty}),e.use&&(0,p.jsx)(E.Ct,{color:"success",children:e.use})]})]}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Type:"})," ",e.kty]}),e.alg&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Algorithm:"})," ",e.alg]}),e.use&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Use:"})," ",e.use]}),e.key_ops&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Operations:"})," ",e.key_ops.join(", ")]}),"RSA"===e.kty&&e.n&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Modulus (n):"}),(0,p.jsx)("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:e.n})]}),"RSA"===e.kty&&e.e&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Exponent (e):"})," ",e.e]}),"EC"===e.kty&&(0,p.jsxs)(p.Fragment,{children:[e.crv&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Curve:"})," ",e.crv]}),e.x&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"X:"}),(0,p.jsx)("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:e.x})]}),e.y&&(0,p.jsxs)("div",{className:"mb-2",children:[(0,p.jsx)("span",{className:"font-medium",children:"Y:"}),(0,p.jsx)("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:e.y})]})]}),(0,p.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){return G(a,"key_".concat(r))},children:z&&F==="key_".concat(r)?"Copied!":"Copy Key JSON"})})]})]},e.kid||r)};return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,p.jsxs)("div",{className:"text-center mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"JWKS Probe"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Discover and explore JSON Web Key Sets (JWKS) to verify JWT signatures."})]}),(0,p.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-md border border-blue-200 dark:border-blue-800 mb-6",children:(0,p.jsxs)("div",{className:"flex items-start",children:[(0,p.jsx)("div",{className:"mr-3 text-blue-600 dark:text-blue-400 text-lg",children:"ℹ️"}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"What is JWKS?"}),(0,p.jsx)("p",{className:"text-blue-800 dark:text-blue-200 text-sm",children:"A JSON Web Key Set is a JSON document that represents a set of public keys as a JSON object. JWKS endpoints are used to publish the public keys needed to verify JWT signatures. This tool helps you retrieve and inspect these keys."})]})]})}),(0,p.jsxs)(i.Zb,{className:"mb-6",children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h3",{className:"text-lg font-semibold",children:"JWKS Endpoint Configuration"})}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"URL Type"}),(0,p.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,p.jsxs)("label",{className:"inline-flex items-center",children:[(0,p.jsx)("input",{type:"radio",value:"jwks",checked:"jwks"===b,onChange:function(){return y("jwks")},className:"form-radio h-4 w-4 text-blue-600"}),(0,p.jsx)("span",{className:"ml-2",children:"JWKS Endpoint"})]}),(0,p.jsxs)("label",{className:"inline-flex items-center",children:[(0,p.jsx)("input",{type:"radio",value:"oidc",checked:"oidc"===b,onChange:function(){return y("oidc")},className:"form-radio h-4 w-4 text-blue-600"}),(0,p.jsx)("span",{className:"ml-2",children:"OIDC Discovery"})]})]})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"jwks-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"jwks"===b?"JWKS URL":"OIDC Discovery URL"}),(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)(C.oi,{id:"jwks-url",value:u,onChange:function(e){return h(e.target.value)},placeholder:"jwks"===b?"https://example.com/.well-known/jwks.json":"https://example.com/.well-known/openid-configuration",className:"flex-grow"}),(0,p.jsx)(C.zx,{onClick:function(){"jwks"===b?h("https://www.googleapis.com/oauth2/v3/certs"):h("https://accounts.google.com/.well-known/openid-configuration")},variant:"light",className:"ml-2",children:"Sample"})]}),(0,p.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"jwks"===b?"Direct URL to a JWKS endpoint containing public keys":"URL to an OpenID Connect discovery document"}),(null==o||null===(e=o.payload)||void 0===e?void 0:e.iss)&&(0,p.jsxs)("div",{className:"mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 text-sm rounded-md",children:["Token issuer detected: ",(0,p.jsx)("span",{className:"font-medium",children:o.payload.iss})]})]}),(0,p.jsx)("div",{className:"flex justify-end",children:(0,p.jsx)(C.zx,{onClick:function(){"jwks"===b?U():V()},variant:"primary",disabled:!u||j,children:j?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(I.TK,{size:"sm",className:"mr-2"}),"Fetching..."]}):"Fetch Keys"})})]})]}),O&&(0,p.jsx)(I.bZ,{type:"error",className:"mb-6",children:O}),A&&(0,p.jsxs)(i.Zb,{className:"mb-6",children:[(0,p.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,p.jsx)("h3",{className:"text-lg font-semibold",children:"OIDC Configuration"}),(0,p.jsx)(C.zx,{variant:"light",size:"sm",onClick:function(){G(JSON.stringify(A,null,2),"oidc_config")},children:z&&"oidc_config"===F?"Copied!":"Copy Full Config"})]}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[A.issuer&&(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{className:"font-medium",children:"Issuer:"})," ",A.issuer]}),A.jwks_uri&&(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{className:"font-medium",children:"JWKS URI:"})," ",A.jwks_uri]}),A.token_endpoint&&(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{className:"font-medium",children:"Token Endpoint:"})," ",A.token_endpoint]}),A.authorization_endpoint&&(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{className:"font-medium",children:"Authorization Endpoint:"})," ",A.authorization_endpoint]})]}),(0,p.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,p.jsx)("h4",{className:"font-medium mb-2",children:"Available Scopes:"}),(0,p.jsxs)("div",{className:"flex flex-wrap gap-2",children:[null===(r=A.scopes_supported)||void 0===r?void 0:r.slice(0,8).map(function(e){return(0,p.jsx)(E.Ct,{color:"info",children:e},e)}),(null===(t=A.scopes_supported)||void 0===t?void 0:t.length)>8&&(0,p.jsxs)(E.Ct,{color:"light",children:["+",A.scopes_supported.length-8," more"]})]})]})]})]}),S.length>0&&(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,p.jsxs)("h3",{className:"text-lg font-semibold",children:["Keys Found (",S.length,")"]}),H&&(null==o||null===(a=o.header)||void 0===a?void 0:a.kid)&&(0,p.jsxs)(E.Ct,{color:"success",children:["Found matching key for KID: ",o.header.kid]})]}),(null==o||null===(n=o.header)||void 0===n?void 0:n.kid)&&!H&&S.length>0&&(0,p.jsxs)(I.bZ,{type:"warning",className:"mb-4",children:["No key matching the token's kid \"",o.header.kid,'" was found in the JWKS.']}),S.map(function(e,r){return L(e,r)})]}),S.length>0&&(0,p.jsxs)(i.Zb,{children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h3",{className:"text-lg font-semibold",children:"JWKS Usage Guide"})}),(0,p.jsx)("div",{className:"p-4",children:(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsx)("h4",{className:"font-medium",children:"How to use a JWKS to verify a JWT:"}),(0,p.jsxs)("ol",{className:"list-decimal pl-5 space-y-2 text-sm",children:[(0,p.jsx)("li",{children:"Decode the JWT to extract the header and identify the key ID (kid)"}),(0,p.jsx)("li",{children:"Find the matching key in the JWKS with the same kid"}),(0,p.jsx)("li",{children:"Extract the public key components from the JWK (modulus, exponent for RSA)"}),(0,p.jsx)("li",{children:"Use the public key to verify the JWT signature with the algorithm specified in the header"})]}),(0,p.jsx)("h4",{className:"font-medium mt-4",children:"Security Best Practices:"}),(0,p.jsxs)("ul",{className:"list-disc pl-5 space-y-2 text-sm",children:[(0,p.jsx)("li",{children:"Always validate the signature of JWTs using the public keys from the JWKS"}),(0,p.jsx)("li",{children:"Check that the key's intended use (if specified) matches your use case"}),(0,p.jsx)("li",{children:"Consider caching the JWKS to improve performance, but refresh regularly"}),(0,p.jsx)("li",{children:"Always use HTTPS when fetching JWKS endpoints"})]})]})})]})]})})},H=["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512"],P={HS:"HMAC with SHA-2 - Symmetric key signatures using a shared secret",RS:"RSASSA-PKCS1-v1_5 - RSA signatures with PKCS#1 v1.5 padding",ES:"ECDSA - Elliptic Curve Digital Signature Algorithm",PS:"RSASSA-PSS - RSA signatures with Probabilistic Signature Scheme"},Z=function(e){return e.startsWith("HS")?"bg-blue-500":e.startsWith("RS")?"bg-green-500":e.startsWith("ES")?"bg-purple-500":e.startsWith("PS")?"bg-orange-500":"bg-gray-500"},z=function(e){return e.toLocaleString(void 0,{maximumFractionDigits:2})},M=function(){var e,r,a,n=(0,s.useState)(!1),l=n[0],m=n[1],u=(0,s.useState)(null),h=u[0],g=u[1],b=(0,s.useState)(0),y=b[0],f=b[1],j=(0,s.useState)([]),v=j[0],k=j[1],N=(0,s.useState)(null),S=N[0],w=N[1],T=(0,s.useState)(!1),A=T[0],J=T[1],W=(0,s.useState)("performance"),O=W[0],R=W[1],D=(0,s.useCallback)((e=(0,c.Z)(x().mark(function e(r){var s,a,n,i,l;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=performance.now(),a=r.startsWith("ES")?50:100,e.next=5,t.e(23).then(t.bind(t,23));case 5:return n=e.sent,e.next=8,n.bench(r);case 8:return i=e.sent,l=performance.now()-s,e.abrupt("return",{algorithm:r,operationsPerSecond:i,averageTime:a>0?l/a:0,totalOperations:a,color:Z(r)});case 14:return e.prev=14,e.t0=e.catch(0),console.error("Error benchmarking ".concat(r,":"),e.t0),e.abrupt("return",{algorithm:r,operationsPerSecond:0,averageTime:0,totalOperations:0,color:Z(r)});case 18:case"end":return e.stop()}},e,null,[[0,14]])})),function(r){return e.apply(this,arguments)}),[]),M=(0,s.useCallback)((0,c.Z)(x().mark(function e(){var r,t,s,a;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m(!0),k([]),w(null),f(0),e.prev=4,r=[],t=0;case 7:if(!(t<H.length)){e.next=20;break}return g(s=H[t]),e.next=12,new Promise(function(e){return setTimeout(e,100)});case 12:return e.next=14,D(s);case 14:a=e.sent,r.push(a),f((t+1)/H.length*100);case 17:t++,e.next=7;break;case 20:k([].concat(r).sort(function(e,r){return r.operationsPerSecond-e.operationsPerSecond})),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(4),w(e.t0 instanceof Error?e.t0.message:"An error occurred during benchmarking");case 27:return e.prev=27,g(null),m(!1),e.finish(27);case 31:case"end":return e.stop()}},e,null,[[4,24,27,31]])})),[D]);(0,s.useEffect)(function(){v.length>0&&k((0,o.Z)(v).sort(function(e,r){return"algorithm"===O?e.algorithm.localeCompare(r.algorithm):r.operationsPerSecond-e.operationsPerSecond}))},[O]);var _=(0,s.useCallback)(function(){return 0===v.length?null:v.reduce(function(e,r){return r.operationsPerSecond>e.operationsPerSecond?r:e})},[v]),F=(0,s.useCallback)(function(){var e={};return v.forEach(function(r){var t=r.algorithm.substring(0,2);e[t]||(e[t]=[]),e[t].push(r)}),e},[v]),K=(0,s.useCallback)(function(){if(0===v.length)return null;var e=Math.max.apply(Math,(0,o.Z)(v.map(function(e){return e.operationsPerSecond})));return(0,p.jsx)("div",{className:"mt-4",children:v.map(function(r,t){var s=r.operationsPerSecond/e*100,a=r.operationsPerSecond===e;return(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("span",{className:"font-medium w-16",children:r.algorithm}),a&&(0,p.jsx)(E.Ct,{color:"success",className:"ml-2",children:"Fastest"})]}),(0,p.jsxs)("span",{className:"text-sm",children:[z(r.operationsPerSecond)," op/s"]})]}),(0,p.jsx)("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-md overflow-hidden",children:(0,p.jsx)("div",{className:"h-full ".concat(r.color," transition-all duration-1000 ease-out"),style:{width:"".concat(s,"%"),animationDelay:"".concat(.1*t,"s"),opacity:l?.7:1}})}),A&&(0,p.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex justify-between",children:[(0,p.jsxs)("span",{children:["Avg: ",z(r.averageTime)," ms/op"]}),(0,p.jsxs)("span",{children:["Total: ",r.totalOperations," operations"]})]})]},r.algorithm)})})},[v,l,A]),U=(0,s.useCallback)(function(){var e=F();return(0,p.jsx)("div",{className:"mt-6 space-y-6",children:Object.entries(e).map(function(e){var r=(0,d.Z)(e,2),t=r[0],s=r[1];return(0,p.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-md",children:[(0,p.jsxs)("h4",{className:"font-medium mb-2",children:[t," Family"]}),(0,p.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:P[t]||"JWT signature algorithm family"}),(0,p.jsx)("div",{className:"space-y-3",children:s.map(function(e){return(0,p.jsxs)("div",{className:"flex justify-between items-center",children:[(0,p.jsx)("span",{children:e.algorithm}),(0,p.jsxs)("div",{className:"font-mono",children:[z(e.operationsPerSecond)," op/s"]})]},e.algorithm)})})]},t)})})},[F]);return(0,p.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,p.jsxs)("div",{className:"text-center mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"JWT Algorithm Performance"}),(0,p.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Benchmark JWT signing algorithms in your browser to determine the best performance."})]}),(0,p.jsxs)(i.Zb,{className:"mb-6",children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h3",{className:"text-lg font-semibold",children:"Performance Benchmark"})}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:(0,p.jsxs)("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[(0,p.jsx)("span",{className:"mr-2",children:"⚡"}),"This tool tests JWT algorithm performance in your browser. Results may vary based on device capabilities and browser implementation."]})}),(0,p.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,p.jsx)(C.zx,{onClick:M,variant:"primary",disabled:l,children:l?"Benchmarking...":"Run Benchmark"}),v.length>0&&(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("label",{className:"mr-2 text-sm",children:"Sort by:"}),(0,p.jsxs)("select",{value:O,onChange:function(e){return R(e.target.value)},className:"border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm p-1",children:[(0,p.jsx)("option",{value:"performance",children:"Speed (fastest first)"}),(0,p.jsx)("option",{value:"algorithm",children:"Algorithm name"})]})]})]}),l&&h&&(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,p.jsxs)("span",{className:"text-sm",children:["Testing algorithm: ",(0,p.jsx)("strong",{children:h})]}),(0,p.jsxs)("span",{className:"text-sm",children:[Math.round(y),"%"]})]}),(0,p.jsx)("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,p.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-300 ease-out",style:{width:"".concat(y,"%")}})})]}),S&&(0,p.jsx)(I.bZ,{type:"error",className:"mb-4",children:S}),v.length>0&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mb-2 flex justify-between items-center",children:[(0,p.jsx)("h4",{className:"font-medium",children:"Results"}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("input",{type:"checkbox",id:"show-details",checked:A,onChange:function(){return J(!A)},className:"mr-2"}),(0,p.jsx)("label",{htmlFor:"show-details",className:"text-sm",children:"Show detailed metrics"})]})]}),K(),!l&&_()&&(0,p.jsxs)("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-md border border-green-200 dark:border-green-800",children:[(0,p.jsx)("div",{className:"font-medium text-green-800 dark:text-green-300 mb-1",children:"Performance Summary"}),(0,p.jsxs)("p",{className:"text-green-800 dark:text-green-200 text-sm",children:[(0,p.jsx)("span",{className:"font-medium",children:null===(r=_())||void 0===r?void 0:r.algorithm})," is the fastest algorithm in your browser, performing ",z((null===(a=_())||void 0===a?void 0:a.operationsPerSecond)||0)," operations per second."]})]}),(0,p.jsxs)("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-4",children:[(0,p.jsx)("h4",{className:"font-medium mb-3",children:"Algorithm Family Comparison"}),U()]}),(0,p.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,p.jsxs)("div",{className:"flex justify-between items-center",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{className:"text-sm font-medium",children:"System:"}),(0,p.jsx)("span",{className:"ml-2 text-sm",children:navigator.userAgent})]}),(0,p.jsx)("div",{children:(0,p.jsx)(E.Ct,{color:"info",children:new Date().toLocaleString()})})]})})]}),!l&&0===v.length&&(0,p.jsx)("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:'Click "Run Benchmark" to test JWT algorithm performance in your browser.'})]})]}),(0,p.jsxs)(i.Zb,{children:[(0,p.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)("h3",{className:"text-lg font-semibold",children:"About JWT Algorithms"})}),(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{className:"font-medium mb-2",children:"Symmetric Algorithms (HS*)"}),(0,p.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"HMAC with SHA-2 algorithms use a shared secret key for both signing and verification. They are typically faster but require secure key distribution."}),(0,p.jsxs)("ul",{className:"list-disc pl-5 text-sm space-y-1 text-gray-600 dark:text-gray-400",children:[(0,p.jsx)("li",{children:"HS256: HMAC using SHA-256"}),(0,p.jsx)("li",{children:"HS384: HMAC using SHA-384"}),(0,p.jsx)("li",{children:"HS512: HMAC using SHA-512"})]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{className:"font-medium mb-2",children:"Asymmetric Algorithms (RS*, ES*, PS*)"}),(0,p.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Asymmetric algorithms use a private key for signing and a public key for verification. They are typically slower but provide better security separation."}),(0,p.jsxs)("ul",{className:"list-disc pl-5 text-sm space-y-1 text-gray-600 dark:text-gray-400",children:[(0,p.jsx)("li",{children:"RS256: RSA Signature with SHA-256"}),(0,p.jsx)("li",{children:"ES256: ECDSA Signature with SHA-256"}),(0,p.jsx)("li",{children:"PS256: RSA-PSS Signature with SHA-256"})]})]})]}),(0,p.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,p.jsx)("h4",{className:"font-medium mb-2",children:"Choosing the Right Algorithm"}),(0,p.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"When selecting a JWT signing algorithm, consider these factors:"}),(0,p.jsxs)("ul",{className:"list-disc pl-5 text-sm space-y-2 text-gray-600 dark:text-gray-400",children:[(0,p.jsxs)("li",{children:[(0,p.jsx)("span",{className:"font-medium",children:"Performance"}),": HMAC algorithms (HS*) are typically faster than RSA (RS*/PS*) and ECDSA (ES*)."]}),(0,p.jsxs)("li",{children:[(0,p.jsx)("span",{className:"font-medium",children:"Security"}),": ES256 offers similar security to RS256 with smaller signatures and better performance."]}),(0,p.jsxs)("li",{children:[(0,p.jsx)("span",{className:"font-medium",children:"Key Management"}),": Asymmetric algorithms allow public key distribution without exposing signing capabilities."]}),(0,p.jsxs)("li",{children:[(0,p.jsx)("span",{className:"font-medium",children:"Standards Compliance"}),": Some standards require specific algorithms (e.g., OIDC prefers RS256)."]})]})]})]})]})]})},_=function(){var e=(0,s.useState)("/"),r=e[0],t=e[1],d=(0,n.C5)("/jwt"),c="JWT Toolkit | MyDebugger",o="Complete JWT toolkit for developers: decode, create, inspect, verify and benchmark JSON Web Tokens with our comprehensive suite of JWT tools.";return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(a.q,{children:[(0,p.jsx)("title",{children:c}),(0,p.jsx)("meta",{name:"description",content:o}),(0,p.jsx)("meta",{property:"og:title",content:c}),(0,p.jsx)("meta",{property:"og:description",content:o}),(0,p.jsx)("meta",{property:"og:type",content:"website"}),(0,p.jsx)("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),(0,p.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,p.jsx)("meta",{name:"twitter:title",content:c}),(0,p.jsx)("meta",{name:"twitter:description",content:o}),(0,p.jsx)("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),(0,p.jsx)(i.Sj,{tool:d,children:(0,p.jsxs)(i.Zb,{className:"p-0 overflow-visible",children:[(0,p.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,p.jsx)(l.v0,{activeTab:r,onChange:function(e){t(e)},children:[{id:"/",label:"Decoder",title:"Decode & Verify JWT Tokens"},{id:"/inspect",label:"Inspector",title:"Deep Inspection & Security Analysis"},{id:"/build",label:"Builder",title:"Create & Sign JWT Tokens"},{id:"/jwks",label:"JWKS",title:"JWKS Tool & Public Key Discovery"},{id:"/benchmark",label:"Performance",title:"Algorithm Performance Benchmarks"}].map(function(e){return(0,p.jsx)(l.OK,{id:e.id,children:e.label},e.id)})})}),(0,p.jsx)(v,{children:(0,p.jsxs)("div",{className:"p-5",children:[(0,p.jsx)(l.x4,{id:"/",active:"/"===r,children:(0,p.jsx)(N,{})}),(0,p.jsx)(l.x4,{id:"/inspect",active:"/inspect"===r,children:(0,p.jsx)(R,{})}),(0,p.jsx)(l.x4,{id:"/build",active:"/build"===r,children:(0,p.jsx)(O,{})}),(0,p.jsx)(l.x4,{id:"/jwks",active:"/jwks"===r,children:(0,p.jsx)(D,{})}),(0,p.jsx)(l.x4,{id:"/benchmark",active:"/benchmark"===r,children:(0,p.jsx)(M,{})})]})})]})})]})}}}]);