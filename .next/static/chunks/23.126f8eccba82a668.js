"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23],{23:function(e,r,t){t.r(r),t.d(r,{analyze:function(){return W},analyzeToken:function(){return I},base64UrlDecode:function(){return S},base64UrlEncode:function(){return m},bench:function(){return K},benchmarkAlgorithm:function(){return O},decode:function(){return B},decodeSafely:function(){return A},generateKeyPair:function(){return H},sign:function(){return N},signToken:function(){return C},verify:function(){return R},verifyToken:function(){return P}});var n,a,i,o,s,c,u,p=t(7812),h=t(8307),l=t(6835),d=t(29),f=t(4687),k=t.n(f);function b(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?b(Object(t),!0).forEach(function(r){(0,h.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var m=function(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},S=function(e){switch((e=e.replace(/-/g,"+").replace(/_/g,"/")).length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Error("Invalid base64url string")}try{return decodeURIComponent(escape(atob(e)))}catch(r){try{return atob(e)}catch(e){throw Error("Invalid base64 content")}}},g=function(e){return/^-----BEGIN ([A-Z\s]+)-----/.test(e)&&/-----END ([A-Z\s]+)-----$/.test(e)},v=function(e){var r=e.match(/^\x2D\x2D\x2D\x2D\x2DBEGIN [^-]+\x2D\x2D\x2D\x2D\x2D\s*([A-Za-z0-9+\/=\s]+)\x2D\x2D\x2D\x2D\x2DEND [^-]+\x2D\x2D\x2D\x2D\x2D$/);if(!r||!r[1])throw Error("Invalid PEM format");return r[1].replace(/[\n\r\s]/g,"")},w=function(e){if(g(e)){var r=e.includes("PRIVATE KEY");e.includes("PUBLIC KEY");var t=e.includes("RSA"),n=e.includes("EC")||e.includes("ECDSA");return{format:r?"pkcs8":"spki",isBase64:!1,isPem:!0,keyType:t?"RSA":n?"EC":"unknown"}}return{format:"raw",isBase64:/^[A-Za-z0-9+/=]+$/.test(e.trim()),isPem:!1,keyType:e.length>100?"RSA":"HMAC"}},x=function(e){var r=[],t=e;return e!==e.trim()&&r.push("Token contains extra whitespace that was removed"),(t=t.trim()).toLowerCase().startsWith("bearer ")&&(t=t.substring(7).trim(),r.push("Bearer prefix was removed from token")),t.includes("\\n")&&(t=t.replace(/\\n/g,""),r.push("Escaped newlines were removed from token")),t.includes("\n")&&(t=t.replace(/\n/g,""),r.push("Newlines were removed from token")),{token:t,warnings:r}},A=(n=(0,d.Z)(k().mark(function e(r){var t,n,a,i,o,s,c,u,p,h,d,f,b,y,m,g,v;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=(t=x(r)).token,a=t.warnings,r=n){e.next=5;break}return e.abrupt("return",{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:"Empty token",parsingWarnings:a});case 5:if(!(3!==(i=r.split(".")).length)){e.next=9;break}return a.push("Token has ".concat(i.length," parts instead of the expected 3 parts")),e.abrupt("return",{header:i.length>0?E(i[0]):null,payload:i.length>1?E(i[1]):null,signature:i.length>2?i[2]:null,isValid:!1,raw:{header:i.length>0?i[0]:"",payload:i.length>1?i[1]:"",signature:i.length>2?i[2]:""},error:"Invalid JWT format: expected 3 parts",parsingWarnings:a});case 9:s=(o=(0,l.Z)(i,3))[0],c=o[1],u=o[2],p=null,h=null;try{f=S(s),(p=JSON.parse(f))&&!p.alg&&a.push('Token header is missing the "alg" field'),p&&!p.typ&&-1===a.indexOf('Token header is missing the "typ" field')&&a.push('Token header is missing the "typ" field')}catch(e){a.push("Failed to decode header as JSON"),d="Invalid JWT header: failed to parse"}try{b=S(c),(h=JSON.parse(b))&&(void 0!==h.exp?(y=new Date(1e3*h.exp),m=new Date,y<m&&a.push("Token is expired (exp: ".concat(y.toISOString(),", now: ").concat(m.toISOString(),")"))):a.push('Token payload is missing the "exp" field'),void 0!==h.nbf&&(g=new Date(1e3*h.nbf),v=new Date,g>v&&a.push("Token is not yet valid (nbf: ".concat(g.toISOString(),", now: ").concat(v.toISOString(),")"))),void 0===h.iat&&a.push('Token payload is missing the "iat" field'))}catch(e){a.push("Failed to decode payload as JSON"),d=d||"Invalid JWT payload: failed to parse"}return e.abrupt("return",{header:p,payload:h,signature:u,isValid:!1,raw:{header:s,payload:c,signature:u},error:d,parsingWarnings:a.length>0?a:void 0});case 17:return e.prev=17,e.t0=e.catch(0),e.abrupt("return",{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:e.t0 instanceof Error?e.t0.message:"Unknown error decoding token"});case 20:case"end":return e.stop()}},e,null,[[0,17]])})),function(e){return n.apply(this,arguments)});function E(e){try{var r=S(e);return JSON.parse(r)}catch(e){return null}}var T=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(g(e))try{for(var t=v(e),n=atob(t),a=new Uint8Array(n.length),i=0;i<n.length;i++)a[i]=n.charCodeAt(i);return a.buffer}catch(e){throw console.error("PEM parsing failed:",e),Error("Invalid PEM format key")}if(!r)return new TextEncoder().encode(e).buffer;try{for(var o=atob(e),s=new Uint8Array(o.length),c=0;c<o.length;c++)s[c]=o.charCodeAt(c);return s.buffer}catch(e){throw console.error("Base64 parsing failed:",e),Error("Invalid base64 encoded key")}},D=(a=(0,d.Z)(k().mark(function e(r,t,n,a,i,o,s){var c,u,p,h,l,d,f,b,y,m,S;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u=(c=w(t)).format,p=c.isBase64,h=c.isPem,c.keyType,l=[{isBase64:p,keyFormat:u},{isBase64:!1,keyFormat:s?"raw":"spki"},{isBase64:!0,keyFormat:s?"raw":"spki"}],s?l.push({isBase64:!1,keyFormat:"raw"},{isBase64:!0,keyFormat:"raw"}):n.startsWith("RS")||n.startsWith("PS")?l.push({isBase64:!1,keyFormat:"spki"},{isBase64:h,keyFormat:"spki"}):n.startsWith("ES")&&l.push({isBase64:!1,keyFormat:"spki"},{isBase64:h,keyFormat:"spki"}),d=0,f=l;case 4:if(!(d<f.length)){e.next=26;break}return b=f[d],e.prev=6,y=T(t,b.isBase64),e.next=10,window.crypto.subtle.importKey(b.keyFormat,y,a,!1,["verify"]);case 10:return m=e.sent,S=new TextEncoder().encode(i),e.next=15,window.crypto.subtle.verify(a,m,o,S);case 15:if(!e.sent){e.next=18;break}return e.abrupt("return",!0);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),console.log("Key format ".concat(b.keyFormat," (base64: ").concat(b.isBase64,") failed:"),e.t0);case 23:d++,e.next=4;break;case 26:return e.abrupt("return",!1);case 27:case"end":return e.stop()}},e,null,[[6,20]])})),function(e,r,t,n,i,o,s){return a.apply(this,arguments)}),P=(i=(0,d.Z)(k().mark(function e(r,t){var n,a,i,o,s,c,u,p,h,d;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(!r||""===r.trim())){e.next=3;break}throw Error("Token is empty");case 3:if(!(3!==(n=r.split(".")).length)){e.next=6;break}throw Error("Invalid token format (should have 3 parts)");case 6:if(i=(a=(0,l.Z)(n,3))[0],o=a[1],!(!(s=a[2])||""===s.trim())){e.next=9;break}return e.abrupt("return",!1);case 9:e.prev=9,c=E(i),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(9),Error("Invalid token header (not valid base64 or JSON)");case 16:if(!(!c||!c.alg)){e.next=18;break}throw Error("Token header missing algorithm (alg)");case 18:if("none"!==(u=c.alg)){e.next=21;break}return e.abrupt("return",!1);case 21:p=Uint8Array.from(atob(s.replace(/-/g,"+").replace(/_/g,"/")),function(e){return e.charCodeAt(0)}),d=!1,e.t1=u,e.next="HS256"===e.t1?26:"HS384"===e.t1?29:"HS512"===e.t1?32:"RS256"===e.t1?35:"RS384"===e.t1?37:"RS512"===e.t1?39:"PS256"===e.t1?41:"PS384"===e.t1?43:"PS512"===e.t1?45:"ES256"===e.t1?47:"ES384"===e.t1?49:"ES512"===e.t1?51:53;break;case 26:return h={name:"HMAC",hash:"SHA-256"},d=!0,e.abrupt("break",54);case 29:return h={name:"HMAC",hash:"SHA-384"},d=!0,e.abrupt("break",54);case 32:return h={name:"HMAC",hash:"SHA-512"},d=!0,e.abrupt("break",54);case 35:return h={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},e.abrupt("break",54);case 37:return h={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"},e.abrupt("break",54);case 39:return h={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"},e.abrupt("break",54);case 41:return h={name:"RSA-PSS",hash:"SHA-256"},e.abrupt("break",54);case 43:return h={name:"RSA-PSS",hash:"SHA-384"},e.abrupt("break",54);case 45:return h={name:"RSA-PSS",hash:"SHA-512"},e.abrupt("break",54);case 47:return h={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"},e.abrupt("break",54);case 49:return h={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"},e.abrupt("break",54);case 51:return h={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"},e.abrupt("break",54);case 53:throw Error("Unsupported algorithm: ".concat(u));case 54:return e.next=56,D(r,t,u,h,"".concat(i,".").concat(o),p,d);case 56:return e.abrupt("return",e.sent);case 59:throw e.prev=59,e.t2=e.catch(0),console.error("Token verification error:",e.t2),e.t2;case 63:case"end":return e.stop()}},e,null,[[0,59],[9,13]])})),function(e,r){return i.apply(this,arguments)}),C=(o=(0,d.Z)(k().mark(function e(r,t,n){var a,i,o,s,c,u,p,h,l,d,f,b,S,g,v,x;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=(a=y({typ:"JWT"},r)).alg){e.next=5;break}throw Error("Algorithm is required in header");case 5:if(o=m(JSON.stringify(a)),s=m(JSON.stringify(t)),c="".concat(o,".").concat(s),"none"!==i){e.next=10;break}return e.abrupt("return","".concat(c,"."));case 10:e.t0=i,e.next="HS256"===e.t0?14:"HS384"===e.t0?17:"HS512"===e.t0?20:"RS256"===e.t0?23:"RS384"===e.t0?25:"RS512"===e.t0?27:"PS256"===e.t0?29:"PS384"===e.t0?31:"PS512"===e.t0?33:"ES256"===e.t0?35:"ES384"===e.t0?37:"ES512"===e.t0?39:41;break;case 14:return u={name:"HMAC",hash:"SHA-256"},e.abrupt("break",42);case 17:return u={name:"HMAC",hash:"SHA-384"},e.abrupt("break",42);case 20:return u={name:"HMAC",hash:"SHA-512"},e.abrupt("break",42);case 23:return u={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},e.abrupt("break",42);case 25:return u={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"},e.abrupt("break",42);case 27:return u={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"},e.abrupt("break",42);case 29:return u={name:"RSA-PSS",hash:"SHA-256"},e.abrupt("break",42);case 31:return u={name:"RSA-PSS",hash:"SHA-384"},e.abrupt("break",42);case 33:return u={name:"RSA-PSS",hash:"SHA-512"},e.abrupt("break",42);case 35:return u={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"},e.abrupt("break",42);case 37:return u={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"},e.abrupt("break",42);case 39:return u={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"},e.abrupt("break",42);case 41:throw Error("Unsupported algorithm: ".concat(i));case 42:return h=(p=w(n)).format,l=p.isBase64,d=p.isPem?T(n,!1):T(n,l),e.next=46,window.crypto.subtle.importKey(h,d,u,!1,["sign"]);case 46:return f=e.sent,b=new TextEncoder().encode(c),e.next=51,window.crypto.subtle.sign(u,f,b);case 51:for(x=0,S=e.sent,g=new Uint8Array(S),v="";x<g.length;x++)v+=String.fromCharCode(g[x]);return v=m(v),e.abrupt("return","".concat(c,".").concat(v));case 59:throw e.prev=59,e.t1=e.catch(0),console.error("JWT signing error:",e.t1),e.t1;case 63:case"end":return e.stop()}},e,null,[[0,59]])})),function(e,r,t){return o.apply(this,arguments)}),H=(s=(0,d.Z)(k().mark(function e(r){var t,n,a,i,o,s,c,u,h,l,d,f,b=arguments;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=b.length>1&&void 0!==b[1]?b[1]:2048,a="pkcs8",i="spki",!r.startsWith("RS")){e.next=7;break}n={name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:r.replace("RS","SHA-")}},e.next=15;break;case 7:if(!r.startsWith("ES")){e.next=14;break}o="P-256","ES384"===r&&(o="P-384"),"ES512"===r&&(o="P-521"),n={name:"ECDSA",namedCurve:o},e.next=15;break;case 14:throw Error("Unsupported algorithm for key generation: ".concat(r));case 15:return e.next=17,window.crypto.subtle.generateKey(n,!0,["sign","verify"]);case 17:return c=(s=e.sent).publicKey,u=s.privateKey,e.next=22,window.crypto.subtle.exportKey(i,c);case 22:return h=e.sent,e.next=25,window.crypto.subtle.exportKey(a,u);case 25:return l=e.sent,d=btoa(String.fromCharCode.apply(String,(0,p.Z)(new Uint8Array(h)))),f=btoa(String.fromCharCode.apply(String,(0,p.Z)(new Uint8Array(l)))),e.abrupt("return",{publicKey:"-----BEGIN PUBLIC KEY-----\n".concat(d,"\n-----END PUBLIC KEY-----"),privateKey:"-----BEGIN PRIVATE KEY-----\n".concat(f,"\n-----END PRIVATE KEY-----")});case 29:case"end":return e.stop()}},e)})),function(e){return s.apply(this,arguments)}),I=(c=(0,d.Z)(k().mark(function e(r){var t,n,a,i,o;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.next=4,A(r);case 4:if((n=e.sent).header){e.next=8;break}return t.push({id:"malformed-token",title:"Malformed Token",description:"The token could not be parsed correctly.",severity:"high"}),e.abrupt("return",t);case 8:(a=n.header.alg)?("none"===a&&t.push({id:"alg-none",title:'Insecure "none" Algorithm',description:'The token uses the "none" algorithm which is insecure and vulnerable to signature bypass attacks.',severity:"high"}),"HS256"===a&&t.push({id:"weak-hs256",title:"Consider Stronger Algorithm",description:"While acceptable, HS256 offers lower security than HS384 or HS512. Consider using a stronger algorithm for sensitive applications.",severity:"info"})):t.push({id:"missing-alg",title:"Missing Algorithm",description:'The token header is missing the required "alg" field.',severity:"high"}),n.signature&&0!==n.signature.length||t.push({id:"missing-signature",title:"Missing Signature",description:"The token has no signature, making it unverifiable and insecure.",severity:"high"}),n.payload&&(n.payload.exp?(i=Math.floor(Date.now()/1e3),n.payload.exp<i&&t.push({id:"token-expired",title:"Token Expired",description:"The token expired on ".concat(new Date(1e3*n.payload.exp).toLocaleString(),"."),severity:"medium"})):t.push({id:"no-exp",title:"No Expiration",description:"The token does not have an expiration time (exp claim) which is a security risk.",severity:"medium"}),n.payload.iat||t.push({id:"no-iat",title:"No Issuance Time",description:"The token does not have an issuance time (iat claim). This makes token revocation more difficult.",severity:"low"}),n.payload.aud||t.push({id:"no-aud",title:"No Audience",description:"The token does not specify an audience (aud claim). This could lead to token misuse across different services.",severity:"low"}),n.payload.iss||t.push({id:"no-iss",title:"No Issuer",description:"The token does not specify an issuer (iss claim). This could lead to confusion about token origin.",severity:"low"}),n.payload.nbf?(o=Math.floor(Date.now()/1e3),n.payload.nbf>o&&t.push({id:"not-valid-yet",title:"Token Not Valid Yet",description:"The token becomes valid on ".concat(new Date(1e3*n.payload.nbf).toLocaleString(),"."),severity:"medium"})):t.push({id:"no-nbf",title:'No "Not Before" Time',description:'The token does not specify a "not before" time (nbf claim). While not critical, this helps prevent token use before intended.',severity:"info"}),n.payload.jti||t.push({id:"no-jti",title:"No JWT ID",description:"The token does not have a JWT ID (jti claim). This makes token revocation and tracking more difficult.",severity:"info"})),n.header.typ?"JWT"!==n.header.typ&&t.push({id:"unusual-typ",title:"Unusual Token Type",description:'The token specifies an unusual type: "'.concat(n.header.typ,'" instead of the standard "JWT".'),severity:"info"}):t.push({id:"no-typ",title:"No Token Type",description:"The token does not specify a type (typ claim) in the header. This is recommended for interoperability.",severity:"info"}),n.header.kid||t.push({id:"no-kid",title:"No Key ID",description:"The token does not specify a key ID (kid header). This is recommended when multiple keys are used.",severity:"info"}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),t.push({id:"parse-error",title:"Token Parse Error",description:e.t0 instanceof Error?e.t0.message:"Unknown error parsing token",severity:"high"});case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),function(e){return c.apply(this,arguments)}),O=(u=(0,d.Z)(k().mark(function e(r){var t,n,a,i,o,s,c;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=100,n={sub:"1234567890",name:"John Doe",iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+3600,data:Array(1024).fill("a").join("")},a={alg:r,typ:"JWT"},i=Array(32).fill(0).map(function(){return Math.floor(256*Math.random()).toString(16).padStart(2,"0")}).join(""),o=performance.now(),s=0;case 7:if(!(s<t)){e.next=20;break}return e.prev=8,e.next=11,C(a,y(y({},n),{},{nonce:s}),i);case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(8),console.error("Error benchmarking algorithm ".concat(r,":"),e.t0),e.abrupt("return",0);case 17:s++,e.next=7;break;case 20:return c=performance.now()-o,e.abrupt("return",Math.floor(t/(c/1e3)));case 23:case"end":return e.stop()}},e,null,[[8,13]])})),function(e){return u.apply(this,arguments)}),N=C,R=P,B=A,K=O,W=I}}]);