"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[806],{1219:function(e,r,t){t.r(r),t.d(r,{default:function(){return O}});var n=t(29),a=t(4687),s=t.n(a),i=t(7294),c=t(4593),o=t(6738),l=t(1579),d=t(8307),u=t(4730),m=t(5893),h=["variant","size","isLoading","isFullWidth","leftIcon","rightIcon","children","className","disabled"];function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function x(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach(function(r){(0,d.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var f=function(e){var r=e.variant,t=e.size,n=e.isLoading,a=void 0!==n&&n,s=e.isFullWidth,i=e.leftIcon,c=e.rightIcon,o=e.children,l=e.className,d=e.disabled,g=(0,u.Z)(e,h),f=["font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-opacity-50 transition-colors",{primary:"bg-blue-600 hover:bg-blue-700 text-white",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-800",tertiary:"bg-transparent border border-gray-300 hover:bg-gray-100 text-gray-700",danger:"bg-red-600 hover:bg-red-700 text-white",ghost:"bg-transparent hover:bg-gray-100 text-gray-700"}[void 0===r?"primary":r],{sm:"py-1 px-3 text-sm",md:"py-2 px-4 text-base",lg:"py-3 px-6 text-lg"}[void 0===t?"md":t],void 0!==s&&s?"w-full":"",d||a?"opacity-50 cursor-not-allowed":"",void 0===l?"":l].join(" ");return(0,m.jsx)("button",x(x({className:f,disabled:d||a},g),{},{children:a?(0,m.jsxs)("div",{className:"flex items-center justify-center",children:[(0,m.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-gray-300 border-t-white mr-2"}),o]}):(0,m.jsxs)("div",{className:"flex items-center justify-center",children:[i&&(0,m.jsx)("span",{className:"mr-2",children:i}),o,c&&(0,m.jsx)("span",{className:"ml-2",children:c})]})}))},p=function(e){var r=e.size,t=e.color,n=void 0===t?"currentColor":t,a=e.className,s="animate-spin ".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[void 0===r?"md":r]," ").concat(void 0===a?"":a);return(0,m.jsxs)("svg",{className:s,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,m.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:n,strokeWidth:"4"}),(0,m.jsx)("path",{className:"opacity-75",fill:n,d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},y=t(7812),b=function(){try{var e=localStorage.getItem("clickjacking-history");return e?JSON.parse(e):[]}catch(e){return console.error("Error loading validation history:",e),[]}},j=function(e){try{var r=b(),t=[{id:Date.now().toString(),result:e}].concat((0,y.Z)(r)).slice(0,20);return localStorage.setItem("clickjacking-history",JSON.stringify(t)),t}catch(e){return console.error("Error saving to history:",e),b()}},k=function(){try{return localStorage.removeItem("clickjacking-history"),[]}catch(e){return console.error("Error clearing history:",e),[]}};function v(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function w(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?v(Object(t),!0).forEach(function(r){(0,d.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var N=function(e){var r=(0,i.useState)(e||""),t=r[0],a=r[1],c=(0,i.useState)(""),o=c[0],l=c[1],d=(0,i.useState)(!1),u=d[0],m=d[1],h=(0,i.useState)(null),g=h[0],x=h[1],f=(0,i.useState)(null),p=f[0],y=f[1],v=(0,i.useState)([]),N=v[0],O=v[1],S=(0,i.useState)(!1),P=S[0],E=S[1],C=(0,i.useState)(!1),A=C[0],F=C[1];(0,i.useEffect)(function(){O(b()),e&&a(e)},[e]),(0,i.useEffect)(function(){var e;l((e=t)?(e=e.trim()).startsWith("http://")||e.startsWith("https://")?e:"https://".concat(e):"")},[t]);var I=(0,i.useCallback)((0,n.Z)(s().mark(function e(){var r,t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return y("Please enter a URL"),e.abrupt("return");case 3:return m(!0),y(null),x(null),e.prev=6,e.next=9,fetch("/api/security/clickjacking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:o})});case 9:if((r=e.sent).ok){e.next=15;break}return e.next=13,r.json();case 13:throw Error(e.sent.message||"Failed to validate URL");case 15:return e.next=17,r.json();case 17:x(t=w(w({},e.sent),{},{timestamp:new Date})),O(j(t)),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(6),y(e.t0 instanceof Error?e.t0.message:"An unexpected error occurred");case 27:return e.prev=27,m(!1),e.finish(27);case 30:case"end":return e.stop()}},e,null,[[6,24,27,30]])})),[o]),L=(0,i.useCallback)(function(e){a(e.result.url),x(e.result)},[]);return{url:t,formattedUrl:o,loading:u,result:g,error:p,history:N,showHistory:P,showHelp:A,setUrl:a,validateUrl:I,loadFromHistory:L,clearHistory:(0,i.useCallback)(function(){O(k())},[]),setShowHistory:E,setShowHelp:F}},O=function(){var e,r=(0,o.C5)("/clickjacking"),t=N(),a=t.url,d=t.setUrl,u=t.loading,h=(t.result,t.error);t.history,t.validateUrl;var g=(0,i.useState)(!1),x=g[0],y=g[1],b=(0,i.useState)(!1),j=b[0],k=b[1],v=(0,i.useRef)(null),w="Click Jacking Validator | MyDebugger",O="Test if a website is vulnerable to click jacking attacks by examining headers and framing capability.",S=function(e){try{return new URL(e),!0}catch(e){return!1}},P=(e=(0,n.Z)(s().mark(function e(){var r,t,n,i,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(setLoading(!0),setError(null),setResults(null),k(!1),y(!1),S(r=a?a.startsWith("http://")||a.startsWith("https://")?a:"https://".concat(a):"")){e.next=10;break}return setError("Please enter a valid URL"),setLoading(!1),e.abrupt("return");case 10:return e.prev=10,t="/api/clickjacking-analysis?url=".concat(encodeURIComponent(r)),n={url:r,headers:{},canBeFramed:!0,frameLoaded:!1,timestamp:new Date},e.next=15,fetch(t);case 15:if((i=e.sent).ok){e.next=21;break}return e.next=19,i.json();case 19:throw Error(e.sent.error||"Server returned ".concat(i.status));case 21:return e.next=23,i.json();case 23:c=e.sent,n.statusCode=c.status,n.statusText=c.statusText,c.headers["x-frame-options"]&&(n.headers["x-frame-options"]=c.headers["x-frame-options"]),c.headers["content-security-policy"]&&(n.headers["content-security-policy"]=c.headers["content-security-policy"]),c.clickjackingProtection&&c.clickjackingProtection.frameAncestorsValue&&(n.headers["frame-ancestors"]=c.clickjackingProtection.frameAncestorsValue),n.canBeFramed=!c.clickjackingProtection.protected,n.canBeFramed?c.recommendations&&c.recommendations.length&&(n.message="Recommendations: ".concat(c.recommendations.join("; "))):c.clickjackingProtection.hasXFrameOptions?n.message="X-Frame-Options header is set to ".concat(c.headers["x-frame-options"]):c.clickjackingProtection.hasCSPProtection?n.message="Content-Security-Policy header restricts framing with: ".concat(c.clickjackingProtection.frameAncestorsValue):n.message="Site is protected against clickjacking",setResults(n),e.next=37;break;case 34:e.prev=34,e.t0=e.catch(10),setError("Error validating website: ".concat(e.t0 instanceof Error?e.t0.message:"Unknown error"));case 37:return e.prev=37,setLoading(!1),e.finish(37);case 40:case"end":return e.stop()}},e,null,[[10,34,37,40]])})),function(){return e.apply(this,arguments)});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(c.q,{children:[(0,m.jsx)("title",{children:w}),(0,m.jsx)("meta",{name:"description",content:O}),(0,m.jsx)("meta",{property:"og:title",content:w}),(0,m.jsx)("meta",{property:"og:description",content:O}),(0,m.jsx)("meta",{property:"og:type",content:"website"}),(0,m.jsx)("meta",{property:"og:url",content:"https://mydebugger.vercel.app/clickjacking"}),(0,m.jsx)("meta",{name:"twitter:card",content:"summary"}),(0,m.jsx)("meta",{name:"twitter:title",content:w}),(0,m.jsx)("meta",{name:"twitter:description",content:O}),(0,m.jsx)("link",{rel:"canonical",href:"https://mydebugger.vercel.app/clickjacking"})]}),(0,m.jsx)(l.Sj,{tool:r,children:(0,m.jsxs)("div",{className:"space-y-6",children:[(0,m.jsx)(l.Zb,{isElevated:!0,children:(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"url-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Enter website URL to check for click jacking vulnerabilities"}),(0,m.jsxs)("div",{className:"flex",children:[(0,m.jsx)("input",{id:"url-input",type:"text",className:"flex-grow rounded-l-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:border-primary-500 focus:ring focus:ring-primary-200 dark:focus:ring-primary-900 focus:ring-opacity-50",placeholder:"example.com",value:a,onChange:function(e){return d(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&P()},disabled:u}),(0,m.jsx)(f,{onClick:P,isLoading:u,disabled:u||!a,className:"rounded-l-none",children:"Check"})]}),(0,m.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Enter a URL to check if it's vulnerable to click jacking attacks"})]}),h&&(0,m.jsx)("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md text-red-700 dark:text-red-400 text-sm",children:h}),u&&(0,m.jsx)("div",{className:"flex justify-center py-8",children:(0,m.jsx)(p,{})}),results&&!u&&(0,m.jsxs)("div",{className:"animate-fade-in space-y-6",children:[(0,m.jsxs)("div",{className:"p-4 rounded-md border border-gray-200 dark:border-gray-700",children:[(0,m.jsx)("h3",{className:"font-medium text-lg mb-3 text-gray-800 dark:text-gray-200",children:"Summary"}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{className:"p-3 rounded-md bg-gray-50 dark:bg-gray-800",children:[(0,m.jsxs)("div",{className:"flex justify-between items-center",children:[(0,m.jsx)("span",{className:"font-medium",children:"URL"}),(0,m.jsx)("a",{href:results.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 text-sm",children:"Visit Site ↗"})]}),(0,m.jsx)("div",{className:"mt-1 text-sm break-all",children:results.url})]}),(0,m.jsxs)("div",{className:"p-3 rounded-md ".concat(results.canBeFramed?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"),children:[(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("span",{className:"font-medium",children:"Click Jacking Protection"}),results.canBeFramed?(0,m.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 rounded-full",children:"Vulnerable"}):(0,m.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Protected"})]}),(0,m.jsx)("div",{className:"mt-1 text-sm",children:results.canBeFramed?"This site may be vulnerable to click jacking attacks":"This site is protected against click jacking"})]})]}),(0,m.jsxs)("div",{className:"mt-4",children:[(0,m.jsx)("h4",{className:"font-medium text-md mb-2 text-gray-800 dark:text-gray-200",children:"Security Headers"}),(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"font-medium",children:"X-Frame-Options"}),results.headers["x-frame-options"]?(0,m.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Present"}):(0,m.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 rounded-full",children:"Missing"})]}),(0,m.jsxs)("div",{className:"mt-1 text-sm",children:[results.headers["x-frame-options"]||"Not specified",!results.headers["x-frame-options"]&&(0,m.jsx)("p",{className:"text-xs mt-1 text-yellow-600 dark:text-yellow-400",children:'Recommendation: Add X-Frame-Options header with value "DENY" or "SAMEORIGIN"'})]})]}),(0,m.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{className:"font-medium",children:"CSP frame-ancestors"}),results.headers["frame-ancestors"]?(0,m.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Present"}):(0,m.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 rounded-full",children:"Missing"})]}),(0,m.jsxs)("div",{className:"mt-1 text-sm",children:[results.headers["frame-ancestors"]||"Not specified",!results.headers["frame-ancestors"]&&(0,m.jsx)("p",{className:"text-xs mt-1 text-yellow-600 dark:text-yellow-400",children:"Recommendation: Add Content-Security-Policy header with frame-ancestors directive set to \"'none'\" or \"'self'\""})]})]})]})]})]}),(0,m.jsxs)("div",{className:"p-4 rounded-md border border-gray-200 dark:border-gray-700",children:[(0,m.jsx)("h3",{className:"font-medium text-lg mb-3 text-gray-800 dark:text-gray-200",children:"iframe Test"}),(0,m.jsx)("div",{className:"mb-3 text-sm text-gray-600 dark:text-gray-400",children:"This test attempts to load the website in an iframe. If the website has click jacking protection, the iframe should not display content."}),(0,m.jsx)("div",{className:"relative rounded-md overflow-hidden border border-gray-300 dark:border-gray-600",style:{height:"400px"},children:u?(0,m.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50 dark:bg-gray-800",children:(0,m.jsx)(p,{})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("iframe",{ref:v,src:results.url,className:"w-full h-full",onLoad:handleIframeLoad,onError:handleIframeError,sandbox:"allow-same-origin allow-scripts",title:"Click Jacking Test"}),x&&(0,m.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50/90 dark:bg-gray-800/90",children:(0,m.jsxs)("div",{className:"text-center p-4",children:[(0,m.jsx)("div",{className:"text-red-500 dark:text-red-400 mb-2",children:(0,m.jsx)("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,m.jsx)("h4",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Failed to load content"}),(0,m.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"The website could not be loaded in an iframe, which may indicate click jacking protection."})]})}),!x&&j&&(0,m.jsx)("div",{className:"absolute top-0 left-0 right-0 bg-red-500 text-white text-center py-1 text-sm",children:"This website can be embedded in iframes (potentially vulnerable to click jacking)"})]})})]})]}),results&&(0,m.jsx)("div",{className:"flex justify-center pt-2",children:(0,m.jsx)(f,{onClick:function(){d(""),setResults(null),setError(null),k(!1),y(!1)},variant:"light",children:"Test Another Site"})})]})}),(0,m.jsx)(l.Zb,{title:"About Click Jacking",isElevated:!0,children:(0,m.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[(0,m.jsx)("p",{children:"Click jacking is a malicious technique where an attacker tricks a user into clicking something different from what they perceive, potentially causing them to perform unintended actions."}),(0,m.jsx)("h3",{children:"How Click Jacking Works"}),(0,m.jsx)("p",{children:"In a typical click jacking attack, the attacker loads the target website in a transparent iframe and overlays it with their own content. When users think they are clicking on the visible content, they are actually clicking on elements in the invisible, target website."}),(0,m.jsx)("h3",{children:"Protection Methods"}),(0,m.jsxs)("ul",{children:[(0,m.jsxs)("li",{children:[(0,m.jsx)("strong",{children:"X-Frame-Options Header:"})," Prevents a webpage from being displayed in a frame. Values include:",(0,m.jsxs)("ul",{children:[(0,m.jsxs)("li",{children:[(0,m.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"DENY"})," - prevents any domain from framing the content"]}),(0,m.jsxs)("li",{children:[(0,m.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"SAMEORIGIN"})," - allows framing by the same site"]}),(0,m.jsxs)("li",{children:[(0,m.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"ALLOW-FROM uri"})," - permits specified origins to frame"]})]})]}),(0,m.jsxs)("li",{children:[(0,m.jsx)("strong",{children:"Content Security Policy (frame-ancestors):"})," Modern alternative to X-Frame-Options that provides more flexibility. Examples:",(0,m.jsxs)("ul",{children:[(0,m.jsxs)("li",{children:[(0,m.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"frame-ancestors 'none'"})," - prevents any framing"]}),(0,m.jsxs)("li",{children:[(0,m.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"frame-ancestors 'self'"})," - allows same-origin framing only"]})]})]})]})]})})]})})]})}},2587:function(e,r,t){t.d(r,{Z:function(){return n}});function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}},29:function(e,r,t){function n(e,r,t,n,a,s,i){try{var c=e[s](i),o=c.value}catch(e){t(e);return}c.done?r(o):Promise.resolve(o).then(n,a)}function a(e){return function(){var r=this,t=arguments;return new Promise(function(a,s){var i=e.apply(r,t);function c(e){n(i,a,s,c,o,"next",e)}function o(e){n(i,a,s,c,o,"throw",e)}c(void 0)})}}t.d(r,{Z:function(){return a}})},6835:function(e,r,t){t.d(r,{Z:function(){return a}});var n=t(2937);function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,s,i,c=[],o=!0,l=!1;try{if(s=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;o=!1}else for(;!(o=(n=s.call(t)).done)&&(c.push(n.value),c.length!==r);o=!0);}catch(e){l=!0,a=e}finally{try{if(!o&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(l)throw a}}return c}}(e,r)||(0,n.Z)(e,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},7812:function(e,r,t){t.d(r,{Z:function(){return s}});var n=t(2587),a=t(2937);function s(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,a.Z)(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2937:function(e,r,t){t.d(r,{Z:function(){return a}});var n=t(2587);function a(e,r){if(e){if("string"==typeof e)return(0,n.Z)(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return(0,n.Z)(e,r)}}}}]);