import{j as e,_ as de,C as K,B as W,a as U,T as Y,L as Je,b as Re}from"./index-03788e60.js";import{r as j,R as le,b as We,c as Q,N as De,u as Oe,d as He}from"./react-e68835f7.js";import{H as je}from"./vendor-975fbbe6.js";import{T as he,a as q,b as ae}from"./TabGroup-60a1a443.js";import{A as Z}from"./Alert-858c3a8b.js";import{T as se}from"./Tooltip-bb8efc4b.js";import"./Modal-efe9865f.js";var xe={exports:{}};xe.exports;(function(i){var t=function(){var s=String.fromCharCode,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",u={};function y(r,a){if(!u[r]){u[r]={};for(var d=0;d<r.length;d++)u[r][r.charAt(d)]=d}return u[r][a]}var b={compressToBase64:function(r){if(r==null)return"";var a=b._compress(r,6,function(d){return f.charAt(d)});switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(r){return r==null?"":r==""?null:b._decompress(r.length,32,function(a){return y(f,r.charAt(a))})},compressToUTF16:function(r){return r==null?"":b._compress(r,15,function(a){return s(a+32)})+" "},decompressFromUTF16:function(r){return r==null?"":r==""?null:b._decompress(r.length,16384,function(a){return r.charCodeAt(a)-32})},compressToUint8Array:function(r){for(var a=b.compress(r),d=new Uint8Array(a.length*2),l=0,o=a.length;l<o;l++){var k=a.charCodeAt(l);d[l*2]=k>>>8,d[l*2+1]=k%256}return d},decompressFromUint8Array:function(r){if(r==null)return b.decompress(r);for(var a=new Array(r.length/2),d=0,l=a.length;d<l;d++)a[d]=r[d*2]*256+r[d*2+1];var o=[];return a.forEach(function(k){o.push(s(k))}),b.decompress(o.join(""))},compressToEncodedURIComponent:function(r){return r==null?"":b._compress(r,6,function(a){return v.charAt(a)})},decompressFromEncodedURIComponent:function(r){return r==null?"":r==""?null:(r=r.replace(/ /g,"+"),b._decompress(r.length,32,function(a){return y(v,r.charAt(a))}))},compress:function(r){return b._compress(r,16,function(a){return s(a)})},_compress:function(r,a,d){if(r==null)return"";var l,o,k={},E={},R="",J="",w="",A=2,N=3,S=2,T=[],n=0,c=0,h;for(h=0;h<r.length;h+=1)if(R=r.charAt(h),Object.prototype.hasOwnProperty.call(k,R)||(k[R]=N++,E[R]=!0),J=w+R,Object.prototype.hasOwnProperty.call(k,J))w=J;else{if(Object.prototype.hasOwnProperty.call(E,w)){if(w.charCodeAt(0)<256){for(l=0;l<S;l++)n=n<<1,c==a-1?(c=0,T.push(d(n)),n=0):c++;for(o=w.charCodeAt(0),l=0;l<8;l++)n=n<<1|o&1,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=o>>1}else{for(o=1,l=0;l<S;l++)n=n<<1|o,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=0;for(o=w.charCodeAt(0),l=0;l<16;l++)n=n<<1|o&1,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=o>>1}A--,A==0&&(A=Math.pow(2,S),S++),delete E[w]}else for(o=k[w],l=0;l<S;l++)n=n<<1|o&1,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=o>>1;A--,A==0&&(A=Math.pow(2,S),S++),k[J]=N++,w=String(R)}if(w!==""){if(Object.prototype.hasOwnProperty.call(E,w)){if(w.charCodeAt(0)<256){for(l=0;l<S;l++)n=n<<1,c==a-1?(c=0,T.push(d(n)),n=0):c++;for(o=w.charCodeAt(0),l=0;l<8;l++)n=n<<1|o&1,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=o>>1}else{for(o=1,l=0;l<S;l++)n=n<<1|o,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=0;for(o=w.charCodeAt(0),l=0;l<16;l++)n=n<<1|o&1,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=o>>1}A--,A==0&&(A=Math.pow(2,S),S++),delete E[w]}else for(o=k[w],l=0;l<S;l++)n=n<<1|o&1,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=o>>1;A--,A==0&&(A=Math.pow(2,S),S++)}for(o=2,l=0;l<S;l++)n=n<<1|o&1,c==a-1?(c=0,T.push(d(n)),n=0):c++,o=o>>1;for(;;)if(n=n<<1,c==a-1){T.push(d(n));break}else c++;return T.join("")},decompress:function(r){return r==null?"":r==""?null:b._decompress(r.length,32768,function(a){return r.charCodeAt(a)})},_decompress:function(r,a,d){var l=[],o=4,k=4,E=3,R="",J=[],w,A,N,S,T,n,c,h={val:d(0),position:a,index:1};for(w=0;w<3;w+=1)l[w]=w;for(N=0,T=Math.pow(2,2),n=1;n!=T;)S=h.val&h.position,h.position>>=1,h.position==0&&(h.position=a,h.val=d(h.index++)),N|=(S>0?1:0)*n,n<<=1;switch(N){case 0:for(N=0,T=Math.pow(2,8),n=1;n!=T;)S=h.val&h.position,h.position>>=1,h.position==0&&(h.position=a,h.val=d(h.index++)),N|=(S>0?1:0)*n,n<<=1;c=s(N);break;case 1:for(N=0,T=Math.pow(2,16),n=1;n!=T;)S=h.val&h.position,h.position>>=1,h.position==0&&(h.position=a,h.val=d(h.index++)),N|=(S>0?1:0)*n,n<<=1;c=s(N);break;case 2:return""}for(l[3]=c,A=c,J.push(c);;){if(h.index>r)return"";for(N=0,T=Math.pow(2,E),n=1;n!=T;)S=h.val&h.position,h.position>>=1,h.position==0&&(h.position=a,h.val=d(h.index++)),N|=(S>0?1:0)*n,n<<=1;switch(c=N){case 0:for(N=0,T=Math.pow(2,8),n=1;n!=T;)S=h.val&h.position,h.position>>=1,h.position==0&&(h.position=a,h.val=d(h.index++)),N|=(S>0?1:0)*n,n<<=1;l[k++]=s(N),c=k-1,o--;break;case 1:for(N=0,T=Math.pow(2,16),n=1;n!=T;)S=h.val&h.position,h.position>>=1,h.position==0&&(h.position=a,h.val=d(h.index++)),N|=(S>0?1:0)*n,n<<=1;l[k++]=s(N),c=k-1,o--;break;case 2:return J.join("")}if(o==0&&(o=Math.pow(2,E),E++),l[c])R=l[c];else if(c===k)R=A+A.charAt(0);else return null;J.push(R),l[k++]=A+R.charAt(0),o--,A=R,o==0&&(o=Math.pow(2,E),E++)}}};return b}();i!=null?i.exports=t:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return t})})(xe);var ye=xe.exports;const ve={token:"",decoded:null,isVerified:null,verificationKey:"",error:null,history:[],securityIssues:[],parsingWarnings:[]};function Pe(i,t){switch(t.type){case"SET_TOKEN":return{...i,token:t.payload};case"SET_DECODED":return{...i,decoded:t.payload};case"SET_VERIFIED":return{...i,isVerified:t.payload};case"SET_VERIFICATION_KEY":return{...i,verificationKey:t.payload};case"SET_ERROR":return{...i,error:t.payload};case"ADD_HISTORY_ITEM":return{...i,history:[t.payload,...i.history.filter(s=>s.id!==t.payload.id)].slice(0,10)};case"CLEAR_HISTORY":return{...i,history:[]};case"REMOVE_HISTORY_ITEM":return{...i,history:i.history.filter(s=>s.id!==t.payload)};case"SET_SECURITY_ISSUES":return{...i,securityIssues:t.payload};case"SET_PARSING_WARNINGS":return{...i,parsingWarnings:t.payload};case"RESET":return ve;default:return i}}const ke=j.createContext(void 0),_e=({children:i})=>{const[t,s]=j.useReducer(Pe,ve);le.useEffect(()=>{b()},[]),le.useEffect(()=>{try{localStorage.setItem("jwt.history",JSON.stringify(t.history))}catch(r){console.error("Failed to save JWT history:",r)}},[t.history]),le.useEffect(()=>{try{const r=localStorage.getItem("jwt.history");r&&JSON.parse(r).forEach(d=>{s({type:"ADD_HISTORY_ITEM",payload:d})})}catch(r){console.error("Failed to load JWT history:",r)}},[]);const f=async r=>{var a,d;if(!r){s({type:"SET_DECODED",payload:null}),s({type:"SET_ERROR",payload:null}),s({type:"SET_VERIFIED",payload:null}),s({type:"SET_PARSING_WARNINGS",payload:[]});return}try{r=r.trim(),r.toLowerCase().startsWith("bearer ")&&(r=r.substring(7).trim());const o=await(await de(()=>Promise.resolve().then(()=>me),void 0)).decode(r),k=[];if(o.error&&k.push(o.error),o.header&&o.payload&&o.signature){const E={header:o.header,payload:o.payload,signature:o.signature,raw:o.raw};s({type:"SET_TOKEN",payload:r}),s({type:"SET_DECODED",payload:E}),s({type:"SET_ERROR",payload:null}),s({type:"SET_PARSING_WARNINGS",payload:k}),s({type:"SET_VERIFIED",payload:null});const R=((a=o.payload)==null?void 0:a.sub)||((d=o.payload)==null?void 0:d.name)||`Token ${new Date().toLocaleDateString()}`;s({type:"ADD_HISTORY_ITEM",payload:{id:Math.random().toString(36).substring(2,9),token:r,timestamp:Date.now(),label:R}}),u(r)}else throw new Error("Failed to decode JWT: Invalid token structure")}catch(l){s({type:"SET_ERROR",payload:l instanceof Error?l.message:"Failed to decode JWT"}),s({type:"SET_DECODED",payload:null}),s({type:"SET_VERIFIED",payload:null}),s({type:"SET_PARSING_WARNINGS",payload:[]})}},v=async(r,a)=>{var d,l;if(!t.token||!a){s({type:"SET_VERIFIED",payload:null});return}try{const k=await(await de(()=>Promise.resolve().then(()=>me),void 0)).verify(t.token,a,r||((l=(d=t.decoded)==null?void 0:d.header)==null?void 0:l.alg)||"HS256");s({type:"SET_VERIFICATION_KEY",payload:a}),s({type:"SET_VERIFIED",payload:k}),!k&&t.decoded&&r&&t.decoded.header.alg!==r?s({type:"SET_ERROR",payload:`Algorithm mismatch: Token uses ${t.decoded.header.alg} but ${r} was specified for verification`}):s(k?{type:"SET_ERROR",payload:null}:{type:"SET_ERROR",payload:"Signature verification failed"})}catch(o){s({type:"SET_ERROR",payload:o instanceof Error?o.message:"Failed to verify signature"}),s({type:"SET_VERIFIED",payload:!1})}},u=r=>{if(!t.decoded)return;const a=[];if(t.decoded.header.alg==="none"&&a.push({id:"alg-none",severity:"high",title:"UNSIGNED TOKEN",description:'The token uses algorithm "none" and has no signature. Do not accept in production.'}),t.decoded.payload.exp){const d=t.decoded.payload.exp*1e3;Date.now()>d&&a.push({id:"token-expired",severity:"medium",title:"Token Expired",description:`Token expired on ${new Date(d).toLocaleString()}.`});const l=24*60*60*1e3;d-Date.now()<l&&Date.now()<d&&a.push({id:"token-expiring",severity:"low",title:"Token Expiring Soon",description:`Token will expire on ${new Date(d).toLocaleString()}.`})}else a.push({id:"no-expiration",severity:"medium",title:"No Expiration Time",description:"This token has no expiration time (exp claim), which is not recommended."});if(t.decoded.header.alg&&(["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512"].includes(t.decoded.header.alg)?["HS256","RS256"].includes(t.decoded.header.alg)&&a.push({id:"weak-algorithm",severity:"info",title:"Consider Stronger Algorithm",description:`Algorithm ${t.decoded.header.alg} is widely used but consider stronger alternatives like ES256 or PS256 for better security.`}):a.push({id:"unsupported-algorithm",severity:"high",title:"Unsupported Algorithm",description:`Algorithm ${t.decoded.header.alg} is not among the standard supported JWT algorithms.`})),t.decoded.header.alg&&!t.decoded.header.alg.startsWith("HS")&&!t.decoded.header.kid&&a.push({id:"missing-kid",severity:"low",title:"Missing Key Identifier",description:'This token uses an asymmetric algorithm but has no "kid" (key ID) claim in the header.'}),t.decoded.payload.iat&&typeof t.decoded.payload.iat!="number"&&a.push({id:"invalid-iat",severity:"medium",title:"Invalid Issued At Claim",description:'The "iat" claim should be a numeric timestamp.'}),t.decoded.payload.nbf){const d=t.decoded.payload.nbf*1e3;d>Date.now()&&a.push({id:"future-nbf",severity:"medium",title:"Token Not Yet Valid",description:`This token is not valid until ${new Date(d).toLocaleString()}.`})}s({type:"SET_SECURITY_ISSUES",payload:a})},y=()=>{if(!t.token)return window.location.href.split("#")[0];const r=ye.compressToEncodedURIComponent(t.token);return`${window.location.href.split("#")[0]}#${r}`},b=async()=>{const r=window.location.hash.substring(1);if(r)try{const a=ye.decompressFromEncodedURIComponent(r);if(a)return await f(a),!0}catch(a){console.error("Failed to load token from URL hash:",a)}return!1};return e.jsx(ke.Provider,{value:{state:t,dispatch:s,decodeToken:f,verifySignature:v,analyzeToken:u,shareToken:y,loadFromHash:b},children:i})},ue=()=>{const i=j.useContext(ke);if(i===void 0)throw new Error("useJwt must be used within a JwtProvider");return i},Me=({children:i,as:t="p",size:s="md",weight:f="normal",align:v,color:u="default",truncate:y=!1,lineClamp:b,transform:r,italic:a=!1,underline:d=!1,lineThrough:l=!1,adaptiveLeading:o=!0,className:k="",variant:E,error:R=!1,lineHeight:J,m:w,mt:A,mb:N,ml:S,mr:T,mx:n,my:c,p:h,pt:H,pb:_,pl:$,pr:z,px:V,py:L,style:p})=>{const D=E||t,g=R?"danger":u,C={xs:"text-xs",sm:"text-sm",base:"text-base",md:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl","3xl":"text-3xl","4xl":"text-4xl","5xl":"text-5xl","6xl":"text-6xl","7xl":"text-7xl","8xl":"text-8xl","9xl":"text-9xl"},M=()=>typeof s=="string"?C[s]:[s.base?C[s.base]:"text-base",s.sm?`sm:${C[s.sm]}`:"",s.md?`md:${C[s.md]}`:"",s.lg?`lg:${C[s.lg]}`:"",s.xl?`xl:${C[s.xl]}`:""].filter(Boolean).join(" "),G={thin:"font-thin",extralight:"font-extralight",light:"font-light",normal:"font-normal",medium:"font-medium",semibold:"font-semibold",bold:"font-bold",extrabold:"font-extrabold",black:"font-black"},x=v?{left:"text-left",center:"text-center",right:"text-right",justify:"text-justify"}[v]:"",I={default:"text-gray-800 dark:text-gray-200",primary:"text-primary-600 dark:text-primary-400",secondary:"text-secondary-600 dark:text-secondary-400",success:"text-green-600 dark:text-green-400",danger:"text-red-600 dark:text-red-400",warning:"text-yellow-600 dark:text-yellow-400",info:"text-blue-600 dark:text-blue-400",muted:"text-gray-500 dark:text-gray-500",white:"text-white",black:"text-black",error:"text-red-600 dark:text-red-400"},P=r?{uppercase:"uppercase",lowercase:"lowercase",capitalize:"capitalize",normal:"normal-case"}[r]:"",m=[a?"italic":"",d?"underline":"",l?"line-through":""].filter(Boolean).join(" "),O=()=>y===!0?"truncate":typeof y=="number"?`overflow-hidden text-ellipsis whitespace-nowrap max-w-[${y}ch]`:"",B=b?`line-clamp-${b}`:"",X=J?`leading-${J}`:"",te=()=>{if(X||!o)return"";const F=typeof s=="string"?s:s.base||"md";return["xs","sm","md"].includes(F)?"leading-normal":["lg","xl","2xl"].includes(F)?"leading-relaxed":"leading-tight"},ie=()=>{const F=[];return w!==void 0&&F.push(`m-${w}`),A!==void 0&&F.push(`mt-${A}`),N!==void 0&&F.push(`mb-${N}`),S!==void 0&&F.push(`ml-${S}`),T!==void 0&&F.push(`mr-${T}`),n!==void 0&&F.push(`mx-${n}`),c!==void 0&&F.push(`my-${c}`),h!==void 0&&F.push(`p-${h}`),H!==void 0&&F.push(`pt-${H}`),_!==void 0&&F.push(`pb-${_}`),$!==void 0&&F.push(`pl-${$}`),z!==void 0&&F.push(`pr-${z}`),V!==void 0&&F.push(`px-${V}`),L!==void 0&&F.push(`py-${L}`),F.join(" ")},Ie=[M(),G[f],x,I[g],P,m,O(),B,X||te(),ie(),k].filter(Boolean).join(" ");return e.jsx(D,{className:Ie,style:p,children:i})},$e=()=>{var x,I,P;const{state:i,decodeToken:t,verifySignature:s,analyzeToken:f}=ue(),{token:v,decoded:u,error:y,isVerified:b,verificationKey:r,securityIssues:a,parsingWarnings:d}=i,[l,o]=j.useState(""),[k,E]=j.useState(""),[R,J]=j.useState(!1),[w,A]=j.useState(null),[N,S]=j.useState("json"),[T,n]=j.useState(""),[c,h]=j.useState(!1);j.useEffect(()=>{o(v)},[v]),j.useEffect(()=>{E(r)},[r]),j.useEffect(()=>{const m=setTimeout(()=>{l!==v&&t(l)},300);return()=>clearTimeout(m)},[l,v,t]),j.useEffect(()=>{if(R){const m=setTimeout(()=>{J(!1),A(null)},2e3);return()=>clearTimeout(m)}},[R]),j.useEffect(()=>{if(u!=null&&u.header&&(u!=null&&u.payload)){const m=setTimeout(()=>{h(!0)},1e3);return()=>clearTimeout(m)}else h(!1)},[u]);const H=(m,O)=>{navigator.clipboard.writeText(m),J(!0),A(O)},_=()=>{o(""),E(""),n("")},$=()=>{var O,B,X,te;const m=[];if(u!=null&&u.header&&!b&&m.push(e.jsx("li",{children:"Try to verify the token signature with a secret or public key"},"verify")),(((O=u==null?void 0:u.header)==null?void 0:O.alg)==="none"||((B=u==null?void 0:u.header)==null?void 0:B.alg)==="HS256")&&m.push(e.jsx("li",{children:"Test for algorithm confusion attacks by changing the algorithm"},"alg")),(X=u==null?void 0:u.payload)!=null&&X.exp){const ie=u.payload.exp;p(ie)?m.push(e.jsx("li",{children:"Generate a new token with a future expiration time"},"exp")):m.push(e.jsx("li",{children:"Test token rejection by using an expired token"},"exp-test"))}return(te=u==null?void 0:u.payload)!=null&&te.jti||m.push(e.jsx("li",{children:"Add a JWT ID (jti) claim for better security"},"jti")),m.length===0&&m.push(e.jsx("li",{children:"Modify the payload to test how the application handles different claims"},"general-1"),e.jsx("li",{children:"Test token with different signature algorithms"},"general-2")),e.jsxs("div",{className:"text-sm",children:[e.jsx(Me,{weight:"bold",className:"mb-1",children:"Next steps to try:"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:m})]})},z=()=>{const m=Math.floor(Date.now()/1e3);m+3600,crypto.randomUUID().replace(/-/g,""),m-300,o("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImV4YW1wbGUta2V5LWlkIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiZW1haWwiOiJqb2huLmRvZUBleGFtcGxlLmNvbSIsImlzcyI6Imh0dHBzOi8vYXV0aC5leGFtcGxlLmNvbSIsImF1ZCI6ImNsaWVudC1pZC0xMjMiLCJpYXQiOjE2ODMyMDM1MjQsImV4cCI6MTY4MzIwNzEyNCwibmJmIjoxNjgzMjAzNTI0LCJqdGkiOiI4OTg5OGVlOGQ1YjI0ZjdkYjkzM2MwZGFiZDQzMWJjOCIsImdpdmVuX25hbWUiOiJKb2huIiwiZmFtaWx5X25hbWUiOiJEb2UiLCJuaWNrbmFtZSI6IkpvaG5ueSIsInByZWZlcnJlZF91c2VybmFtZSI6ImpvaG4uZG9lIiwicGljdHVyZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vcHJvZmlsZS9qb2huZG9lLmpwZyIsIndlYnNpdGUiOiJodHRwczovL2pvaG5kb2UuZXhhbXBsZS5jb20iLCJnZW5kZXIiOiJtYWxlIiwiYmlydGhkYXRlIjoiMTk5MC0wMS0wMSIsInBob25lX251bWJlciI6IisxLTIwMi01NTUtMDEyMyIsImFkZHJlc3MiOnsic3RyZWV0X2FkZHJlc3MiOiIxMjMgTWFpbiBTdCIsImxvY2FsaXR5IjoiQW55dG93biIsInJlZ2lvbiI6IlN0YXRlIiwicG9zdGFsX2NvZGUiOiIxMjM0NSIsImNvdW50cnkiOiJVUyJ9LCJyb2xlcyI6WyJ1c2VyIiwiYWRtaW4iXSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImF1dGhfdGltZSI6MTY4MzIwMzIyNCwic2lkIjoic2Vzc2lvbl9pZF8xMjM0NTYiLCJhbXIiOlsicHdkIl0sImF6cCI6ImF1dGhvcml6ZWQtcGFydHktMTIzIn0.xlj7zV5XM7XQg6qNTDxXkpnyb9-4k9JSbzWl6YCGrX4")},V=()=>{s(T,k)},L=m=>{try{return new Date(m*1e3).toLocaleString()}catch{return"Invalid date"}},p=m=>Date.now()>m*1e3,D=m=>{switch(m){case"sub":return"Subject (user) identifier";case"iss":return"Issuer of the token";case"aud":return"Audience the token is intended for";case"exp":return"Expiration time (when token becomes invalid)";case"nbf":return"Not before time (when token starts being valid)";case"iat":return"Issued at time (when token was issued)";case"jti":return"JWT ID (unique identifier for this token)";case"name":return"User name";case"given_name":return"User first name";case"family_name":return"User last name";case"email":return"User email address";case"roles":return"User roles/permissions";case"scope":return"OAuth 2.0 scopes";case"sid":return"Session ID";case"auth_time":return"Time when authentication occurred";default:return"Custom claim"}},g=m=>{switch(m){case"header":return"text-blue-600 dark:text-blue-400";case"payload":return"text-purple-600 dark:text-purple-400";case"signature":return"text-red-600 dark:text-red-400";default:return"text-gray-600"}},C=m=>{switch(m){case"high":return"text-red-600 dark:text-red-400";case"medium":return"text-orange-600 dark:text-orange-400";case"low":return"text-yellow-600 dark:text-yellow-400";case"info":return"text-blue-600 dark:text-blue-400";default:return"text-gray-600 dark:text-gray-400"}},M="JWT Decoder | MyDebugger",G="Decode and verify JSON Web Tokens. Analyze headers, payload claims, and verify signatures securely in your browser.";return e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsx("title",{children:M}),e.jsx("meta",{name:"description",content:G}),e.jsx("meta",{property:"og:title",content:M}),e.jsx("meta",{property:"og:description",content:G}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:M}),e.jsx("meta",{name:"twitter:description",content:G}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JSON Web Token (JWT) Debugger"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Decode, verify, and analyze JSON Web Tokens (JWT) instantly. All processing happens in your browser."})]}),e.jsx("div",{className:"mb-6 bg-yellow-50 dark:bg-yellow-900/20 p-4 border border-yellow-200 dark:border-yellow-800 rounded-md",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 flex items-center justify-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),e.jsx("span",{className:"font-bold",children:"For your protection:"})," All JWT debugging and validation happens entirely in your browser. Your tokens and keys are never sent to any server."]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs(K,{isElevated:!0,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Encoded JWT"}),e.jsx(W,{onClick:z,variant:"light",size:"sm",children:"Generate example"})]}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[e.jsx("textarea",{id:"jwt-input",className:"w-full font-mono text-sm rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 flex-1 min-h-[300px]",value:l,onChange:m=>o(m.target.value),placeholder:"Paste your JWT token here... (supports Bearer tokens and plain JWT)",autoFocus:!0,spellCheck:"false"}),c&&u&&e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(se,{content:$(),position:"bottom",size:"lg",children:e.jsx(U,{variant:"warning",className:"cursor-help flex items-center",children:e.jsx("span",{children:"ðŸ‘‰ Continue to iterate?"})})})}),y&&e.jsx(Z,{type:"error",className:"mt-4",children:y}),d&&d.length>0&&e.jsxs(Z,{type:"warning",className:"mt-4",children:[e.jsx("div",{className:"font-medium mb-1",children:"Parsing Warnings:"}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:d.map((m,O)=>e.jsx("li",{children:m},O))})]}),u&&e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto break-all",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Header:"}),e.jsx("div",{className:`${g("header")} flex-1`,children:u.raw.header})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Payload:"}),e.jsx("div",{className:`${g("payload")} flex-1`,children:u.raw.payload})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Signature:"}),e.jsx("div",{className:`${g("signature")} flex-1`,children:u.raw.signature})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(W,{onClick:_,variant:"light",children:"Reset"})}),e.jsx("div",{children:e.jsx(W,{onClick:()=>H(l,"token"),variant:"primary",disabled:!l,children:R&&w==="token"?"Copied!":"Copy Token"})})]})]})]})}),e.jsx("div",{children:e.jsxs(K,{isElevated:!0,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Decoded Data"}),e.jsxs("div",{className:"flex border border-gray-200 dark:border-gray-700 rounded",children:[e.jsx("button",{className:`px-3 py-1 text-sm rounded-l ${N==="json"?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,onClick:()=>S("json"),children:"JSON"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded-r ${N==="table"?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,onClick:()=>S("table"),children:"Table"})]})]}),e.jsx("div",{className:"p-4 flex-1 flex flex-col overflow-y-auto",children:u?e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:g("header"),children:"HEADER"}),e.jsx(W,{onClick:()=>H(JSON.stringify(u.header,null,2),"header"),variant:"light",size:"xs",className:"ml-2",children:R&&w==="header"?"Copied!":"Copy"})]}),N==="json"?e.jsx("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4 text-sm",children:JSON.stringify(u.header,null,2)}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(u.header).map(([m,O])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:m}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(se,{content:m==="alg"?"Algorithm used to sign the token":m==="typ"?"Token type":`Header claim: ${m}`,children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:String(O)})})})]},m))})]})}),e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:g("payload"),children:"PAYLOAD"}),e.jsx(W,{onClick:()=>H(JSON.stringify(u.payload,null,2),"payload"),variant:"light",size:"xs",className:"ml-2",children:R&&w==="payload"?"Copied!":"Copy"})]}),N==="json"?e.jsx("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto text-sm",children:JSON.stringify(u.payload,null,2)}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(u.payload).map(([m,O])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:m}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(se,{content:D(m),children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:m==="exp"||m==="iat"||m==="nbf"?e.jsxs("div",{children:[e.jsx("div",{children:String(O)}),e.jsxs("div",{className:`text-xs mt-1 ${m==="exp"&&p(O)?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:[L(O),m==="exp"&&e.jsx("span",{className:"ml-2",children:p(O)?e.jsx(U,{color:"danger",size:"sm",children:"Expired"}):e.jsx(U,{color:"success",size:"sm",children:"Valid"})})]})]}):typeof O=="boolean"?e.jsx("span",{className:O?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:String(O)}):typeof O=="object"&&O!==null?e.jsxs("details",{children:[e.jsx("summary",{className:"cursor-pointer",children:"View Object"}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-100 dark:bg-gray-900 rounded text-xs overflow-auto max-h-40",children:JSON.stringify(O,null,2)})]}):String(O)})})})]},m))})]})})]}),c&&e.jsx("div",{className:"relative ml-4",children:e.jsx(W,{variant:"outline-info",onClick:()=>h(!1),size:"sm",className:"animate-pulse",children:"Next steps"})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:g("signature"),children:"SIGNATURE"}),e.jsx(U,{color:b===!0?"success":b===!1?"danger":"light",className:"ml-2",children:b===!0?"Verified":b===!1?"Invalid":"Not verified"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md text-sm",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:["Signature algorithm: ",e.jsx("span",{className:"font-medium",children:u.header.alg||"HS256"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex-grow mb-2",children:[e.jsx("label",{htmlFor:"algorithm-select",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Algorithm (optional, override header)"}),e.jsxs("select",{id:"algorithm-select",className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:T,onChange:m=>n(m.target.value),children:[e.jsx("option",{value:"",children:"Use algorithm from header"}),e.jsxs("optgroup",{label:"HMAC",children:[e.jsx("option",{value:"HS256",children:"HS256"}),e.jsx("option",{value:"HS384",children:"HS384"}),e.jsx("option",{value:"HS512",children:"HS512"})]}),e.jsxs("optgroup",{label:"RSA",children:[e.jsx("option",{value:"RS256",children:"RS256"}),e.jsx("option",{value:"RS384",children:"RS384"}),e.jsx("option",{value:"RS512",children:"RS512"})]}),e.jsxs("optgroup",{label:"RSA-PSS",children:[e.jsx("option",{value:"PS256",children:"PS256"}),e.jsx("option",{value:"PS384",children:"PS384"}),e.jsx("option",{value:"PS512",children:"PS512"})]}),e.jsxs("optgroup",{label:"ECDSA",children:[e.jsx("option",{value:"ES256",children:"ES256"}),e.jsx("option",{value:"ES384",children:"ES384"}),e.jsx("option",{value:"ES512",children:"ES512"})]})]})]}),e.jsxs("div",{className:"flex-grow mb-2",children:[e.jsx("label",{htmlFor:"secret-key",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Secret/Verification key"}),e.jsx("textarea",{id:"secret-key",rows:3,className:"w-full font-mono text-xs rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:k,onChange:m=>E(m.target.value),placeholder:(x=u.header.alg)!=null&&x.startsWith("HS")?"Enter your secret key... (raw string or base64 encoded)":(I=u.header.alg)!=null&&I.startsWith("RS")||(P=u.header.alg)!=null&&P.startsWith("PS")?"Enter your RSA public key (PEM format supported)":"Enter your verification key..."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(W,{onClick:V,variant:"primary",size:"sm",disabled:!k,children:"Verify"})})]}),b!==null&&e.jsx("div",{className:`mt-3 p-2 rounded-md text-sm ${b?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:b?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:b?"Signature verified successfully":"Invalid signature"})]})})]})]}),a&&a.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{children:"SECURITY ANALYSIS"}),e.jsxs(U,{color:a.some(m=>m.severity==="high")?"danger":a.some(m=>m.severity==="medium")?"warning":"info",className:"ml-2",children:[a.length," Issue",a.length!==1?"s":""]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md text-sm",children:a.map(m=>e.jsxs("div",{className:"p-3 border-b last:border-b-0 border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("h4",{className:`font-medium ${C(m.severity)}`,children:m.title}),e.jsx(U,{color:m.severity==="high"?"danger":m.severity==="medium"?"warning":(m.severity==="low","info"),size:"sm",children:m.severity})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:m.description})]},m.id))})]}),c&&e.jsx("div",{className:"relative ml-4",children:e.jsx(W,{variant:"outline-info",onClick:()=>h(!1),size:"sm",className:"animate-pulse",children:"Next steps"})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400 text-center p-6",children:e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"Paste a JWT token on the left to decode it"}),e.jsx("div",{className:"text-sm",children:e.jsx(W,{onClick:z,variant:"light",size:"sm",children:"Or try an example token"})})]})})})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(K,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold",children:"About JWT"})}),e.jsxs("div",{className:"p-4 text-sm",children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:"JSON Web Tokens (JWTs) are an open, industry standard RFC 7519 method for representing claims securely between two parties."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${g("header")}`,children:"Header"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains metadata about the token's type and the signing algorithm."})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${g("payload")}`,children:"Payload"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains the token claims - statements about the user and additional metadata."})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${g("signature")}`,children:"Signature"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Used to verify that the token wasn't changed along the way and came from an authentic source."})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-3",children:e.jsxs("a",{href:"https://jwt.io/introduction",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 inline-flex items-center",children:["Learn more about JWT",e.jsx("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})]})})]})})]})},ee=i=>btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),re=i=>{switch(i=i.replace(/-/g,"+").replace(/_/g,"/"),i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("Invalid base64url string")}try{return decodeURIComponent(escape(atob(i)))}catch{try{return atob(i)}catch{throw new Error("Invalid base64 content")}}},Se=i=>/^-----BEGIN ([A-Z\s]+)-----/.test(i)&&/-----END ([A-Z\s]+)-----$/.test(i),Fe=i=>{const t=i.match(/^-----BEGIN [^-]+-----\s*([A-Za-z0-9+\/=\s]+)-----END [^-]+-----$/s);if(!t||!t[1])throw new Error("Invalid PEM format");return t[1].replace(/[\n\r\s]/g,"")},Ne=i=>{if(Se(i)){const s=i.includes("PRIVATE KEY");i.includes("PUBLIC KEY");const f=i.includes("RSA"),v=i.includes("EC")||i.includes("ECDSA");return{format:s?"pkcs8":"spki",isBase64:!1,isPem:!0,keyType:f?"RSA":v?"EC":"unknown"}}return{format:"raw",isBase64:/^[A-Za-z0-9+/=]+$/.test(i.trim()),isPem:!1,keyType:i.length>100?"RSA":"HMAC"}},we=i=>{const t=[];let s=i;return i!==i.trim()&&t.push("Token contains extra whitespace that was removed"),s=s.trim(),s.toLowerCase().startsWith("bearer ")&&(s=s.substring(7).trim(),t.push("Bearer prefix was removed from token")),s.includes("\\n")&&(s=s.replace(/\\n/g,""),t.push("Escaped newlines were removed from token")),s.includes(`
`)&&(s=s.replace(/\n/g,""),t.push("Newlines were removed from token")),{token:s,warnings:t}},pe=async i=>{try{const{token:t,warnings:s}=we(i);if(i=t,!i)return{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:"Empty token",parsingWarnings:s};const f=i.split(".");if(f.length!==3)return s.push(`Token has ${f.length} parts instead of the expected 3 parts`),{header:f.length>0?fe(f[0]):null,payload:f.length>1?fe(f[1]):null,signature:f.length>2?f[2]:null,isValid:!1,raw:{header:f.length>0?f[0]:"",payload:f.length>1?f[1]:"",signature:f.length>2?f[2]:""},error:"Invalid JWT format: expected 3 parts",parsingWarnings:s};const[v,u,y]=f;let b=null,r=null,a;try{const d=re(v);b=JSON.parse(d),b&&!b.alg&&s.push('Token header is missing the "alg" field'),b&&!b.typ&&s.indexOf('Token header is missing the "typ" field')===-1&&s.push('Token header is missing the "typ" field')}catch{s.push("Failed to decode header as JSON"),a="Invalid JWT header: failed to parse"}try{const d=re(u);if(r=JSON.parse(d),r){if(typeof r.exp<"u"){const l=new Date(r.exp*1e3),o=new Date;l<o&&s.push(`Token is expired (exp: ${l.toISOString()}, now: ${o.toISOString()})`)}else s.push('Token payload is missing the "exp" field');if(typeof r.nbf<"u"){const l=new Date(r.nbf*1e3),o=new Date;l>o&&s.push(`Token is not yet valid (nbf: ${l.toISOString()}, now: ${o.toISOString()})`)}typeof r.iat>"u"&&s.push('Token payload is missing the "iat" field')}}catch{s.push("Failed to decode payload as JSON"),a=a||"Invalid JWT payload: failed to parse"}return{header:b,payload:r,signature:y,isValid:!1,raw:{header:v,payload:u,signature:y},error:a,parsingWarnings:s.length>0?s:void 0}}catch(t){return{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:t instanceof Error?t.message:"Unknown error decoding token"}}};function fe(i){try{const t=re(i);return JSON.parse(t)}catch{return null}}const ce=(i,t=!1)=>{if(Se(i))try{const s=Fe(i),f=atob(s),v=new Uint8Array(f.length);for(let u=0;u<f.length;u++)v[u]=f.charCodeAt(u);return v.buffer}catch(s){throw console.error("PEM parsing failed:",s),new Error("Invalid PEM format key")}if(t)try{const s=atob(i),f=new Uint8Array(s.length);for(let v=0;v<s.length;v++)f[v]=s.charCodeAt(v);return f.buffer}catch(s){throw console.error("Base64 parsing failed:",s),new Error("Invalid base64 encoded key")}else return new TextEncoder().encode(i).buffer},Ke=async(i,t,s,f,v,u,y)=>{const{format:b,isBase64:r,isPem:a,keyType:d}=Ne(t),l=[{isBase64:r,keyFormat:b},{isBase64:!1,keyFormat:y?"raw":"spki"},{isBase64:!0,keyFormat:y?"raw":"spki"}];y?l.push({isBase64:!1,keyFormat:"raw"},{isBase64:!0,keyFormat:"raw"}):s.startsWith("RS")||s.startsWith("PS")?l.push({isBase64:!1,keyFormat:"spki"},{isBase64:a,keyFormat:"spki"}):s.startsWith("ES")&&l.push({isBase64:!1,keyFormat:"spki"},{isBase64:a,keyFormat:"spki"});for(const o of l)try{const k=ce(t,o.isBase64),E=await window.crypto.subtle.importKey(o.keyFormat,k,f,!1,["verify"]),J=new TextEncoder().encode(v);if(await window.crypto.subtle.verify(f,E,u,J))return!0}catch(k){console.log(`Key format ${o.keyFormat} (base64: ${o.isBase64}) failed:`,k)}return!1},Te=async(i,t,s)=>{try{const{token:f}=we(i);i=f;const v=i.split(".");if(v.length!==3)throw new Error("Invalid JWT format");const[u,y,b]=v,r=`${u}.${y}`;let a=s;if(!a)try{const k=re(u);a=JSON.parse(k).alg}catch{throw new Error("Failed to parse JWT header")}if(a==="none")return!1;const d=Uint8Array.from(atob(b.replace(/-/g,"+").replace(/_/g,"/")),k=>k.charCodeAt(0));let l,o=!1;switch(a){case"HS256":l={name:"HMAC",hash:"SHA-256"},o=!0;break;case"HS384":l={name:"HMAC",hash:"SHA-384"},o=!0;break;case"HS512":l={name:"HMAC",hash:"SHA-512"},o=!0;break;case"RS256":l={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":l={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":l={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"PS256":l={name:"RSA-PSS",hash:"SHA-256"};break;case"PS384":l={name:"RSA-PSS",hash:"SHA-384"};break;case"PS512":l={name:"RSA-PSS",hash:"SHA-512"};break;case"ES256":l={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":l={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":l={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${a}`)}return await Ke(i,t,a,l,r,d,o)}catch(f){return console.error("JWT verification error:",f),!1}},ge=async(i,t,s)=>{try{const f={typ:"JWT",...i},v=f.alg;if(!v)throw new Error("Algorithm is required in header");const u=ee(JSON.stringify(f)),y=ee(JSON.stringify(t)),b=`${u}.${y}`;if(v==="none")return`${b}.`;let r,a=!1;switch(v){case"HS256":r={name:"HMAC",hash:"SHA-256"},a=!0;break;case"HS384":r={name:"HMAC",hash:"SHA-384"},a=!0;break;case"HS512":r={name:"HMAC",hash:"SHA-512"},a=!0;break;case"RS256":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"PS256":r={name:"RSA-PSS",hash:"SHA-256"};break;case"PS384":r={name:"RSA-PSS",hash:"SHA-384"};break;case"PS512":r={name:"RSA-PSS",hash:"SHA-512"};break;case"ES256":r={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":r={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":r={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${v}`)}const{format:d,isBase64:l,isPem:o}=Ne(s);let k;o?k=ce(s,!1):k=ce(s,l);const E=await window.crypto.subtle.importKey(d,k,r,!1,["sign"]),J=new TextEncoder().encode(b),w=await window.crypto.subtle.sign(r,E,J),A=new Uint8Array(w);let N="";for(let S=0;S<A.length;S++)N+=String.fromCharCode(A[S]);return N=ee(N),`${b}.${N}`}catch(f){throw console.error("JWT signing error:",f),f}},Ce=async i=>{const t=[];try{const s=await pe(i);if(!s.header)return t.push({id:"malformed-token",title:"Malformed Token",description:"The token could not be parsed correctly.",severity:"high"}),t;const f=s.header.alg;if(f?(f==="none"&&t.push({id:"alg-none",title:'Insecure "none" Algorithm',description:'The token uses the "none" algorithm which is insecure and vulnerable to signature bypass attacks.',severity:"high"}),f==="HS256"&&t.push({id:"weak-hs256",title:"Consider Stronger Algorithm",description:"While acceptable, HS256 offers lower security than HS384 or HS512. Consider using a stronger algorithm for sensitive applications.",severity:"info"})):t.push({id:"missing-alg",title:"Missing Algorithm",description:'The token header is missing the required "alg" field.',severity:"high"}),(!s.signature||s.signature.length===0)&&t.push({id:"missing-signature",title:"Missing Signature",description:"The token has no signature, making it unverifiable and insecure.",severity:"high"}),s.payload){if(!s.payload.exp)t.push({id:"no-exp",title:"No Expiration",description:"The token does not have an expiration time (exp claim) which is a security risk.",severity:"medium"});else{const v=Math.floor(Date.now()/1e3);s.payload.exp<v&&t.push({id:"token-expired",title:"Token Expired",description:`The token expired on ${new Date(s.payload.exp*1e3).toLocaleString()}.`,severity:"medium"})}if(s.payload.iat||t.push({id:"no-iat",title:"No Issuance Time",description:"The token does not have an issuance time (iat claim). This makes token revocation more difficult.",severity:"low"}),s.payload.aud||t.push({id:"no-aud",title:"No Audience",description:"The token does not specify an audience (aud claim). This could lead to token misuse across different services.",severity:"low"}),s.payload.iss||t.push({id:"no-iss",title:"No Issuer",description:"The token does not specify an issuer (iss claim). This could lead to confusion about token origin.",severity:"low"}),!s.payload.nbf)t.push({id:"no-nbf",title:'No "Not Before" Time',description:'The token does not specify a "not before" time (nbf claim). While not critical, this helps prevent token use before intended.',severity:"info"});else{const v=Math.floor(Date.now()/1e3);s.payload.nbf>v&&t.push({id:"not-valid-yet",title:"Token Not Valid Yet",description:`The token becomes valid on ${new Date(s.payload.nbf*1e3).toLocaleString()}.`,severity:"medium"})}s.payload.jti||t.push({id:"no-jti",title:"No JWT ID",description:"The token does not have a JWT ID (jti claim). This makes token revocation and tracking more difficult.",severity:"info"})}s.header.typ?s.header.typ!=="JWT"&&t.push({id:"unusual-typ",title:"Unusual Token Type",description:`The token specifies an unusual type: "${s.header.typ}" instead of the standard "JWT".`,severity:"info"}):t.push({id:"no-typ",title:"No Token Type",description:"The token does not specify a type (typ claim) in the header. This is recommended for interoperability.",severity:"info"}),s.header.kid||t.push({id:"no-kid",title:"No Key ID",description:"The token does not specify a key ID (kid header). This is recommended when multiple keys are used.",severity:"info"})}catch(s){t.push({id:"parse-error",title:"Token Parse Error",description:s instanceof Error?s.message:"Unknown error parsing token",severity:"high"})}return t},Ae=async i=>{const f={sub:"1234567890",name:"John Doe",iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+3600,data:Array(1024).fill("a").join("")},v={alg:i,typ:"JWT"},u=Array(32).fill(0).map(()=>Math.floor(Math.random()*256).toString(16).padStart(2,"0")).join(""),y=performance.now();for(let a=0;a<100;a++)try{await ge(v,{...f,nonce:a},u)}catch(d){return console.error(`Error benchmarking algorithm ${i}:`,d),0}const r=performance.now()-y;return Math.floor(100/(r/1e3))},Ee=ge,ze=Te,Ue=pe,Be=Ae,Le=Ce,me=Object.freeze(Object.defineProperty({__proto__:null,analyze:Le,analyzeToken:Ce,base64UrlDecode:re,base64UrlEncode:ee,bench:Be,benchmarkAlgorithm:Ae,decode:Ue,decodeSafely:pe,sign:Ee,signToken:ge,verify:ze,verifyToken:Te},Symbol.toStringTag,{value:"Module"})),Ge=()=>{const[i,t]=j.useState("header"),[s,f]=j.useState("HS256"),[v,u]=j.useState(""),[y,b]=j.useState("JWT"),[r,a]=j.useState([{name:"sub",value:"1234567890",type:"string"},{name:"name",value:"John Doe",type:"string"},{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}]),[d,l]=j.useState(""),[o,k]=j.useState(""),[E,R]=j.useState("string"),[J,w]=j.useState("your-256-bit-secret"),[A,N]=j.useState(""),[S,T]=j.useState(0),[n,c]=j.useState(!1),[h,H]=j.useState(null),[_,$]=j.useState(!1);j.useEffect(()=>{if(_){const x=setTimeout(()=>$(!1),2e3);return()=>clearTimeout(x)}},[_]),j.useEffect(()=>{z()},[s,v,y,r]);const z=async()=>{try{const x={alg:s,typ:y};v&&(x.kid=v);const I={};for(const B of r)try{switch(B.type){case"string":I[B.name]=B.value;break;case"number":I[B.name]=Number(B.value);break;case"boolean":I[B.name]=B.value.toLowerCase()==="true";break;case"json":I[B.name]=JSON.parse(B.value);break}}catch{I[B.name]=B.value}const P=ee(JSON.stringify(x)),m=ee(JSON.stringify(I)),O=`${P}.${m}.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`;N(O),T(new TextEncoder().encode(O).length)}catch(x){console.error("Error generating token preview:",x)}},V=()=>{!d||!d.trim()||(a([...r,{name:d.trim(),value:o,type:E}]),l(""),k(""))},L=x=>{const I=[...r];I.splice(x,1),a(I)},p=(x,I,P)=>{const m=[...r];m[x][I]=P,a(m)},D=async()=>{c(!0),H(null);try{const x={alg:s,typ:y};v&&(x.kid=v);const I={};for(const m of r)try{switch(m.type){case"string":I[m.name]=m.value;break;case"number":I[m.name]=Number(m.value);break;case"boolean":I[m.name]=m.value.toLowerCase()==="true";break;case"json":I[m.name]=JSON.parse(m.value);break}}catch{I[m.name]=m.value}const P=await Ee(x,I,J);N(P),T(new TextEncoder().encode(P).length)}catch(x){H(`Error signing token: ${x instanceof Error?x.message:String(x)}`)}c(!1)},g=()=>{navigator.clipboard.writeText(A),$(!0)},C=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Algorithm (alg)"}),e.jsxs("select",{value:s,onChange:x=>f(x.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[e.jsxs("optgroup",{label:"HMAC",children:[e.jsx("option",{value:"HS256",children:"HS256 (HMAC + SHA256)"}),e.jsx("option",{value:"HS384",children:"HS384 (HMAC + SHA384)"}),e.jsx("option",{value:"HS512",children:"HS512 (HMAC + SHA512)"})]}),e.jsxs("optgroup",{label:"RSA",children:[e.jsx("option",{value:"RS256",children:"RS256 (RSA + SHA256)"}),e.jsx("option",{value:"RS384",children:"RS384 (RSA + SHA384)"}),e.jsx("option",{value:"RS512",children:"RS512 (RSA + SHA512)"})]}),e.jsxs("optgroup",{label:"ECDSA",children:[e.jsx("option",{value:"ES256",children:"ES256 (ECDSA + SHA256)"}),e.jsx("option",{value:"ES384",children:"ES384 (ECDSA + SHA384)"}),e.jsx("option",{value:"ES512",children:"ES512 (ECDSA + SHA512)"})]}),e.jsx("optgroup",{label:"Unsafe",children:e.jsx("option",{value:"none",children:"none (Unsigned Token)"})})]}),s==="none"&&e.jsx("div",{className:"mt-2 text-red-600 dark:text-red-400 text-sm",children:'Warning: The "none" algorithm creates unsigned tokens which provide no security.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Token Type (typ)"}),e.jsx(Y,{value:y,onChange:x=>b(x.target.value),placeholder:"JWT"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:'Usually "JWT" for JSON Web Token'})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Key ID (kid)"}),e.jsx(Y,{value:v,onChange:x=>u(x.target.value),placeholder:"Optional Key ID"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Optional identifier for the key used to sign this token"})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("div",{}),e.jsx(W,{variant:"primary",onClick:()=>t("payload"),children:"Continue to Payload"})]})]}),M=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Current Claims"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Type"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Action"})]})}),e.jsx("tbody",{children:r.map((x,I)=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3",children:e.jsx(Y,{value:x.name,onChange:P=>p(I,"name",P.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3",children:e.jsxs("select",{value:x.type,onChange:P=>p(I,"type",P.target.value),className:"p-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(Y,{value:x.value,onChange:P=>p(I,"value",P.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsx(W,{variant:"light",size:"sm",onClick:()=>L(I),children:"Remove"})})]},I))})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Add Claim"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),e.jsx(Y,{value:d,onChange:x=>l(x.target.value),placeholder:"Claim name",size:"sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),e.jsxs("select",{value:E,onChange:x=>R(x.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Value"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{value:o,onChange:x=>k(x.target.value),placeholder:"Value",size:"sm",className:"flex-grow"}),e.jsx(W,{variant:"primary",size:"sm",className:"ml-2",onClick:V,children:"Add"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-1",children:"Common Claims"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(x=>x.name==="exp")||a([...r,{name:"exp",value:String(Math.floor(Date.now()/1e3)+3600),type:"number"}])},children:"Add exp (Expiry)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(x=>x.name==="iat")||a([...r,{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add iat (Issued At)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(x=>x.name==="nbf")||a([...r,{name:"nbf",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add nbf (Not Before)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(x=>x.name==="iss")||a([...r,{name:"iss",value:"https://example.com",type:"string"}])},children:"Add iss (Issuer)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(x=>x.name==="aud")||a([...r,{name:"aud",value:"client-id",type:"string"}])},children:"Add aud (Audience)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(x=>x.name==="jti")||a([...r,{name:"jti",value:crypto.randomUUID(),type:"string"}])},children:"Add jti (JWT ID)"})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx(W,{variant:"light",onClick:()=>t("header"),children:"Back to Header"}),e.jsx(W,{variant:"primary",onClick:()=>t("signature"),children:"Continue to Signature"})]})]}),G=()=>{let x="Secret Key",I="Enter the secret key for HMAC signing";return s.startsWith("RS")?(x="Private Key (PKCS#8)",I="Enter the PEM-formatted RSA private key"):s.startsWith("ES")?(x="Private Key (PKCS#8)",I="Enter the PEM-formatted EC private key"):s==="none"&&(x="No Key Required",I="The 'none' algorithm does not use a key"),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-blue-800 dark:text-blue-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"â„¹ï¸"}),"You're creating a token with algorithm ",e.jsx("strong",{children:s})," and ",r.length," claims.",s==="none"&&e.jsx("span",{className:"text-red-600 dark:text-red-400 ml-1",children:" (Unsigned Token - Not secure)"})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x}),e.jsx("textarea",{value:J,onChange:P=>w(P.target.value),placeholder:s==="none"?'No key needed for "none" algorithm':"Enter key here...",disabled:s==="none",className:"w-full font-mono h-32 p-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 dark:text-gray-200"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:I})]}),e.jsx("div",{className:"mt-4",children:e.jsx(W,{variant:"primary",className:"w-full",onClick:D,disabled:n||s!=="none"&&!J,children:n?"Signing...":"Sign Token"})}),h&&e.jsx("div",{className:"mt-4 bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-red-800 dark:text-red-300 text-sm",children:h})}),e.jsx("div",{className:"mt-6 flex justify-between",children:e.jsx(W,{variant:"light",onClick:()=>t("payload"),children:"Back to Payload"})})]})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWT Builder"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create and sign custom JSON Web Tokens with our step-by-step wizard."})]}),e.jsx(K,{className:"mb-6",children:e.jsxs(he,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(q,{id:"header-tab",isActive:i==="header",onClick:()=>t("header"),children:"1. Header"}),e.jsx(q,{id:"payload-tab",isActive:i==="payload",onClick:()=>t("payload"),children:"2. Payload"}),e.jsx(q,{id:"signature-tab",isActive:i==="signature",onClick:()=>t("signature"),children:"3. Signature"})]}),i==="header"&&C(),i==="payload"&&M(),i==="signature"&&G()]})}),e.jsxs(K,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Generated Token"}),e.jsxs(U,{color:"info",children:["Size: ",S," bytes"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto whitespace-nowrap",children:A||"Your token will appear here..."}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(W,{onClick:g,variant:"primary",disabled:!A,children:_?"Copied!":"Copy Token"})})]})]})]})})})},Ve=()=>{const{state:i,dispatch:t,decodeToken:s,verifySignature:f,analyzeToken:v}=ue(),{token:u,decoded:y,isVerified:b,error:r,securityIssues:a}=i,[d,l]=j.useState(""),[o,k]=j.useState("json"),[E,R]=j.useState(!1),[J,w]=j.useState(null);j.useState(!1);const[A,N]=j.useState(null);j.useEffect(()=>{if(E){const g=setTimeout(()=>{R(!1),w(null)},2e3);return()=>clearTimeout(g)}},[E]),j.useEffect(()=>{if(a.length>0&&y){const g=a.filter(x=>x.severity==="high").length,C=a.filter(x=>x.severity==="medium").length,M=a.filter(x=>x.severity==="low").length,G=Math.max(0,100-(g*25+C*10+M*5));N(G)}else N(null)},[a,y]);const S=g=>g>=90?"Excellent":g>=80?"Good":g>=60?"Moderate":g>=40?"Poor":"Critical",T=g=>g>=90?"bg-green-100 text-green-800":g>=80?"bg-green-50 text-green-600":g>=60?"bg-yellow-100 text-yellow-800":g>=40?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800",n=g=>{const C=g.target.value.trim();C!==u&&(s(C),C&&v(C))},c=()=>{const g="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNjE2MjM5MDIyLCJleHAiOjE5MTYyMzkwMjIsInJvbGUiOiJhZG1pbiJ9.8TT2jkQV3a9lQfNSJz7USP9vgKzlhWPMnDxCQfFgj3w";s(g),v(g)},h=()=>{t({type:"RESET"}),l(""),N(null)},H=(g,C="token")=>{navigator.clipboard.writeText(g),R(!0),w(C)},_=()=>{!y||!d||f(y.header.alg,d)},$=g=>{try{return new Date(g*1e3).toLocaleString()}catch{return"Invalid date"}},z=g=>Date.now()>g*1e3,V=g=>{switch(g){case"sub":return"Subject (user) identifier";case"iss":return"Issuer of the token";case"aud":return"Audience the token is intended for";case"exp":return"Expiration time (when token becomes invalid)";case"nbf":return"Not before time (when token starts being valid)";case"iat":return"Issued at time (when token was issued)";case"jti":return"JWT ID (unique identifier for this token)";case"name":return"User name";case"given_name":return"User first name";case"family_name":return"User last name";case"email":return"User email address";case"roles":return"User roles/permissions";case"scope":return"OAuth 2.0 scopes";case"sid":return"Session ID";case"auth_time":return"Time when authentication occurred";default:return"Custom claim"}},L=g=>{switch(g){case"high":return"âš ï¸";case"medium":return"âš ";case"low":return"â„¹ï¸";default:return"â„¹ï¸"}},p=g=>{switch(g){case"header":return"text-blue-600 dark:text-blue-400";case"payload":return"text-purple-600 dark:text-purple-400";case"signature":return"text-red-600 dark:text-red-400";default:return"text-gray-600"}},D=()=>{if(!a||a.length===0)return null;const g=a.filter(x=>x.severity==="high"),C=a.filter(x=>x.severity==="medium"),M=a.filter(x=>x.severity==="low"),G=a.filter(x=>x.severity==="info");return e.jsxs(K,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:["Security Analysis",A!==null&&e.jsxs("div",{className:"ml-auto flex items-center",children:[e.jsx("div",{className:"text-sm mr-2",children:"Security Score:"}),e.jsx("div",{className:`rounded-full w-10 h-10 flex items-center justify-center ${T(A)}`,children:A}),e.jsx("div",{className:"ml-2 text-sm font-medium",children:S(A)})]})]})}),e.jsxs("div",{className:"p-4",children:[g.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-red-600 dark:text-red-400 font-medium mb-2",children:"Critical Issues"}),g.map(x=>e.jsx(Z,{type:"error",className:"mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 mt-0.5",children:L(x.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:x.title}),e.jsx("div",{className:"text-sm",children:x.description})]})]})},x.id))]}),C.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-yellow-600 dark:text-yellow-400 font-medium mb-2",children:"Warning Issues"}),C.map(x=>e.jsx(Z,{type:"warning",className:"mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 mt-0.5",children:L(x.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:x.title}),e.jsx("div",{className:"text-sm",children:x.description})]})]})},x.id))]}),(M.length>0||G.length>0)&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-blue-600 dark:text-blue-400 font-medium mb-2",children:"Informational"}),[...M,...G].map(x=>e.jsx(Z,{type:"info",className:"mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 mt-0.5",children:L(x.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:x.title}),e.jsx("div",{className:"text-sm",children:x.description})]})]})},x.id))]})]})]})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWT Token Inspector"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Decode, verify, and analyze JSON Web Tokens with advanced security analysis."})]}),e.jsxs(K,{className:"mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"JWT Token"}),e.jsx(W,{onClick:c,size:"sm",variant:"light",children:"Generate Demo"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"All JWT processing happens locally in your browser. Your tokens are never sent to a server."]})}),e.jsx("textarea",{className:"w-full font-mono text-sm p-3 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 h-28 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:u,onChange:n,placeholder:"Paste your JWT token here...",spellCheck:"false"}),r&&e.jsx(Z,{type:"error",className:"mt-4",children:r}),y&&e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto break-all",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Header:"}),e.jsx("div",{className:`${p("header")} flex-1`,children:y.raw.header})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Payload:"}),e.jsx("div",{className:`${p("payload")} flex-1`,children:y.raw.payload})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Signature:"}),e.jsx("div",{className:`${p("signature")} flex-1`,children:y.raw.signature})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(W,{onClick:h,variant:"light",children:"Reset"})}),e.jsx(W,{onClick:()=>H(u),variant:"primary",children:E&&J==="token"?"Copied!":"Copy Token"})]})]})]}),D(),y&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(K,{children:e.jsxs(he,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(q,{id:"tab-json",isActive:o==="json",onClick:()=>k("json"),children:"JSON"}),e.jsx(q,{id:"tab-claims",isActive:o==="claims",onClick:()=>k("claims"),children:"Claims Table"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:p("header"),children:"HEADER"}),e.jsx(W,{onClick:()=>H(JSON.stringify(y.header,null,2),"header"),variant:"light",size:"xs",className:"ml-2",children:E&&J==="header"?"Copied!":"Copy"})]}),e.jsx(ae,{id:"panel-json-header",isActive:o==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(y.header,null,2)})})}),e.jsx(ae,{id:"panel-claims-header",isActive:o==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(y.header).map(([g,C])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:g}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(se,{content:g==="alg"?"Algorithm used to sign the token":g==="typ"?"Token type":g==="kid"?"Key identifier":`Header claim: ${g}`,children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:String(C)})})})]},g))})]})})}),e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:p("payload"),children:"PAYLOAD"}),e.jsx(W,{onClick:()=>H(JSON.stringify(y.payload,null,2),"payload"),variant:"light",size:"xs",className:"ml-2",children:E&&J==="payload"?"Copied!":"Copy"})]}),e.jsx(ae,{id:"panel-json-payload",isActive:o==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(y.payload,null,2)})})}),e.jsx(ae,{id:"panel-claims-payload",isActive:o==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(y.payload).map(([g,C])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:g}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(se,{content:V(g),children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:g==="exp"||g==="iat"||g==="nbf"?e.jsxs("div",{children:[e.jsx("div",{children:String(C)}),e.jsxs("div",{className:`text-xs mt-1 ${g==="exp"&&z(C)?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:[$(C),g==="exp"&&e.jsx("span",{className:"ml-2",children:z(C)?e.jsx(U,{color:"danger",size:"sm",children:"Expired"}):e.jsx(U,{color:"success",size:"sm",children:"Valid"})})]})]}):typeof C=="boolean"?e.jsx("span",{className:C?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:String(C)}):String(C)})})})]},g))})]})})})]})]})})}),e.jsxs("div",{children:[e.jsxs(K,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Signature Verification"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Verify the signature using your secret key. Algorithm: ",y.header.alg||"unknown"]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"secret-key",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secret/Public Key"}),e.jsx(Y,{id:"secret-key",value:d,onChange:g=>l(g.target.value),placeholder:"Enter secret key or paste public key...",className:"font-mono"})]}),e.jsx(W,{onClick:_,variant:"primary",className:"w-full mt-3",disabled:!d,children:"Verify Signature"}),b!==null&&e.jsx("div",{className:`mt-4 p-3 rounded-md ${b?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:b?"âœ…":"âŒ"}),e.jsx("span",{className:"font-medium",children:b?"Signature Verified":"Invalid Signature"})]})})]})]}),y.payload.exp&&e.jsxs(K,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Token Status"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:`p-3 rounded-md ${z(y.payload.exp)?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"}`,children:[e.jsx("div",{className:"font-medium",children:z(y.payload.exp)?"ðŸ•’ Expired":"âœ… Valid"}),e.jsx("div",{className:"text-sm mt-1",children:$(y.payload.exp)})]}),y.payload.iat&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issued at:"}),e.jsx("div",{className:"text-sm",children:$(y.payload.iat)})]}),y.payload.nbf&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Not valid before:"}),e.jsx("div",{className:"text-sm",children:$(y.payload.nbf)})]})]})]})]})]})}),e.jsx("div",{className:"mt-8",children:e.jsxs(K,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold",children:"JWT Security Best Practices"})}),e.jsx("div",{className:"p-4 text-sm",children:e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"âœ“"}),e.jsx("span",{children:"Use short-lived tokens with expiration times (exp claim)"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"âœ“"}),e.jsx("span",{children:"Prefer asymmetric algorithms (RS256, ES256) over symmetric ones (HS256) for public clients"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"âœ“"}),e.jsx("span",{children:"Include audience (aud) and issuer (iss) claims to prevent token misuse"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"âœ“"}),e.jsx("span",{children:"Use strong, unique keys for signing tokens"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"âœ—"}),e.jsx("span",{children:"Never store sensitive data like passwords or API keys in tokens"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"âœ—"}),e.jsx("span",{children:"Never use the 'none' algorithm in production"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"âœ—"}),e.jsx("span",{children:"Avoid very long-lived tokens (> 24 hours) for sensitive operations"})]})]})})]})})]})})})},Ze=()=>{var _,$,z,V,L;const{state:i}=ue(),{decoded:t}=i,[s,f]=j.useState(""),[v,u]=j.useState("jwks"),[y,b]=j.useState(!1),[r,a]=j.useState([]),[d,l]=j.useState(null),[o,k]=j.useState(null),[E,R]=j.useState(null),[J,w]=j.useState(!1),[A,N]=j.useState(null);j.useEffect(()=>{var p;if((p=t==null?void 0:t.payload)!=null&&p.iss&&!s){const D=t.payload.iss;D.endsWith("/")?f(`${D}.well-known/openid-configuration`):f(`${D}/.well-known/openid-configuration`),u("oidc")}},[t]),j.useEffect(()=>{if(J){const p=setTimeout(()=>{w(!1),N(null)},2e3);return()=>clearTimeout(p)}},[J]),j.useEffect(()=>{var p;if((p=t==null?void 0:t.header)!=null&&p.kid&&r.length>0){const D=t.header.kid,g=r.find(C=>C.kid===D);R(g||null)}else R(null)},[t,r]);const S=async()=>{if(s){b(!0),k(null),a([]),l(null);try{const p=await fetch(s);if(!p.ok)throw new Error(`HTTP error: ${p.status} ${p.statusText}`);const D=await p.json();try{sessionStorage.setItem(`jwks_${s}`,JSON.stringify(D))}catch(g){console.warn("Failed to cache JWKS in sessionStorage:",g)}if(D.keys)a(D.keys);else throw new Error("No keys found in the JWKS response")}catch(p){k(`Failed to fetch JWKS: ${p instanceof Error?p.message:String(p)}`)}finally{b(!1)}}},T=async()=>{if(s){b(!0),k(null),a([]),l(null);try{const p=await fetch(s);if(!p.ok)throw new Error(`HTTP error: ${p.status} ${p.statusText}`);const D=await p.json();l(D);try{sessionStorage.setItem(`oidc_${s}`,JSON.stringify(D))}catch(M){console.warn("Failed to cache OIDC config in sessionStorage:",M)}if(!D.jwks_uri)throw new Error("No JWKS URI found in the OIDC configuration");const g=await fetch(D.jwks_uri);if(!g.ok)throw new Error(`HTTP error fetching JWKS: ${g.status} ${g.statusText}`);const C=await g.json();try{sessionStorage.setItem(`jwks_${D.jwks_uri}`,JSON.stringify(C))}catch(M){console.warn("Failed to cache JWKS in sessionStorage:",M)}if(C.keys)a(C.keys);else throw new Error("No keys found in the JWKS response")}catch(p){k(`Failed to fetch OIDC configuration or JWKS: ${p instanceof Error?p.message:String(p)}`)}finally{b(!1)}}},n=()=>{v==="jwks"?S():T()},c=(p,D)=>{navigator.clipboard.writeText(p),w(!0),N(D)},h=()=>{f(v==="jwks"?"https://www.googleapis.com/oauth2/v3/certs":"https://accounts.google.com/.well-known/openid-configuration")},H=(p,D)=>{var M;const g=((M=t==null?void 0:t.header)==null?void 0:M.kid)&&p.kid===t.header.kid,C=JSON.stringify(p,null,2);return e.jsxs(K,{className:`mb-4 ${g?"border-green-500 dark:border-green-500":""}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("h4",{className:"font-semibold flex items-center",children:[g&&e.jsx("span",{className:"mr-2 text-green-500",children:"âœ“ "}),"Key ",p.kid?`ID: ${p.kid}`:D+1]}),e.jsxs("div",{className:"flex gap-2",children:[p.alg&&e.jsx(U,{color:"primary",children:p.alg}),e.jsx(U,{color:"info",children:p.kty}),p.use&&e.jsx(U,{color:"success",children:p.use})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",p.kty]}),p.alg&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Algorithm:"})," ",p.alg]}),p.use&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Use:"})," ",p.use]}),p.key_ops&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Operations:"})," ",p.key_ops.join(", ")]}),p.kty==="RSA"&&p.n&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Modulus (n):"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:p.n})]}),p.kty==="RSA"&&p.e&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Exponent (e):"})," ",p.e]}),p.kty==="EC"&&e.jsxs(e.Fragment,{children:[p.crv&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Curve:"})," ",p.crv]}),p.x&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"X:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:p.x})]}),p.y&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Y:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:p.y})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsx(W,{variant:"light",size:"sm",onClick:()=>c(C,`key_${D}`),children:J&&A===`key_${D}`?"Copied!":"Copy Key JSON"})})]})]},p.kid||D)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWKS Probe"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Discover and explore JSON Web Key Sets (JWKS) to verify JWT signatures."})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-md border border-blue-200 dark:border-blue-800 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-3 text-blue-600 dark:text-blue-400 text-lg",children:"â„¹ï¸"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"What is JWKS?"}),e.jsx("p",{className:"text-blue-800 dark:text-blue-200 text-sm",children:"A JSON Web Key Set is a JSON document that represents a set of public keys as a JSON object. JWKS endpoints are used to publish the public keys needed to verify JWT signatures. This tool helps you retrieve and inspect these keys."})]})]})}),e.jsxs(K,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"JWKS Endpoint Configuration"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"URL Type"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"jwks",checked:v==="jwks",onChange:()=>u("jwks"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"JWKS Endpoint"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"oidc",checked:v==="oidc",onChange:()=>u("oidc"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"OIDC Discovery"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"jwks-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:v==="jwks"?"JWKS URL":"OIDC Discovery URL"}),e.jsxs("div",{className:"flex",children:[e.jsx(Y,{id:"jwks-url",value:s,onChange:p=>f(p.target.value),placeholder:v==="jwks"?"https://example.com/.well-known/jwks.json":"https://example.com/.well-known/openid-configuration",className:"flex-grow"}),e.jsx(W,{onClick:h,variant:"light",className:"ml-2",children:"Sample"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:v==="jwks"?"Direct URL to a JWKS endpoint containing public keys":"URL to an OpenID Connect discovery document"}),((_=t==null?void 0:t.payload)==null?void 0:_.iss)&&e.jsxs("div",{className:"mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 text-sm rounded-md",children:["Token issuer detected: ",e.jsx("span",{className:"font-medium",children:t.payload.iss})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(W,{onClick:n,variant:"primary",disabled:!s||y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Je,{size:"sm",className:"mr-2"}),"Fetching..."]}):"Fetch Keys"})})]})]}),o&&e.jsx(Z,{type:"error",className:"mb-6",children:o}),d&&e.jsxs(K,{className:"mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"OIDC Configuration"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{const p=JSON.stringify(d,null,2);c(p,"oidc_config")},children:J&&A==="oidc_config"?"Copied!":"Copy Full Config"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.issuer&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Issuer:"})," ",d.issuer]}),d.jwks_uri&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"JWKS URI:"})," ",d.jwks_uri]}),d.token_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Token Endpoint:"})," ",d.token_endpoint]}),d.authorization_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Authorization Endpoint:"})," ",d.authorization_endpoint]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Available Scopes:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[($=d.scopes_supported)==null?void 0:$.slice(0,8).map(p=>e.jsx(U,{color:"info",children:p},p)),((z=d.scopes_supported)==null?void 0:z.length)>8&&e.jsxs(U,{color:"light",children:["+",d.scopes_supported.length-8," more"]})]})]})]})]}),r.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Keys Found (",r.length,")"]}),E&&((V=t==null?void 0:t.header)==null?void 0:V.kid)&&e.jsxs(U,{color:"success",children:["Found matching key for KID: ",t.header.kid]})]}),((L=t==null?void 0:t.header)==null?void 0:L.kid)&&!E&&r.length>0&&e.jsxs(Z,{type:"warning",className:"mb-4",children:[`No key matching the token's kid "`,t.header.kid,'" was found in the JWKS.']}),r.map((p,D)=>H(p,D))]}),r.length>0&&e.jsxs(K,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"JWKS Usage Guide"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"How to use a JWKS to verify a JWT:"}),e.jsxs("ol",{className:"list-decimal pl-5 space-y-2 text-sm",children:[e.jsx("li",{children:"Decode the JWT to extract the header and identify the key ID (kid)"}),e.jsx("li",{children:"Find the matching key in the JWKS with the same kid"}),e.jsx("li",{children:"Extract the public key components from the JWK (modulus, exponent for RSA)"}),e.jsx("li",{children:"Use the public key to verify the JWT signature with the algorithm specified in the header"})]}),e.jsx("h4",{className:"font-medium mt-4",children:"Security Best Practices:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2 text-sm",children:[e.jsx("li",{children:"Always validate the signature of JWTs using the public keys from the JWKS"}),e.jsx("li",{children:"Check that the key's intended use (if specified) matches your use case"}),e.jsx("li",{children:"Consider caching the JWKS to improve performance, but refresh regularly"}),e.jsx("li",{children:"Always use HTTPS when fetching JWKS endpoints"})]})]})})]})]})})},oe=["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512"],Ye={HS:"HMAC with SHA-2 - Symmetric key signatures using a shared secret",RS:"RSASSA-PKCS1-v1_5 - RSA signatures with PKCS#1 v1.5 padding",ES:"ECDSA - Elliptic Curve Digital Signature Algorithm",PS:"RSASSA-PSS - RSA signatures with Probabilistic Signature Scheme"},be=i=>i.startsWith("HS")?"bg-blue-500":i.startsWith("RS")?"bg-green-500":i.startsWith("ES")?"bg-purple-500":i.startsWith("PS")?"bg-orange-500":"bg-gray-500",ne=i=>i.toLocaleString(void 0,{maximumFractionDigits:2}),Xe=()=>{var S,T;const[i,t]=j.useState(!1),[s,f]=j.useState(null),[v,u]=j.useState(0),[y,b]=j.useState([]),[r,a]=j.useState(null),[d,l]=j.useState(!1),[o,k]=j.useState("performance"),E=j.useCallback(async n=>{try{const c=performance.now(),h=n.startsWith("ES")?50:100,_=await(await de(()=>Promise.resolve().then(()=>me),void 0)).bench(n),z=performance.now()-c;return{algorithm:n,operationsPerSecond:_,averageTime:h>0?z/h:0,totalOperations:h,color:be(n)}}catch(c){return console.error(`Error benchmarking ${n}:`,c),{algorithm:n,operationsPerSecond:0,averageTime:0,totalOperations:0,color:be(n)}}},[]),R=j.useCallback(async()=>{t(!0),b([]),a(null),u(0);try{const n=[];for(let h=0;h<oe.length;h++){const H=oe[h];f(H),await new Promise($=>setTimeout($,100));const _=await E(H);n.push(_),u((h+1)/oe.length*100)}const c=[...n].sort((h,H)=>H.operationsPerSecond-h.operationsPerSecond);b(c)}catch(n){a(n instanceof Error?n.message:"An error occurred during benchmarking")}finally{f(null),t(!1)}},[E]);j.useEffect(()=>{if(y.length>0){const n=[...y].sort((c,h)=>o==="algorithm"?c.algorithm.localeCompare(h.algorithm):h.operationsPerSecond-c.operationsPerSecond);b(n)}},[o]);const J=j.useCallback(()=>y.length===0?null:y.reduce((n,c)=>c.operationsPerSecond>n.operationsPerSecond?c:n),[y]),w=j.useCallback(()=>{const n={};return y.forEach(c=>{const h=c.algorithm.substring(0,2);n[h]||(n[h]=[]),n[h].push(c)}),n},[y]),A=j.useCallback(()=>{if(y.length===0)return null;const n=Math.max(...y.map(c=>c.operationsPerSecond));return e.jsx("div",{className:"mt-4",children:y.map((c,h)=>{const H=c.operationsPerSecond/n*100,_=c.operationsPerSecond===n;return e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium w-16",children:c.algorithm}),_&&e.jsx(U,{color:"success",className:"ml-2",children:"Fastest"})]}),e.jsxs("span",{className:"text-sm",children:[ne(c.operationsPerSecond)," op/s"]})]}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-md overflow-hidden",children:e.jsx("div",{className:`h-full ${c.color} transition-all duration-1000 ease-out`,style:{width:`${H}%`,animationDelay:`${h*.1}s`,opacity:i?.7:1}})}),d&&e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex justify-between",children:[e.jsxs("span",{children:["Avg: ",ne(c.averageTime)," ms/op"]}),e.jsxs("span",{children:["Total: ",c.totalOperations," operations"]})]})]},c.algorithm)})})},[y,i,d]),N=j.useCallback(()=>{const n=w();return e.jsx("div",{className:"mt-6 space-y-6",children:Object.entries(n).map(([c,h])=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-md",children:[e.jsxs("h4",{className:"font-medium mb-2",children:[c," Family"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:Ye[c]||"JWT signature algorithm family"}),e.jsx("div",{className:"space-y-3",children:h.map(H=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:H.algorithm}),e.jsxs("div",{className:"font-mono",children:[ne(H.operationsPerSecond)," op/s"]})]},H.algorithm))})]},c))})},[w]);return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWT Algorithm Performance"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Benchmark JWT signing algorithms in your browser to determine the best performance."})]}),e.jsxs(K,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Performance Benchmark"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âš¡"}),"This tool tests JWT algorithm performance in your browser. Results may vary based on device capabilities and browser implementation."]})}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(W,{onClick:R,variant:"primary",disabled:i,children:i?"Benchmarking...":"Run Benchmark"}),y.length>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"mr-2 text-sm",children:"Sort by:"}),e.jsxs("select",{value:o,onChange:n=>k(n.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm p-1",children:[e.jsx("option",{value:"performance",children:"Speed (fastest first)"}),e.jsx("option",{value:"algorithm",children:"Algorithm name"})]})]})]}),i&&s&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-sm",children:["Testing algorithm: ",e.jsx("strong",{children:s})]}),e.jsxs("span",{className:"text-sm",children:[Math.round(v),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300 ease-out",style:{width:`${v}%`}})})]}),r&&e.jsx(Z,{type:"error",className:"mb-4",children:r}),y.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2 flex justify-between items-center",children:[e.jsx("h4",{className:"font-medium",children:"Results"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"show-details",checked:d,onChange:()=>l(!d),className:"mr-2"}),e.jsx("label",{htmlFor:"show-details",className:"text-sm",children:"Show detailed metrics"})]})]}),A(),!i&&J()&&e.jsxs("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-md border border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"font-medium text-green-800 dark:text-green-300 mb-1",children:"Performance Summary"}),e.jsxs("p",{className:"text-green-800 dark:text-green-200 text-sm",children:[e.jsx("span",{className:"font-medium",children:(S=J())==null?void 0:S.algorithm})," is the fastest algorithm in your browser, performing ",ne(((T=J())==null?void 0:T.operationsPerSecond)||0)," operations per second."]})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Algorithm Family Comparison"}),N()]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"System:"}),e.jsx("span",{className:"ml-2 text-sm",children:navigator.userAgent})]}),e.jsx("div",{children:e.jsx(U,{color:"info",children:new Date().toLocaleString()})})]})})]}),!i&&y.length===0&&e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:'Click "Run Benchmark" to test JWT algorithm performance in your browser.'})]})]}),e.jsxs(K,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"About JWT Algorithms"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Symmetric Algorithms (HS*)"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"HMAC with SHA-2 algorithms use a shared secret key for both signing and verification. They are typically faster but require secure key distribution."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm space-y-1 text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"HS256: HMAC using SHA-256"}),e.jsx("li",{children:"HS384: HMAC using SHA-384"}),e.jsx("li",{children:"HS512: HMAC using SHA-512"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Asymmetric Algorithms (RS*, ES*, PS*)"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Asymmetric algorithms use a private key for signing and a public key for verification. They are typically slower but provide better security separation."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm space-y-1 text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"RS256: RSA Signature with SHA-256"}),e.jsx("li",{children:"ES256: ECDSA Signature with SHA-256"}),e.jsx("li",{children:"PS256: RSA-PSS Signature with SHA-256"})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Choosing the Right Algorithm"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"When selecting a JWT signing algorithm, consider these factors:"}),e.jsxs("ul",{className:"list-disc pl-5 text-sm space-y-2 text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Performance"}),": HMAC algorithms (HS*) are typically faster than RSA (RS*/PS*) and ECDSA (ES*)."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Security"}),": ES256 offers similar security to RS256 with smaller signatures and better performance."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Key Management"}),": Asymmetric algorithms allow public key distribution without exposing signing capabilities."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Standards Compliance"}),": Some standards require specific algorithms (e.g., OIDC prefers RS256)."]})]})]})]})]})]})},Qe=()=>e.jsx(_e,{children:e.jsxs(We,{children:[e.jsx(Q,{path:"/",element:e.jsx($e,{})}),e.jsx(Q,{path:"/build",element:e.jsx(Ge,{})}),e.jsx(Q,{path:"/inspect",element:e.jsx(Ve,{})}),e.jsx(Q,{path:"/jwks",element:e.jsx(Ze,{})}),e.jsx(Q,{path:"/benchmark",element:e.jsx(Xe,{})}),e.jsx(Q,{path:"*",element:e.jsx(De,{to:"/jwt",replace:!0})})]})}),qe={id:"jwt",title:"JWT Toolkit",description:"Comprehensive tool suite for JSON Web Tokens",route:"/jwt",icon:()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e.jsx("path",{d:"M12 0L1.604 6v12L12 24l10.396-6V6L12 0zm-1 20.5v-17l9 5.2v6.6l-9 5.2z"})}),component:j.lazy(()=>Promise.resolve({default:()=>e.jsx(e.Fragment,{})})),category:"Security",metadata:{keywords:["jwt","token","authentication","json web token"]},uiOptions:{fullWidth:!0}},ls=()=>{const i=Oe(),s=He().pathname.split("/jwt")[1]||"/",f=[{id:"/",label:"Decoder",title:"Decode & Verify JWT Tokens"},{id:"/inspect",label:"Inspector",title:"Deep Inspection & Security Analysis"},{id:"/build",label:"Builder",title:"Create & Sign JWT Tokens"},{id:"/jwks",label:"JWKS",title:"JWKS Tool & Public Key Discovery"},{id:"/benchmark",label:"Performance",title:"Algorithm Performance Benchmarks"}],v=b=>{i(`/jwt${b}`)},u="JWT Toolkit | MyDebugger",y="Complete JWT toolkit for developers: decode, create, inspect, verify and benchmark JSON Web Tokens with our comprehensive suite of JWT tools.";return e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsx("title",{children:u}),e.jsx("meta",{name:"description",content:y}),e.jsx("meta",{property:"og:title",content:u}),e.jsx("meta",{property:"og:description",content:y}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:u}),e.jsx("meta",{name:"twitter:description",content:y}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsx(Re,{tool:qe,children:e.jsxs(K,{className:"p-0 overflow-visible",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx(he,{activeTab:s,onChange:v,children:f.map(b=>e.jsx(q,{id:b.id,isActive:s===b.id,children:b.label},b.id))})}),e.jsx("div",{className:"p-5",children:e.jsx(Qe,{})})]})})]})};export{ls as default};
//# sourceMappingURL=JwtToolkit-0fe0f27f.js.map
