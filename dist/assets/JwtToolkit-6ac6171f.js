import{j as e,_ as ie,C as _,B as W,a as z,T as Z,L as Ee,b as Ie}from"./index-665078a7.js";import{R as q,r as v,b as Re,c as Y,N as Je,u as We,d as De}from"./react-e68835f7.js";import{H as fe}from"./vendor-975fbbe6.js";import{T as de,a as X,b as re}from"./TabGroup-d322985a.js";import{T as ee}from"./Tooltip-42a4e5e7.js";const V=({type:i="info",title:t,children:s,showIcon:f=!0,dismissible:j=!1,onDismiss:m,className:g="",containerClassName:b="",outlined:r=!1,id:a,action:d})=>{const[l,o]=q.useState(!0),[k,S]=q.useState(!1);if(!l)return null;const I=()=>{S(!0),setTimeout(()=>{o(!1),m&&m()},300)},E={info:{solid:"bg-blue-50 border-blue-300 text-blue-800 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300",outlined:"bg-transparent border-blue-500 text-blue-700 dark:text-blue-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})},success:{solid:"bg-green-50 border-green-300 text-green-800 dark:bg-green-900/30 dark:border-green-800 dark:text-green-300",outlined:"bg-transparent border-green-500 text-green-700 dark:text-green-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},warning:{solid:"bg-yellow-50 border-yellow-300 text-yellow-800 dark:bg-yellow-900/30 dark:border-yellow-800 dark:text-yellow-300",outlined:"bg-transparent border-yellow-500 text-yellow-700 dark:text-yellow-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})},error:{solid:"bg-red-50 border-red-300 text-red-800 dark:bg-red-900/30 dark:border-red-800 dark:text-red-300",outlined:"bg-transparent border-red-500 text-red-700 dark:text-red-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}},T=r?E[i].outlined:E[i].solid,C=k?"animate-fade-out motion-reduce:opacity-0 motion-reduce:transition-opacity":"animate-fade-in motion-reduce:animate-none";return e.jsx("div",{id:a,className:`${b}`,children:e.jsxs("div",{className:`flex p-4 mb-4 border-l-4 rounded-md ${T} ${C} transition-all duration-300 motion-reduce:transition-none ${g}`,role:"alert","aria-live":"polite",children:[e.jsxs("div",{className:"flex items-start",children:[f&&e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("div",{className:"transition-transform duration-200 ease-in-out motion-reduce:transform-none",children:E[i].icon})}),e.jsxs("div",{className:"flex-1",children:[t&&e.jsx("h3",{className:"text-sm font-medium mb-1",children:t}),e.jsx("div",{className:"text-sm",children:s}),d&&e.jsx("div",{className:"mt-3",children:d})]})]}),j&&e.jsxs("button",{type:"button",className:"ml-auto -mx-1.5 -my-1.5 rounded-lg p-1.5 inline-flex h-8 w-8 focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 motion-reduce:transition-none",onClick:I,"aria-label":"Close",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{"aria-hidden":"true",className:"w-5 h-5 transform transition-transform duration-200 hover:scale-110 motion-reduce:transform-none",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})};var ce={exports:{}};ce.exports;(function(i){var t=function(){var s=String.fromCharCode,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",m={};function g(r,a){if(!m[r]){m[r]={};for(var d=0;d<r.length;d++)m[r][r.charAt(d)]=d}return m[r][a]}var b={compressToBase64:function(r){if(r==null)return"";var a=b._compress(r,6,function(d){return f.charAt(d)});switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(r){return r==null?"":r==""?null:b._decompress(r.length,32,function(a){return g(f,r.charAt(a))})},compressToUTF16:function(r){return r==null?"":b._compress(r,15,function(a){return s(a+32)})+" "},decompressFromUTF16:function(r){return r==null?"":r==""?null:b._decompress(r.length,16384,function(a){return r.charCodeAt(a)-32})},compressToUint8Array:function(r){for(var a=b.compress(r),d=new Uint8Array(a.length*2),l=0,o=a.length;l<o;l++){var k=a.charCodeAt(l);d[l*2]=k>>>8,d[l*2+1]=k%256}return d},decompressFromUint8Array:function(r){if(r==null)return b.decompress(r);for(var a=new Array(r.length/2),d=0,l=a.length;d<l;d++)a[d]=r[d*2]*256+r[d*2+1];var o=[];return a.forEach(function(k){o.push(s(k))}),b.decompress(o.join(""))},compressToEncodedURIComponent:function(r){return r==null?"":b._compress(r,6,function(a){return j.charAt(a)})},decompressFromEncodedURIComponent:function(r){return r==null?"":r==""?null:(r=r.replace(/ /g,"+"),b._decompress(r.length,32,function(a){return g(j,r.charAt(a))}))},compress:function(r){return b._compress(r,16,function(a){return s(a)})},_compress:function(r,a,d){if(r==null)return"";var l,o,k={},S={},I="",E="",T="",C=2,w=3,N=2,A=[],n=0,c=0,x;for(x=0;x<r.length;x+=1)if(I=r.charAt(x),Object.prototype.hasOwnProperty.call(k,I)||(k[I]=w++,S[I]=!0),E=T+I,Object.prototype.hasOwnProperty.call(k,E))T=E;else{if(Object.prototype.hasOwnProperty.call(S,T)){if(T.charCodeAt(0)<256){for(l=0;l<N;l++)n=n<<1,c==a-1?(c=0,A.push(d(n)),n=0):c++;for(o=T.charCodeAt(0),l=0;l<8;l++)n=n<<1|o&1,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=o>>1}else{for(o=1,l=0;l<N;l++)n=n<<1|o,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=0;for(o=T.charCodeAt(0),l=0;l<16;l++)n=n<<1|o&1,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=o>>1}C--,C==0&&(C=Math.pow(2,N),N++),delete S[T]}else for(o=k[T],l=0;l<N;l++)n=n<<1|o&1,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=o>>1;C--,C==0&&(C=Math.pow(2,N),N++),k[E]=w++,T=String(I)}if(T!==""){if(Object.prototype.hasOwnProperty.call(S,T)){if(T.charCodeAt(0)<256){for(l=0;l<N;l++)n=n<<1,c==a-1?(c=0,A.push(d(n)),n=0):c++;for(o=T.charCodeAt(0),l=0;l<8;l++)n=n<<1|o&1,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=o>>1}else{for(o=1,l=0;l<N;l++)n=n<<1|o,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=0;for(o=T.charCodeAt(0),l=0;l<16;l++)n=n<<1|o&1,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=o>>1}C--,C==0&&(C=Math.pow(2,N),N++),delete S[T]}else for(o=k[T],l=0;l<N;l++)n=n<<1|o&1,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=o>>1;C--,C==0&&(C=Math.pow(2,N),N++)}for(o=2,l=0;l<N;l++)n=n<<1|o&1,c==a-1?(c=0,A.push(d(n)),n=0):c++,o=o>>1;for(;;)if(n=n<<1,c==a-1){A.push(d(n));break}else c++;return A.join("")},decompress:function(r){return r==null?"":r==""?null:b._decompress(r.length,32768,function(a){return r.charCodeAt(a)})},_decompress:function(r,a,d){var l=[],o=4,k=4,S=3,I="",E=[],T,C,w,N,A,n,c,x={val:d(0),position:a,index:1};for(T=0;T<3;T+=1)l[T]=T;for(w=0,A=Math.pow(2,2),n=1;n!=A;)N=x.val&x.position,x.position>>=1,x.position==0&&(x.position=a,x.val=d(x.index++)),w|=(N>0?1:0)*n,n<<=1;switch(w){case 0:for(w=0,A=Math.pow(2,8),n=1;n!=A;)N=x.val&x.position,x.position>>=1,x.position==0&&(x.position=a,x.val=d(x.index++)),w|=(N>0?1:0)*n,n<<=1;c=s(w);break;case 1:for(w=0,A=Math.pow(2,16),n=1;n!=A;)N=x.val&x.position,x.position>>=1,x.position==0&&(x.position=a,x.val=d(x.index++)),w|=(N>0?1:0)*n,n<<=1;c=s(w);break;case 2:return""}for(l[3]=c,C=c,E.push(c);;){if(x.index>r)return"";for(w=0,A=Math.pow(2,S),n=1;n!=A;)N=x.val&x.position,x.position>>=1,x.position==0&&(x.position=a,x.val=d(x.index++)),w|=(N>0?1:0)*n,n<<=1;switch(c=w){case 0:for(w=0,A=Math.pow(2,8),n=1;n!=A;)N=x.val&x.position,x.position>>=1,x.position==0&&(x.position=a,x.val=d(x.index++)),w|=(N>0?1:0)*n,n<<=1;l[k++]=s(w),c=k-1,o--;break;case 1:for(w=0,A=Math.pow(2,16),n=1;n!=A;)N=x.val&x.position,x.position>>=1,x.position==0&&(x.position=a,x.val=d(x.index++)),w|=(N>0?1:0)*n,n<<=1;l[k++]=s(w),c=k-1,o--;break;case 2:return E.join("")}if(o==0&&(o=Math.pow(2,S),S++),l[c])I=l[c];else if(c===k)I=C+C.charAt(0);else return null;E.push(I),l[k++]=C+I.charAt(0),o--,C=I,o==0&&(o=Math.pow(2,S),S++)}}};return b}();i!=null?i.exports=t:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return t})})(ce);var pe=ce.exports;const be={token:"",decoded:null,isVerified:null,verificationKey:"",error:null,history:[],securityIssues:[],parsingWarnings:[]};function Oe(i,t){switch(t.type){case"SET_TOKEN":return{...i,token:t.payload};case"SET_DECODED":return{...i,decoded:t.payload};case"SET_VERIFIED":return{...i,isVerified:t.payload};case"SET_VERIFICATION_KEY":return{...i,verificationKey:t.payload};case"SET_ERROR":return{...i,error:t.payload};case"ADD_HISTORY_ITEM":return{...i,history:[t.payload,...i.history.filter(s=>s.id!==t.payload.id)].slice(0,10)};case"CLEAR_HISTORY":return{...i,history:[]};case"REMOVE_HISTORY_ITEM":return{...i,history:i.history.filter(s=>s.id!==t.payload)};case"SET_SECURITY_ISSUES":return{...i,securityIssues:t.payload};case"SET_PARSING_WARNINGS":return{...i,parsingWarnings:t.payload};case"RESET":return be;default:return i}}const je=v.createContext(void 0),He=({children:i})=>{const[t,s]=v.useReducer(Oe,be);q.useEffect(()=>{b()},[]),q.useEffect(()=>{try{localStorage.setItem("jwt.history",JSON.stringify(t.history))}catch(r){console.error("Failed to save JWT history:",r)}},[t.history]),q.useEffect(()=>{try{const r=localStorage.getItem("jwt.history");r&&JSON.parse(r).forEach(d=>{s({type:"ADD_HISTORY_ITEM",payload:d})})}catch(r){console.error("Failed to load JWT history:",r)}},[]);const f=async r=>{var a,d;if(!r){s({type:"SET_DECODED",payload:null}),s({type:"SET_ERROR",payload:null}),s({type:"SET_VERIFIED",payload:null}),s({type:"SET_PARSING_WARNINGS",payload:[]});return}try{r=r.trim(),r.toLowerCase().startsWith("bearer ")&&(r=r.substring(7).trim());const o=await(await ie(()=>Promise.resolve().then(()=>oe),void 0)).decode(r),k=[];if(o.error&&k.push(o.error),o.header&&o.payload&&o.signature){const S={header:o.header,payload:o.payload,signature:o.signature,raw:o.raw};s({type:"SET_TOKEN",payload:r}),s({type:"SET_DECODED",payload:S}),s({type:"SET_ERROR",payload:null}),s({type:"SET_PARSING_WARNINGS",payload:k}),s({type:"SET_VERIFIED",payload:null});const I=((a=o.payload)==null?void 0:a.sub)||((d=o.payload)==null?void 0:d.name)||`Token ${new Date().toLocaleDateString()}`;s({type:"ADD_HISTORY_ITEM",payload:{id:Math.random().toString(36).substring(2,9),token:r,timestamp:Date.now(),label:I}}),m(r)}else throw new Error("Failed to decode JWT: Invalid token structure")}catch(l){s({type:"SET_ERROR",payload:l instanceof Error?l.message:"Failed to decode JWT"}),s({type:"SET_DECODED",payload:null}),s({type:"SET_VERIFIED",payload:null}),s({type:"SET_PARSING_WARNINGS",payload:[]})}},j=async(r,a)=>{var d,l;if(!t.token||!a){s({type:"SET_VERIFIED",payload:null});return}try{const k=await(await ie(()=>Promise.resolve().then(()=>oe),void 0)).verify(t.token,a,r||((l=(d=t.decoded)==null?void 0:d.header)==null?void 0:l.alg)||"HS256");s({type:"SET_VERIFICATION_KEY",payload:a}),s({type:"SET_VERIFIED",payload:k}),!k&&t.decoded&&r&&t.decoded.header.alg!==r?s({type:"SET_ERROR",payload:`Algorithm mismatch: Token uses ${t.decoded.header.alg} but ${r} was specified for verification`}):s(k?{type:"SET_ERROR",payload:null}:{type:"SET_ERROR",payload:"Signature verification failed"})}catch(o){s({type:"SET_ERROR",payload:o instanceof Error?o.message:"Failed to verify signature"}),s({type:"SET_VERIFIED",payload:!1})}},m=r=>{if(!t.decoded)return;const a=[];if(t.decoded.header.alg==="none"&&a.push({id:"alg-none",severity:"high",title:"UNSIGNED TOKEN",description:'The token uses algorithm "none" and has no signature. Do not accept in production.'}),t.decoded.payload.exp){const d=t.decoded.payload.exp*1e3;Date.now()>d&&a.push({id:"token-expired",severity:"medium",title:"Token Expired",description:`Token expired on ${new Date(d).toLocaleString()}.`});const l=24*60*60*1e3;d-Date.now()<l&&Date.now()<d&&a.push({id:"token-expiring",severity:"low",title:"Token Expiring Soon",description:`Token will expire on ${new Date(d).toLocaleString()}.`})}else a.push({id:"no-expiration",severity:"medium",title:"No Expiration Time",description:"This token has no expiration time (exp claim), which is not recommended."});if(t.decoded.header.alg&&(["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512"].includes(t.decoded.header.alg)?["HS256","RS256"].includes(t.decoded.header.alg)&&a.push({id:"weak-algorithm",severity:"info",title:"Consider Stronger Algorithm",description:`Algorithm ${t.decoded.header.alg} is widely used but consider stronger alternatives like ES256 or PS256 for better security.`}):a.push({id:"unsupported-algorithm",severity:"high",title:"Unsupported Algorithm",description:`Algorithm ${t.decoded.header.alg} is not among the standard supported JWT algorithms.`})),t.decoded.header.alg&&!t.decoded.header.alg.startsWith("HS")&&!t.decoded.header.kid&&a.push({id:"missing-kid",severity:"low",title:"Missing Key Identifier",description:'This token uses an asymmetric algorithm but has no "kid" (key ID) claim in the header.'}),t.decoded.payload.iat&&typeof t.decoded.payload.iat!="number"&&a.push({id:"invalid-iat",severity:"medium",title:"Invalid Issued At Claim",description:'The "iat" claim should be a numeric timestamp.'}),t.decoded.payload.nbf){const d=t.decoded.payload.nbf*1e3;d>Date.now()&&a.push({id:"future-nbf",severity:"medium",title:"Token Not Yet Valid",description:`This token is not valid until ${new Date(d).toLocaleString()}.`})}s({type:"SET_SECURITY_ISSUES",payload:a})},g=()=>{if(!t.token)return window.location.href.split("#")[0];const r=pe.compressToEncodedURIComponent(t.token);return`${window.location.href.split("#")[0]}#${r}`},b=async()=>{const r=window.location.hash.substring(1);if(r)try{const a=pe.decompressFromEncodedURIComponent(r);if(a)return await f(a),!0}catch(a){console.error("Failed to load token from URL hash:",a)}return!1};return e.jsx(je.Provider,{value:{state:t,dispatch:s,decodeToken:f,verifySignature:j,analyzeToken:m,shareToken:g,loadFromHash:b},children:i})},me=()=>{const i=v.useContext(je);if(i===void 0)throw new Error("useJwt must be used within a JwtProvider");return i},Pe=({children:i,as:t="p",size:s="md",weight:f="normal",align:j,color:m="default",truncate:g=!1,lineClamp:b,transform:r,italic:a=!1,underline:d=!1,lineThrough:l=!1,adaptiveLeading:o=!0,className:k=""})=>{const S={xs:"text-xs",sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl","3xl":"text-3xl","4xl":"text-4xl","5xl":"text-5xl","6xl":"text-6xl","7xl":"text-7xl","8xl":"text-8xl","9xl":"text-9xl"},I=()=>typeof s=="string"?S[s]:[s.base?S[s.base]:"text-base",s.sm?`sm:${S[s.sm]}`:"",s.md?`md:${S[s.md]}`:"",s.lg?`lg:${S[s.lg]}`:"",s.xl?`xl:${S[s.xl]}`:""].filter(Boolean).join(" "),E={thin:"font-thin",extralight:"font-extralight",light:"font-light",normal:"font-normal",medium:"font-medium",semibold:"font-semibold",bold:"font-bold",extrabold:"font-extrabold",black:"font-black"},T=j?{left:"text-left",center:"text-center",right:"text-right",justify:"text-justify"}[j]:"",C={default:"text-gray-800 dark:text-gray-200",primary:"text-blue-600 dark:text-blue-400",secondary:"text-gray-600 dark:text-gray-400",success:"text-green-600 dark:text-green-400",danger:"text-red-600 dark:text-red-400",warning:"text-yellow-600 dark:text-yellow-400",info:"text-cyan-600 dark:text-cyan-400",muted:"text-gray-500 dark:text-gray-500",white:"text-white",black:"text-black"},w=r?{uppercase:"uppercase",lowercase:"lowercase",capitalize:"capitalize",normal:"normal-case"}[r]:"",N=[a?"italic":"",d?"underline":"",l?"line-through":""].filter(Boolean).join(" "),A=()=>g===!0?"truncate":typeof g=="number"?`overflow-hidden text-ellipsis whitespace-nowrap max-w-[${g}ch]`:"",n=b?`line-clamp-${b}`:"",c=()=>{if(!o)return"";const O=typeof s=="string"?s:s.base||"md";return["xs","sm","md"].includes(O)?"leading-normal":["lg","xl","2xl"].includes(O)?"leading-relaxed":"leading-tight"},x=[I(),E[f],T,C[m],w,N,A(),n,c(),k].filter(Boolean).join(" ");return e.jsx(t,{className:x,children:i})},_e=()=>{var u,J,P;const{state:i,decodeToken:t,verifySignature:s,analyzeToken:f}=me(),{token:j,decoded:m,error:g,isVerified:b,verificationKey:r,securityIssues:a,parsingWarnings:d}=i,[l,o]=v.useState(""),[k,S]=v.useState(""),[I,E]=v.useState(!1),[T,C]=v.useState(null),[w,N]=v.useState("json"),[A,n]=v.useState(""),[c,x]=v.useState(!1);v.useEffect(()=>{o(j)},[j]),v.useEffect(()=>{S(r)},[r]),v.useEffect(()=>{const h=setTimeout(()=>{l!==j&&t(l)},300);return()=>clearTimeout(h)},[l,j,t]),v.useEffect(()=>{if(I){const h=setTimeout(()=>{E(!1),C(null)},2e3);return()=>clearTimeout(h)}},[I]),v.useEffect(()=>{if(m!=null&&m.header&&(m!=null&&m.payload)){const h=setTimeout(()=>{x(!0)},1e3);return()=>clearTimeout(h)}else x(!1)},[m]);const O=(h,H)=>{navigator.clipboard.writeText(h),E(!0),C(H)},$=()=>{o(""),S(""),n("")},F=()=>{var H,K,ae,ue;const h=[];if(m!=null&&m.header&&!b&&h.push(e.jsx("li",{children:"Try to verify the token signature with a secret or public key"},"verify")),(((H=m==null?void 0:m.header)==null?void 0:H.alg)==="none"||((K=m==null?void 0:m.header)==null?void 0:K.alg)==="HS256")&&h.push(e.jsx("li",{children:"Test for algorithm confusion attacks by changing the algorithm"},"alg")),(ae=m==null?void 0:m.payload)!=null&&ae.exp){const Ae=m.payload.exp;p(Ae)?h.push(e.jsx("li",{children:"Generate a new token with a future expiration time"},"exp")):h.push(e.jsx("li",{children:"Test token rejection by using an expired token"},"exp-test"))}return(ue=m==null?void 0:m.payload)!=null&&ue.jti||h.push(e.jsx("li",{children:"Add a JWT ID (jti) claim for better security"},"jti")),h.length===0&&h.push(e.jsx("li",{children:"Modify the payload to test how the application handles different claims"},"general-1"),e.jsx("li",{children:"Test token with different signature algorithms"},"general-2")),e.jsxs("div",{className:"text-sm",children:[e.jsx(Pe,{weight:"bold",className:"mb-1",children:"Next steps to try:"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:h})]})},B=()=>{const h=Math.floor(Date.now()/1e3);h+3600,crypto.randomUUID().replace(/-/g,""),h-300,o("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImV4YW1wbGUta2V5LWlkIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiZW1haWwiOiJqb2huLmRvZUBleGFtcGxlLmNvbSIsImlzcyI6Imh0dHBzOi8vYXV0aC5leGFtcGxlLmNvbSIsImF1ZCI6ImNsaWVudC1pZC0xMjMiLCJpYXQiOjE2ODMyMDM1MjQsImV4cCI6MTY4MzIwNzEyNCwibmJmIjoxNjgzMjAzNTI0LCJqdGkiOiI4OTg5OGVlOGQ1YjI0ZjdkYjkzM2MwZGFiZDQzMWJjOCIsImdpdmVuX25hbWUiOiJKb2huIiwiZmFtaWx5X25hbWUiOiJEb2UiLCJuaWNrbmFtZSI6IkpvaG5ueSIsInByZWZlcnJlZF91c2VybmFtZSI6ImpvaG4uZG9lIiwicGljdHVyZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vcHJvZmlsZS9qb2huZG9lLmpwZyIsIndlYnNpdGUiOiJodHRwczovL2pvaG5kb2UuZXhhbXBsZS5jb20iLCJnZW5kZXIiOiJtYWxlIiwiYmlydGhkYXRlIjoiMTk5MC0wMS0wMSIsInBob25lX251bWJlciI6IisxLTIwMi01NTUtMDEyMyIsImFkZHJlc3MiOnsic3RyZWV0X2FkZHJlc3MiOiIxMjMgTWFpbiBTdCIsImxvY2FsaXR5IjoiQW55dG93biIsInJlZ2lvbiI6IlN0YXRlIiwicG9zdGFsX2NvZGUiOiIxMjM0NSIsImNvdW50cnkiOiJVUyJ9LCJyb2xlcyI6WyJ1c2VyIiwiYWRtaW4iXSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImF1dGhfdGltZSI6MTY4MzIwMzIyNCwic2lkIjoic2Vzc2lvbl9pZF8xMjM0NTYiLCJhbXIiOlsicHdkIl0sImF6cCI6ImF1dGhvcml6ZWQtcGFydHktMTIzIn0.xlj7zV5XM7XQg6qNTDxXkpnyb9-4k9JSbzWl6YCGrX4")},G=()=>{s(A,k)},U=h=>{try{return new Date(h*1e3).toLocaleString()}catch{return"Invalid date"}},p=h=>Date.now()>h*1e3,D=h=>{switch(h){case"sub":return"Subject (user) identifier";case"iss":return"Issuer of the token";case"aud":return"Audience the token is intended for";case"exp":return"Expiration time (when token becomes invalid)";case"nbf":return"Not before time (when token starts being valid)";case"iat":return"Issued at time (when token was issued)";case"jti":return"JWT ID (unique identifier for this token)";case"name":return"User name";case"given_name":return"User first name";case"family_name":return"User last name";case"email":return"User email address";case"roles":return"User roles/permissions";case"scope":return"OAuth 2.0 scopes";case"sid":return"Session ID";case"auth_time":return"Time when authentication occurred";default:return"Custom claim"}},y=h=>{switch(h){case"header":return"text-blue-600 dark:text-blue-400";case"payload":return"text-purple-600 dark:text-purple-400";case"signature":return"text-red-600 dark:text-red-400";default:return"text-gray-600"}},R=h=>{switch(h){case"high":return"text-red-600 dark:text-red-400";case"medium":return"text-orange-600 dark:text-orange-400";case"low":return"text-yellow-600 dark:text-yellow-400";case"info":return"text-blue-600 dark:text-blue-400";default:return"text-gray-600 dark:text-gray-400"}},M="JWT Decoder | MyDebugger",L="Decode and verify JSON Web Tokens. Analyze headers, payload claims, and verify signatures securely in your browser.";return e.jsxs(e.Fragment,{children:[e.jsxs(fe,{children:[e.jsx("title",{children:M}),e.jsx("meta",{name:"description",content:L}),e.jsx("meta",{property:"og:title",content:M}),e.jsx("meta",{property:"og:description",content:L}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:M}),e.jsx("meta",{name:"twitter:description",content:L}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JSON Web Token (JWT) Debugger"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Decode, verify, and analyze JSON Web Tokens (JWT) instantly. All processing happens in your browser."})]}),e.jsx("div",{className:"mb-6 bg-yellow-50 dark:bg-yellow-900/20 p-4 border border-yellow-200 dark:border-yellow-800 rounded-md",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 flex items-center justify-center",children:[e.jsx("span",{className:"mr-2",children:"🔒"}),e.jsx("span",{className:"font-bold",children:"For your protection:"})," All JWT debugging and validation happens entirely in your browser. Your tokens and keys are never sent to any server."]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs(_,{isElevated:!0,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Encoded JWT"}),e.jsx(W,{onClick:B,variant:"light",size:"sm",children:"Generate example"})]}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[e.jsx("textarea",{id:"jwt-input",className:"w-full font-mono text-sm rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 flex-1 min-h-[300px]",value:l,onChange:h=>o(h.target.value),placeholder:"Paste your JWT token here... (supports Bearer tokens and plain JWT)",autoFocus:!0,spellCheck:"false"}),c&&m&&e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(ee,{content:F(),position:"bottom",size:"lg",children:e.jsx(z,{variant:"warning",className:"cursor-help flex items-center",children:e.jsx("span",{children:"👉 Continue to iterate?"})})})}),g&&e.jsx(V,{type:"error",className:"mt-4",children:g}),d&&d.length>0&&e.jsxs(V,{type:"warning",className:"mt-4",children:[e.jsx("div",{className:"font-medium mb-1",children:"Parsing Warnings:"}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:d.map((h,H)=>e.jsx("li",{children:h},H))})]}),m&&e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto break-all",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Header:"}),e.jsx("div",{className:`${y("header")} flex-1`,children:m.raw.header})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Payload:"}),e.jsx("div",{className:`${y("payload")} flex-1`,children:m.raw.payload})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Signature:"}),e.jsx("div",{className:`${y("signature")} flex-1`,children:m.raw.signature})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(W,{onClick:$,variant:"light",children:"Reset"})}),e.jsx("div",{children:e.jsx(W,{onClick:()=>O(l,"token"),variant:"primary",disabled:!l,children:I&&T==="token"?"Copied!":"Copy Token"})})]})]})]})}),e.jsx("div",{children:e.jsxs(_,{isElevated:!0,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Decoded Data"}),e.jsxs("div",{className:"flex border border-gray-200 dark:border-gray-700 rounded",children:[e.jsx("button",{className:`px-3 py-1 text-sm rounded-l ${w==="json"?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,onClick:()=>N("json"),children:"JSON"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded-r ${w==="table"?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,onClick:()=>N("table"),children:"Table"})]})]}),e.jsx("div",{className:"p-4 flex-1 flex flex-col overflow-y-auto",children:m?e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:y("header"),children:"HEADER"}),e.jsx(W,{onClick:()=>O(JSON.stringify(m.header,null,2),"header"),variant:"light",size:"xs",className:"ml-2",children:I&&T==="header"?"Copied!":"Copy"})]}),w==="json"?e.jsx("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4 text-sm",children:JSON.stringify(m.header,null,2)}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(m.header).map(([h,H])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:h}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(ee,{content:h==="alg"?"Algorithm used to sign the token":h==="typ"?"Token type":`Header claim: ${h}`,children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:String(H)})})})]},h))})]})}),e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:y("payload"),children:"PAYLOAD"}),e.jsx(W,{onClick:()=>O(JSON.stringify(m.payload,null,2),"payload"),variant:"light",size:"xs",className:"ml-2",children:I&&T==="payload"?"Copied!":"Copy"})]}),w==="json"?e.jsx("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto text-sm",children:JSON.stringify(m.payload,null,2)}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(m.payload).map(([h,H])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:h}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(ee,{content:D(h),children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:h==="exp"||h==="iat"||h==="nbf"?e.jsxs("div",{children:[e.jsx("div",{children:String(H)}),e.jsxs("div",{className:`text-xs mt-1 ${h==="exp"&&p(H)?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:[U(H),h==="exp"&&e.jsx("span",{className:"ml-2",children:p(H)?e.jsx(z,{color:"danger",size:"sm",children:"Expired"}):e.jsx(z,{color:"success",size:"sm",children:"Valid"})})]})]}):typeof H=="boolean"?e.jsx("span",{className:H?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:String(H)}):typeof H=="object"&&H!==null?e.jsxs("details",{children:[e.jsx("summary",{className:"cursor-pointer",children:"View Object"}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-100 dark:bg-gray-900 rounded text-xs overflow-auto max-h-40",children:JSON.stringify(H,null,2)})]}):String(H)})})})]},h))})]})})]}),c&&e.jsx("div",{className:"relative ml-4",children:e.jsx(W,{variant:"outline-info",onClick:()=>x(!1),size:"sm",className:"animate-pulse",children:"Next steps"})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:y("signature"),children:"SIGNATURE"}),e.jsx(z,{color:b===!0?"success":b===!1?"danger":"light",className:"ml-2",children:b===!0?"Verified":b===!1?"Invalid":"Not verified"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md text-sm",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:["Signature algorithm: ",e.jsx("span",{className:"font-medium",children:m.header.alg||"HS256"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex-grow mb-2",children:[e.jsx("label",{htmlFor:"algorithm-select",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Algorithm (optional, override header)"}),e.jsxs("select",{id:"algorithm-select",className:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:A,onChange:h=>n(h.target.value),children:[e.jsx("option",{value:"",children:"Use algorithm from header"}),e.jsxs("optgroup",{label:"HMAC",children:[e.jsx("option",{value:"HS256",children:"HS256"}),e.jsx("option",{value:"HS384",children:"HS384"}),e.jsx("option",{value:"HS512",children:"HS512"})]}),e.jsxs("optgroup",{label:"RSA",children:[e.jsx("option",{value:"RS256",children:"RS256"}),e.jsx("option",{value:"RS384",children:"RS384"}),e.jsx("option",{value:"RS512",children:"RS512"})]}),e.jsxs("optgroup",{label:"RSA-PSS",children:[e.jsx("option",{value:"PS256",children:"PS256"}),e.jsx("option",{value:"PS384",children:"PS384"}),e.jsx("option",{value:"PS512",children:"PS512"})]}),e.jsxs("optgroup",{label:"ECDSA",children:[e.jsx("option",{value:"ES256",children:"ES256"}),e.jsx("option",{value:"ES384",children:"ES384"}),e.jsx("option",{value:"ES512",children:"ES512"})]})]})]}),e.jsxs("div",{className:"flex-grow mb-2",children:[e.jsx("label",{htmlFor:"secret-key",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Secret/Verification key"}),e.jsx("textarea",{id:"secret-key",rows:3,className:"w-full font-mono text-xs rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:k,onChange:h=>S(h.target.value),placeholder:(u=m.header.alg)!=null&&u.startsWith("HS")?"Enter your secret key... (raw string or base64 encoded)":(J=m.header.alg)!=null&&J.startsWith("RS")||(P=m.header.alg)!=null&&P.startsWith("PS")?"Enter your RSA public key (PEM format supported)":"Enter your verification key..."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(W,{onClick:G,variant:"primary",size:"sm",disabled:!k,children:"Verify"})})]}),b!==null&&e.jsx("div",{className:`mt-3 p-2 rounded-md text-sm ${b?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:b?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:b?"Signature verified successfully":"Invalid signature"})]})})]})]}),a&&a.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{children:"SECURITY ANALYSIS"}),e.jsxs(z,{color:a.some(h=>h.severity==="high")?"danger":a.some(h=>h.severity==="medium")?"warning":"info",className:"ml-2",children:[a.length," Issue",a.length!==1?"s":""]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md text-sm",children:a.map(h=>e.jsxs("div",{className:"p-3 border-b last:border-b-0 border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("h4",{className:`font-medium ${R(h.severity)}`,children:h.title}),e.jsx(z,{color:h.severity==="high"?"danger":h.severity==="medium"?"warning":(h.severity==="low","info"),size:"sm",children:h.severity})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:h.description})]},h.id))})]}),c&&e.jsx("div",{className:"relative ml-4",children:e.jsx(W,{variant:"outline-info",onClick:()=>x(!1),size:"sm",className:"animate-pulse",children:"Next steps"})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400 text-center p-6",children:e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"Paste a JWT token on the left to decode it"}),e.jsx("div",{className:"text-sm",children:e.jsx(W,{onClick:B,variant:"light",size:"sm",children:"Or try an example token"})})]})})})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(_,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold",children:"About JWT"})}),e.jsxs("div",{className:"p-4 text-sm",children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:"JSON Web Tokens (JWTs) are an open, industry standard RFC 7519 method for representing claims securely between two parties."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${y("header")}`,children:"Header"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains metadata about the token's type and the signing algorithm."})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${y("payload")}`,children:"Payload"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains the token claims - statements about the user and additional metadata."})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${y("signature")}`,children:"Signature"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Used to verify that the token wasn't changed along the way and came from an authentic source."})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-3",children:e.jsxs("a",{href:"https://jwt.io/introduction",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 inline-flex items-center",children:["Learn more about JWT",e.jsx("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})]})})]})})]})},Q=i=>btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),se=i=>{switch(i=i.replace(/-/g,"+").replace(/_/g,"/"),i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("Invalid base64url string")}try{return decodeURIComponent(escape(atob(i)))}catch{try{return atob(i)}catch{throw new Error("Invalid base64 content")}}},ve=i=>/^-----BEGIN ([A-Z\s]+)-----/.test(i)&&/-----END ([A-Z\s]+)-----$/.test(i),Me=i=>{const t=i.match(/^-----BEGIN [^-]+-----\s*([A-Za-z0-9+\/=\s]+)-----END [^-]+-----$/s);if(!t||!t[1])throw new Error("Invalid PEM format");return t[1].replace(/[\n\r\s]/g,"")},ke=i=>{if(ve(i)){const s=i.includes("PRIVATE KEY");i.includes("PUBLIC KEY");const f=i.includes("RSA"),j=i.includes("EC")||i.includes("ECDSA");return{format:s?"pkcs8":"spki",isBase64:!1,isPem:!0,keyType:f?"RSA":j?"EC":"unknown"}}return{format:"raw",isBase64:/^[A-Za-z0-9+/=]+$/.test(i.trim()),isPem:!1,keyType:i.length>100?"RSA":"HMAC"}},Se=i=>{const t=[];let s=i;return i!==i.trim()&&t.push("Token contains extra whitespace that was removed"),s=s.trim(),s.toLowerCase().startsWith("bearer ")&&(s=s.substring(7).trim(),t.push("Bearer prefix was removed from token")),s.includes("\\n")&&(s=s.replace(/\\n/g,""),t.push("Escaped newlines were removed from token")),s.includes(`
`)&&(s=s.replace(/\n/g,""),t.push("Newlines were removed from token")),{token:s,warnings:t}},he=async i=>{try{const{token:t,warnings:s}=Se(i);if(i=t,!i)return{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:"Empty token",parsingWarnings:s};const f=i.split(".");if(f.length!==3)return s.push(`Token has ${f.length} parts instead of the expected 3 parts`),{header:f.length>0?ge(f[0]):null,payload:f.length>1?ge(f[1]):null,signature:f.length>2?f[2]:null,isValid:!1,raw:{header:f.length>0?f[0]:"",payload:f.length>1?f[1]:"",signature:f.length>2?f[2]:""},error:"Invalid JWT format: expected 3 parts",parsingWarnings:s};const[j,m,g]=f;let b=null,r=null,a;try{const d=se(j);b=JSON.parse(d),b&&!b.alg&&s.push('Token header is missing the "alg" field'),b&&!b.typ&&s.indexOf('Token header is missing the "typ" field')===-1&&s.push('Token header is missing the "typ" field')}catch{s.push("Failed to decode header as JSON"),a="Invalid JWT header: failed to parse"}try{const d=se(m);if(r=JSON.parse(d),r){if(typeof r.exp<"u"){const l=new Date(r.exp*1e3),o=new Date;l<o&&s.push(`Token is expired (exp: ${l.toISOString()}, now: ${o.toISOString()})`)}else s.push('Token payload is missing the "exp" field');if(typeof r.nbf<"u"){const l=new Date(r.nbf*1e3),o=new Date;l>o&&s.push(`Token is not yet valid (nbf: ${l.toISOString()}, now: ${o.toISOString()})`)}typeof r.iat>"u"&&s.push('Token payload is missing the "iat" field')}}catch{s.push("Failed to decode payload as JSON"),a=a||"Invalid JWT payload: failed to parse"}return{header:b,payload:r,signature:g,isValid:!1,raw:{header:j,payload:m,signature:g},error:a,parsingWarnings:s.length>0?s:void 0}}catch(t){return{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:t instanceof Error?t.message:"Unknown error decoding token"}}};function ge(i){try{const t=se(i);return JSON.parse(t)}catch{return null}}const le=(i,t=!1)=>{if(ve(i))try{const s=Me(i),f=atob(s),j=new Uint8Array(f.length);for(let m=0;m<f.length;m++)j[m]=f.charCodeAt(m);return j.buffer}catch(s){throw console.error("PEM parsing failed:",s),new Error("Invalid PEM format key")}if(t)try{const s=atob(i),f=new Uint8Array(s.length);for(let j=0;j<s.length;j++)f[j]=s.charCodeAt(j);return f.buffer}catch(s){throw console.error("Base64 parsing failed:",s),new Error("Invalid base64 encoded key")}else return new TextEncoder().encode(i).buffer},ze=async(i,t,s,f,j,m,g)=>{const{format:b,isBase64:r,isPem:a,keyType:d}=ke(t),l=[{isBase64:r,keyFormat:b},{isBase64:!1,keyFormat:g?"raw":"spki"},{isBase64:!0,keyFormat:g?"raw":"spki"}];g?l.push({isBase64:!1,keyFormat:"raw"},{isBase64:!0,keyFormat:"raw"}):s.startsWith("RS")||s.startsWith("PS")?l.push({isBase64:!1,keyFormat:"spki"},{isBase64:a,keyFormat:"spki"}):s.startsWith("ES")&&l.push({isBase64:!1,keyFormat:"spki"},{isBase64:a,keyFormat:"spki"});for(const o of l)try{const k=le(t,o.isBase64),S=await window.crypto.subtle.importKey(o.keyFormat,k,f,!1,["verify"]),E=new TextEncoder().encode(j);if(await window.crypto.subtle.verify(f,S,m,E))return!0}catch(k){console.log(`Key format ${o.keyFormat} (base64: ${o.isBase64}) failed:`,k)}return!1},Ne=async(i,t,s)=>{try{const{token:f}=Se(i);i=f;const j=i.split(".");if(j.length!==3)throw new Error("Invalid JWT format");const[m,g,b]=j,r=`${m}.${g}`;let a=s;if(!a)try{const k=se(m);a=JSON.parse(k).alg}catch{throw new Error("Failed to parse JWT header")}if(a==="none")return!1;const d=Uint8Array.from(atob(b.replace(/-/g,"+").replace(/_/g,"/")),k=>k.charCodeAt(0));let l,o=!1;switch(a){case"HS256":l={name:"HMAC",hash:"SHA-256"},o=!0;break;case"HS384":l={name:"HMAC",hash:"SHA-384"},o=!0;break;case"HS512":l={name:"HMAC",hash:"SHA-512"},o=!0;break;case"RS256":l={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":l={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":l={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"PS256":l={name:"RSA-PSS",hash:"SHA-256"};break;case"PS384":l={name:"RSA-PSS",hash:"SHA-384"};break;case"PS512":l={name:"RSA-PSS",hash:"SHA-512"};break;case"ES256":l={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":l={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":l={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${a}`)}return await ze(i,t,a,l,r,d,o)}catch(f){return console.error("JWT verification error:",f),!1}},xe=async(i,t,s)=>{try{const f={typ:"JWT",...i},j=f.alg;if(!j)throw new Error("Algorithm is required in header");const m=Q(JSON.stringify(f)),g=Q(JSON.stringify(t)),b=`${m}.${g}`;if(j==="none")return`${b}.`;let r,a=!1;switch(j){case"HS256":r={name:"HMAC",hash:"SHA-256"},a=!0;break;case"HS384":r={name:"HMAC",hash:"SHA-384"},a=!0;break;case"HS512":r={name:"HMAC",hash:"SHA-512"},a=!0;break;case"RS256":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"PS256":r={name:"RSA-PSS",hash:"SHA-256"};break;case"PS384":r={name:"RSA-PSS",hash:"SHA-384"};break;case"PS512":r={name:"RSA-PSS",hash:"SHA-512"};break;case"ES256":r={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":r={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":r={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${j}`)}const{format:d,isBase64:l,isPem:o}=ke(s);let k;o?k=le(s,!1):k=le(s,l);const S=await window.crypto.subtle.importKey(d,k,r,!1,["sign"]),E=new TextEncoder().encode(b),T=await window.crypto.subtle.sign(r,S,E),C=new Uint8Array(T);let w="";for(let N=0;N<C.length;N++)w+=String.fromCharCode(C[N]);return w=Q(w),`${b}.${w}`}catch(f){throw console.error("JWT signing error:",f),f}},we=async i=>{const t=[];try{const s=await he(i);if(!s.header)return t.push({id:"malformed-token",title:"Malformed Token",description:"The token could not be parsed correctly.",severity:"high"}),t;const f=s.header.alg;if(f?(f==="none"&&t.push({id:"alg-none",title:'Insecure "none" Algorithm',description:'The token uses the "none" algorithm which is insecure and vulnerable to signature bypass attacks.',severity:"high"}),f==="HS256"&&t.push({id:"weak-hs256",title:"Consider Stronger Algorithm",description:"While acceptable, HS256 offers lower security than HS384 or HS512. Consider using a stronger algorithm for sensitive applications.",severity:"info"})):t.push({id:"missing-alg",title:"Missing Algorithm",description:'The token header is missing the required "alg" field.',severity:"high"}),(!s.signature||s.signature.length===0)&&t.push({id:"missing-signature",title:"Missing Signature",description:"The token has no signature, making it unverifiable and insecure.",severity:"high"}),s.payload){if(!s.payload.exp)t.push({id:"no-exp",title:"No Expiration",description:"The token does not have an expiration time (exp claim) which is a security risk.",severity:"medium"});else{const j=Math.floor(Date.now()/1e3);s.payload.exp<j&&t.push({id:"token-expired",title:"Token Expired",description:`The token expired on ${new Date(s.payload.exp*1e3).toLocaleString()}.`,severity:"medium"})}if(s.payload.iat||t.push({id:"no-iat",title:"No Issuance Time",description:"The token does not have an issuance time (iat claim). This makes token revocation more difficult.",severity:"low"}),s.payload.aud||t.push({id:"no-aud",title:"No Audience",description:"The token does not specify an audience (aud claim). This could lead to token misuse across different services.",severity:"low"}),s.payload.iss||t.push({id:"no-iss",title:"No Issuer",description:"The token does not specify an issuer (iss claim). This could lead to confusion about token origin.",severity:"low"}),!s.payload.nbf)t.push({id:"no-nbf",title:'No "Not Before" Time',description:'The token does not specify a "not before" time (nbf claim). While not critical, this helps prevent token use before intended.',severity:"info"});else{const j=Math.floor(Date.now()/1e3);s.payload.nbf>j&&t.push({id:"not-valid-yet",title:"Token Not Valid Yet",description:`The token becomes valid on ${new Date(s.payload.nbf*1e3).toLocaleString()}.`,severity:"medium"})}s.payload.jti||t.push({id:"no-jti",title:"No JWT ID",description:"The token does not have a JWT ID (jti claim). This makes token revocation and tracking more difficult.",severity:"info"})}s.header.typ?s.header.typ!=="JWT"&&t.push({id:"unusual-typ",title:"Unusual Token Type",description:`The token specifies an unusual type: "${s.header.typ}" instead of the standard "JWT".`,severity:"info"}):t.push({id:"no-typ",title:"No Token Type",description:"The token does not specify a type (typ claim) in the header. This is recommended for interoperability.",severity:"info"}),s.header.kid||t.push({id:"no-kid",title:"No Key ID",description:"The token does not specify a key ID (kid header). This is recommended when multiple keys are used.",severity:"info"})}catch(s){t.push({id:"parse-error",title:"Token Parse Error",description:s instanceof Error?s.message:"Unknown error parsing token",severity:"high"})}return t},Te=async i=>{const f={sub:"1234567890",name:"John Doe",iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+3600,data:Array(1024).fill("a").join("")},j={alg:i,typ:"JWT"},m=Array(32).fill(0).map(()=>Math.floor(Math.random()*256).toString(16).padStart(2,"0")).join(""),g=performance.now();for(let a=0;a<100;a++)try{await xe(j,{...f,nonce:a},m)}catch(d){return console.error(`Error benchmarking algorithm ${i}:`,d),0}const r=performance.now()-g;return Math.floor(100/(r/1e3))},Ce=xe,$e=Ne,Fe=he,Be=Te,Ke=we,oe=Object.freeze(Object.defineProperty({__proto__:null,analyze:Ke,analyzeToken:we,base64UrlDecode:se,base64UrlEncode:Q,bench:Be,benchmarkAlgorithm:Te,decode:Fe,decodeSafely:he,sign:Ce,signToken:xe,verify:$e,verifyToken:Ne},Symbol.toStringTag,{value:"Module"})),Ue=()=>{const[i,t]=v.useState("header"),[s,f]=v.useState("HS256"),[j,m]=v.useState(""),[g,b]=v.useState("JWT"),[r,a]=v.useState([{name:"sub",value:"1234567890",type:"string"},{name:"name",value:"John Doe",type:"string"},{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}]),[d,l]=v.useState(""),[o,k]=v.useState(""),[S,I]=v.useState("string"),[E,T]=v.useState("your-256-bit-secret"),[C,w]=v.useState(""),[N,A]=v.useState(0),[n,c]=v.useState(!1),[x,O]=v.useState(null),[$,F]=v.useState(!1);v.useEffect(()=>{if($){const u=setTimeout(()=>F(!1),2e3);return()=>clearTimeout(u)}},[$]),v.useEffect(()=>{B()},[s,j,g,r]);const B=async()=>{try{const u={alg:s,typ:g};j&&(u.kid=j);const J={};for(const K of r)try{switch(K.type){case"string":J[K.name]=K.value;break;case"number":J[K.name]=Number(K.value);break;case"boolean":J[K.name]=K.value.toLowerCase()==="true";break;case"json":J[K.name]=JSON.parse(K.value);break}}catch{J[K.name]=K.value}const P=Q(JSON.stringify(u)),h=Q(JSON.stringify(J)),H=`${P}.${h}.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`;w(H),A(new TextEncoder().encode(H).length)}catch(u){console.error("Error generating token preview:",u)}},G=()=>{!d||!d.trim()||(a([...r,{name:d.trim(),value:o,type:S}]),l(""),k(""))},U=u=>{const J=[...r];J.splice(u,1),a(J)},p=(u,J,P)=>{const h=[...r];h[u][J]=P,a(h)},D=async()=>{c(!0),O(null);try{const u={alg:s,typ:g};j&&(u.kid=j);const J={};for(const h of r)try{switch(h.type){case"string":J[h.name]=h.value;break;case"number":J[h.name]=Number(h.value);break;case"boolean":J[h.name]=h.value.toLowerCase()==="true";break;case"json":J[h.name]=JSON.parse(h.value);break}}catch{J[h.name]=h.value}const P=await Ce(u,J,E);w(P),A(new TextEncoder().encode(P).length)}catch(u){O(`Error signing token: ${u instanceof Error?u.message:String(u)}`)}c(!1)},y=()=>{navigator.clipboard.writeText(C),F(!0)},R=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Algorithm (alg)"}),e.jsxs("select",{value:s,onChange:u=>f(u.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[e.jsxs("optgroup",{label:"HMAC",children:[e.jsx("option",{value:"HS256",children:"HS256 (HMAC + SHA256)"}),e.jsx("option",{value:"HS384",children:"HS384 (HMAC + SHA384)"}),e.jsx("option",{value:"HS512",children:"HS512 (HMAC + SHA512)"})]}),e.jsxs("optgroup",{label:"RSA",children:[e.jsx("option",{value:"RS256",children:"RS256 (RSA + SHA256)"}),e.jsx("option",{value:"RS384",children:"RS384 (RSA + SHA384)"}),e.jsx("option",{value:"RS512",children:"RS512 (RSA + SHA512)"})]}),e.jsxs("optgroup",{label:"ECDSA",children:[e.jsx("option",{value:"ES256",children:"ES256 (ECDSA + SHA256)"}),e.jsx("option",{value:"ES384",children:"ES384 (ECDSA + SHA384)"}),e.jsx("option",{value:"ES512",children:"ES512 (ECDSA + SHA512)"})]}),e.jsx("optgroup",{label:"Unsafe",children:e.jsx("option",{value:"none",children:"none (Unsigned Token)"})})]}),s==="none"&&e.jsx("div",{className:"mt-2 text-red-600 dark:text-red-400 text-sm",children:'Warning: The "none" algorithm creates unsigned tokens which provide no security.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Token Type (typ)"}),e.jsx(Z,{value:g,onChange:u=>b(u.target.value),placeholder:"JWT"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:'Usually "JWT" for JSON Web Token'})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Key ID (kid)"}),e.jsx(Z,{value:j,onChange:u=>m(u.target.value),placeholder:"Optional Key ID"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Optional identifier for the key used to sign this token"})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("div",{}),e.jsx(W,{variant:"primary",onClick:()=>t("payload"),children:"Continue to Payload"})]})]}),M=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Current Claims"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Type"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Action"})]})}),e.jsx("tbody",{children:r.map((u,J)=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3",children:e.jsx(Z,{value:u.name,onChange:P=>p(J,"name",P.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3",children:e.jsxs("select",{value:u.type,onChange:P=>p(J,"type",P.target.value),className:"p-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(Z,{value:u.value,onChange:P=>p(J,"value",P.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsx(W,{variant:"light",size:"sm",onClick:()=>U(J),children:"Remove"})})]},J))})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Add Claim"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),e.jsx(Z,{value:d,onChange:u=>l(u.target.value),placeholder:"Claim name",size:"sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),e.jsxs("select",{value:S,onChange:u=>I(u.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Value"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{value:o,onChange:u=>k(u.target.value),placeholder:"Value",size:"sm",className:"flex-grow"}),e.jsx(W,{variant:"primary",size:"sm",className:"ml-2",onClick:G,children:"Add"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-1",children:"Common Claims"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(u=>u.name==="exp")||a([...r,{name:"exp",value:String(Math.floor(Date.now()/1e3)+3600),type:"number"}])},children:"Add exp (Expiry)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(u=>u.name==="iat")||a([...r,{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add iat (Issued At)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(u=>u.name==="nbf")||a([...r,{name:"nbf",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add nbf (Not Before)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(u=>u.name==="iss")||a([...r,{name:"iss",value:"https://example.com",type:"string"}])},children:"Add iss (Issuer)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(u=>u.name==="aud")||a([...r,{name:"aud",value:"client-id",type:"string"}])},children:"Add aud (Audience)"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{r.some(u=>u.name==="jti")||a([...r,{name:"jti",value:crypto.randomUUID(),type:"string"}])},children:"Add jti (JWT ID)"})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx(W,{variant:"light",onClick:()=>t("header"),children:"Back to Header"}),e.jsx(W,{variant:"primary",onClick:()=>t("signature"),children:"Continue to Signature"})]})]}),L=()=>{let u="Secret Key",J="Enter the secret key for HMAC signing";return s.startsWith("RS")?(u="Private Key (PKCS#8)",J="Enter the PEM-formatted RSA private key"):s.startsWith("ES")?(u="Private Key (PKCS#8)",J="Enter the PEM-formatted EC private key"):s==="none"&&(u="No Key Required",J="The 'none' algorithm does not use a key"),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-blue-800 dark:text-blue-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ℹ️"}),"You're creating a token with algorithm ",e.jsx("strong",{children:s})," and ",r.length," claims.",s==="none"&&e.jsx("span",{className:"text-red-600 dark:text-red-400 ml-1",children:" (Unsigned Token - Not secure)"})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:u}),e.jsx("textarea",{value:E,onChange:P=>T(P.target.value),placeholder:s==="none"?'No key needed for "none" algorithm':"Enter key here...",disabled:s==="none",className:"w-full font-mono h-32 p-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 dark:text-gray-200"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:J})]}),e.jsx("div",{className:"mt-4",children:e.jsx(W,{variant:"primary",className:"w-full",onClick:D,disabled:n||s!=="none"&&!E,children:n?"Signing...":"Sign Token"})}),x&&e.jsx("div",{className:"mt-4 bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-red-800 dark:text-red-300 text-sm",children:x})}),e.jsx("div",{className:"mt-6 flex justify-between",children:e.jsx(W,{variant:"light",onClick:()=>t("payload"),children:"Back to Payload"})})]})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWT Builder"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create and sign custom JSON Web Tokens with our step-by-step wizard."})]}),e.jsx(_,{className:"mb-6",children:e.jsxs(de,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(X,{id:"header-tab",isActive:i==="header",onClick:()=>t("header"),children:"1. Header"}),e.jsx(X,{id:"payload-tab",isActive:i==="payload",onClick:()=>t("payload"),children:"2. Payload"}),e.jsx(X,{id:"signature-tab",isActive:i==="signature",onClick:()=>t("signature"),children:"3. Signature"})]}),i==="header"&&R(),i==="payload"&&M(),i==="signature"&&L()]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Generated Token"}),e.jsxs(z,{color:"info",children:["Size: ",N," bytes"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto whitespace-nowrap",children:C||"Your token will appear here..."}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(W,{onClick:y,variant:"primary",disabled:!C,children:$?"Copied!":"Copy Token"})})]})]})]})})})},Le=()=>{const{state:i,dispatch:t,decodeToken:s,verifySignature:f,analyzeToken:j}=me(),{token:m,decoded:g,isVerified:b,error:r,securityIssues:a}=i,[d,l]=v.useState(""),[o,k]=v.useState("json"),[S,I]=v.useState(!1),[E,T]=v.useState(null);v.useState(!1);const[C,w]=v.useState(null);v.useEffect(()=>{if(S){const y=setTimeout(()=>{I(!1),T(null)},2e3);return()=>clearTimeout(y)}},[S]),v.useEffect(()=>{if(a.length>0&&g){const y=a.filter(u=>u.severity==="high").length,R=a.filter(u=>u.severity==="medium").length,M=a.filter(u=>u.severity==="low").length,L=Math.max(0,100-(y*25+R*10+M*5));w(L)}else w(null)},[a,g]);const N=y=>y>=90?"Excellent":y>=80?"Good":y>=60?"Moderate":y>=40?"Poor":"Critical",A=y=>y>=90?"bg-green-100 text-green-800":y>=80?"bg-green-50 text-green-600":y>=60?"bg-yellow-100 text-yellow-800":y>=40?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800",n=y=>{const R=y.target.value.trim();R!==m&&(s(R),R&&j(R))},c=()=>{const y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNjE2MjM5MDIyLCJleHAiOjE5MTYyMzkwMjIsInJvbGUiOiJhZG1pbiJ9.8TT2jkQV3a9lQfNSJz7USP9vgKzlhWPMnDxCQfFgj3w";s(y),j(y)},x=()=>{t({type:"RESET"}),l(""),w(null)},O=(y,R="token")=>{navigator.clipboard.writeText(y),I(!0),T(R)},$=()=>{!g||!d||f(g.header.alg,d)},F=y=>{try{return new Date(y*1e3).toLocaleString()}catch{return"Invalid date"}},B=y=>Date.now()>y*1e3,G=y=>{switch(y){case"sub":return"Subject (user) identifier";case"iss":return"Issuer of the token";case"aud":return"Audience the token is intended for";case"exp":return"Expiration time (when token becomes invalid)";case"nbf":return"Not before time (when token starts being valid)";case"iat":return"Issued at time (when token was issued)";case"jti":return"JWT ID (unique identifier for this token)";case"name":return"User name";case"given_name":return"User first name";case"family_name":return"User last name";case"email":return"User email address";case"roles":return"User roles/permissions";case"scope":return"OAuth 2.0 scopes";case"sid":return"Session ID";case"auth_time":return"Time when authentication occurred";default:return"Custom claim"}},U=y=>{switch(y){case"high":return"⚠️";case"medium":return"⚠";case"low":return"ℹ️";default:return"ℹ️"}},p=y=>{switch(y){case"header":return"text-blue-600 dark:text-blue-400";case"payload":return"text-purple-600 dark:text-purple-400";case"signature":return"text-red-600 dark:text-red-400";default:return"text-gray-600"}},D=()=>{if(!a||a.length===0)return null;const y=a.filter(u=>u.severity==="high"),R=a.filter(u=>u.severity==="medium"),M=a.filter(u=>u.severity==="low"),L=a.filter(u=>u.severity==="info");return e.jsxs(_,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:["Security Analysis",C!==null&&e.jsxs("div",{className:"ml-auto flex items-center",children:[e.jsx("div",{className:"text-sm mr-2",children:"Security Score:"}),e.jsx("div",{className:`rounded-full w-10 h-10 flex items-center justify-center ${A(C)}`,children:C}),e.jsx("div",{className:"ml-2 text-sm font-medium",children:N(C)})]})]})}),e.jsxs("div",{className:"p-4",children:[y.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-red-600 dark:text-red-400 font-medium mb-2",children:"Critical Issues"}),y.map(u=>e.jsx(V,{type:"error",className:"mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 mt-0.5",children:U(u.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u.title}),e.jsx("div",{className:"text-sm",children:u.description})]})]})},u.id))]}),R.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-yellow-600 dark:text-yellow-400 font-medium mb-2",children:"Warning Issues"}),R.map(u=>e.jsx(V,{type:"warning",className:"mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 mt-0.5",children:U(u.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u.title}),e.jsx("div",{className:"text-sm",children:u.description})]})]})},u.id))]}),(M.length>0||L.length>0)&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-blue-600 dark:text-blue-400 font-medium mb-2",children:"Informational"}),[...M,...L].map(u=>e.jsx(V,{type:"info",className:"mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 mt-0.5",children:U(u.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:u.title}),e.jsx("div",{className:"text-sm",children:u.description})]})]})},u.id))]})]})]})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-5xl px-4 py-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWT Token Inspector"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Decode, verify, and analyze JSON Web Tokens with advanced security analysis."})]}),e.jsxs(_,{className:"mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"JWT Token"}),e.jsx(W,{onClick:c,size:"sm",variant:"light",children:"Generate Demo"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🔒"}),"All JWT processing happens locally in your browser. Your tokens are never sent to a server."]})}),e.jsx("textarea",{className:"w-full font-mono text-sm p-3 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 h-28 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:m,onChange:n,placeholder:"Paste your JWT token here...",spellCheck:"false"}),r&&e.jsx(V,{type:"error",className:"mt-4",children:r}),g&&e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto break-all",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Header:"}),e.jsx("div",{className:`${p("header")} flex-1`,children:g.raw.header})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Payload:"}),e.jsx("div",{className:`${p("payload")} flex-1`,children:g.raw.payload})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Signature:"}),e.jsx("div",{className:`${p("signature")} flex-1`,children:g.raw.signature})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(W,{onClick:x,variant:"light",children:"Reset"})}),e.jsx(W,{onClick:()=>O(m),variant:"primary",children:S&&E==="token"?"Copied!":"Copy Token"})]})]})]}),D(),g&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(_,{children:e.jsxs(de,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(X,{id:"tab-json",isActive:o==="json",onClick:()=>k("json"),children:"JSON"}),e.jsx(X,{id:"tab-claims",isActive:o==="claims",onClick:()=>k("claims"),children:"Claims Table"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:p("header"),children:"HEADER"}),e.jsx(W,{onClick:()=>O(JSON.stringify(g.header,null,2),"header"),variant:"light",size:"xs",className:"ml-2",children:S&&E==="header"?"Copied!":"Copy"})]}),e.jsx(re,{id:"panel-json-header",isActive:o==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(g.header,null,2)})})}),e.jsx(re,{id:"panel-claims-header",isActive:o==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(g.header).map(([y,R])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:y}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(ee,{content:y==="alg"?"Algorithm used to sign the token":y==="typ"?"Token type":y==="kid"?"Key identifier":`Header claim: ${y}`,children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:String(R)})})})]},y))})]})})}),e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:p("payload"),children:"PAYLOAD"}),e.jsx(W,{onClick:()=>O(JSON.stringify(g.payload,null,2),"payload"),variant:"light",size:"xs",className:"ml-2",children:S&&E==="payload"?"Copied!":"Copy"})]}),e.jsx(re,{id:"panel-json-payload",isActive:o==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(g.payload,null,2)})})}),e.jsx(re,{id:"panel-claims-payload",isActive:o==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(g.payload).map(([y,R])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:y}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(ee,{content:G(y),children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:y==="exp"||y==="iat"||y==="nbf"?e.jsxs("div",{children:[e.jsx("div",{children:String(R)}),e.jsxs("div",{className:`text-xs mt-1 ${y==="exp"&&B(R)?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:[F(R),y==="exp"&&e.jsx("span",{className:"ml-2",children:B(R)?e.jsx(z,{color:"danger",size:"sm",children:"Expired"}):e.jsx(z,{color:"success",size:"sm",children:"Valid"})})]})]}):typeof R=="boolean"?e.jsx("span",{className:R?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:String(R)}):String(R)})})})]},y))})]})})})]})]})})}),e.jsxs("div",{children:[e.jsxs(_,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Signature Verification"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Verify the signature using your secret key. Algorithm: ",g.header.alg||"unknown"]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"secret-key",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secret/Public Key"}),e.jsx(Z,{id:"secret-key",value:d,onChange:y=>l(y.target.value),placeholder:"Enter secret key or paste public key...",className:"font-mono"})]}),e.jsx(W,{onClick:$,variant:"primary",className:"w-full mt-3",disabled:!d,children:"Verify Signature"}),b!==null&&e.jsx("div",{className:`mt-4 p-3 rounded-md ${b?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:b?"✅":"❌"}),e.jsx("span",{className:"font-medium",children:b?"Signature Verified":"Invalid Signature"})]})})]})]}),g.payload.exp&&e.jsxs(_,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Token Status"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:`p-3 rounded-md ${B(g.payload.exp)?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"}`,children:[e.jsx("div",{className:"font-medium",children:B(g.payload.exp)?"🕒 Expired":"✅ Valid"}),e.jsx("div",{className:"text-sm mt-1",children:F(g.payload.exp)})]}),g.payload.iat&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issued at:"}),e.jsx("div",{className:"text-sm",children:F(g.payload.iat)})]}),g.payload.nbf&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Not valid before:"}),e.jsx("div",{className:"text-sm",children:F(g.payload.nbf)})]})]})]})]})]})}),e.jsx("div",{className:"mt-8",children:e.jsxs(_,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold",children:"JWT Security Best Practices"})}),e.jsx("div",{className:"p-4 text-sm",children:e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),e.jsx("span",{children:"Use short-lived tokens with expiration times (exp claim)"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),e.jsx("span",{children:"Prefer asymmetric algorithms (RS256, ES256) over symmetric ones (HS256) for public clients"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),e.jsx("span",{children:"Include audience (aud) and issuer (iss) claims to prevent token misuse"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:"✓"}),e.jsx("span",{children:"Use strong, unique keys for signing tokens"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"✗"}),e.jsx("span",{children:"Never store sensitive data like passwords or API keys in tokens"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"✗"}),e.jsx("span",{children:"Never use the 'none' algorithm in production"})]}),e.jsxs("li",{className:"flex",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400 mr-2",children:"✗"}),e.jsx("span",{children:"Avoid very long-lived tokens (> 24 hours) for sensitive operations"})]})]})})]})})]})})})},Ve=()=>{var $,F,B,G,U;const{state:i}=me(),{decoded:t}=i,[s,f]=v.useState(""),[j,m]=v.useState("jwks"),[g,b]=v.useState(!1),[r,a]=v.useState([]),[d,l]=v.useState(null),[o,k]=v.useState(null),[S,I]=v.useState(null),[E,T]=v.useState(!1),[C,w]=v.useState(null);v.useEffect(()=>{var p;if((p=t==null?void 0:t.payload)!=null&&p.iss&&!s){const D=t.payload.iss;D.endsWith("/")?f(`${D}.well-known/openid-configuration`):f(`${D}/.well-known/openid-configuration`),m("oidc")}},[t]),v.useEffect(()=>{if(E){const p=setTimeout(()=>{T(!1),w(null)},2e3);return()=>clearTimeout(p)}},[E]),v.useEffect(()=>{var p;if((p=t==null?void 0:t.header)!=null&&p.kid&&r.length>0){const D=t.header.kid,y=r.find(R=>R.kid===D);I(y||null)}else I(null)},[t,r]);const N=async()=>{if(s){b(!0),k(null),a([]),l(null);try{const p=await fetch(s);if(!p.ok)throw new Error(`HTTP error: ${p.status} ${p.statusText}`);const D=await p.json();try{sessionStorage.setItem(`jwks_${s}`,JSON.stringify(D))}catch(y){console.warn("Failed to cache JWKS in sessionStorage:",y)}if(D.keys)a(D.keys);else throw new Error("No keys found in the JWKS response")}catch(p){k(`Failed to fetch JWKS: ${p instanceof Error?p.message:String(p)}`)}finally{b(!1)}}},A=async()=>{if(s){b(!0),k(null),a([]),l(null);try{const p=await fetch(s);if(!p.ok)throw new Error(`HTTP error: ${p.status} ${p.statusText}`);const D=await p.json();l(D);try{sessionStorage.setItem(`oidc_${s}`,JSON.stringify(D))}catch(M){console.warn("Failed to cache OIDC config in sessionStorage:",M)}if(!D.jwks_uri)throw new Error("No JWKS URI found in the OIDC configuration");const y=await fetch(D.jwks_uri);if(!y.ok)throw new Error(`HTTP error fetching JWKS: ${y.status} ${y.statusText}`);const R=await y.json();try{sessionStorage.setItem(`jwks_${D.jwks_uri}`,JSON.stringify(R))}catch(M){console.warn("Failed to cache JWKS in sessionStorage:",M)}if(R.keys)a(R.keys);else throw new Error("No keys found in the JWKS response")}catch(p){k(`Failed to fetch OIDC configuration or JWKS: ${p instanceof Error?p.message:String(p)}`)}finally{b(!1)}}},n=()=>{j==="jwks"?N():A()},c=(p,D)=>{navigator.clipboard.writeText(p),T(!0),w(D)},x=()=>{f(j==="jwks"?"https://www.googleapis.com/oauth2/v3/certs":"https://accounts.google.com/.well-known/openid-configuration")},O=(p,D)=>{var M;const y=((M=t==null?void 0:t.header)==null?void 0:M.kid)&&p.kid===t.header.kid,R=JSON.stringify(p,null,2);return e.jsxs(_,{className:`mb-4 ${y?"border-green-500 dark:border-green-500":""}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("h4",{className:"font-semibold flex items-center",children:[y&&e.jsx("span",{className:"mr-2 text-green-500",children:"✓ "}),"Key ",p.kid?`ID: ${p.kid}`:D+1]}),e.jsxs("div",{className:"flex gap-2",children:[p.alg&&e.jsx(z,{color:"primary",children:p.alg}),e.jsx(z,{color:"info",children:p.kty}),p.use&&e.jsx(z,{color:"success",children:p.use})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",p.kty]}),p.alg&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Algorithm:"})," ",p.alg]}),p.use&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Use:"})," ",p.use]}),p.key_ops&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Operations:"})," ",p.key_ops.join(", ")]}),p.kty==="RSA"&&p.n&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Modulus (n):"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:p.n})]}),p.kty==="RSA"&&p.e&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Exponent (e):"})," ",p.e]}),p.kty==="EC"&&e.jsxs(e.Fragment,{children:[p.crv&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Curve:"})," ",p.crv]}),p.x&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"X:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:p.x})]}),p.y&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Y:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:p.y})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsx(W,{variant:"light",size:"sm",onClick:()=>c(R,`key_${D}`),children:E&&C===`key_${D}`?"Copied!":"Copy Key JSON"})})]})]},p.kid||D)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWKS Probe"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Discover and explore JSON Web Key Sets (JWKS) to verify JWT signatures."})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-md border border-blue-200 dark:border-blue-800 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-3 text-blue-600 dark:text-blue-400 text-lg",children:"ℹ️"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"What is JWKS?"}),e.jsx("p",{className:"text-blue-800 dark:text-blue-200 text-sm",children:"A JSON Web Key Set is a JSON document that represents a set of public keys as a JSON object. JWKS endpoints are used to publish the public keys needed to verify JWT signatures. This tool helps you retrieve and inspect these keys."})]})]})}),e.jsxs(_,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"JWKS Endpoint Configuration"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"URL Type"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"jwks",checked:j==="jwks",onChange:()=>m("jwks"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"JWKS Endpoint"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"oidc",checked:j==="oidc",onChange:()=>m("oidc"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"OIDC Discovery"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"jwks-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:j==="jwks"?"JWKS URL":"OIDC Discovery URL"}),e.jsxs("div",{className:"flex",children:[e.jsx(Z,{id:"jwks-url",value:s,onChange:p=>f(p.target.value),placeholder:j==="jwks"?"https://example.com/.well-known/jwks.json":"https://example.com/.well-known/openid-configuration",className:"flex-grow"}),e.jsx(W,{onClick:x,variant:"light",className:"ml-2",children:"Sample"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:j==="jwks"?"Direct URL to a JWKS endpoint containing public keys":"URL to an OpenID Connect discovery document"}),(($=t==null?void 0:t.payload)==null?void 0:$.iss)&&e.jsxs("div",{className:"mt-2 p-2 bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 text-sm rounded-md",children:["Token issuer detected: ",e.jsx("span",{className:"font-medium",children:t.payload.iss})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(W,{onClick:n,variant:"primary",disabled:!s||g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{size:"sm",className:"mr-2"}),"Fetching..."]}):"Fetch Keys"})})]})]}),o&&e.jsx(V,{type:"error",className:"mb-6",children:o}),d&&e.jsxs(_,{className:"mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"OIDC Configuration"}),e.jsx(W,{variant:"light",size:"sm",onClick:()=>{const p=JSON.stringify(d,null,2);c(p,"oidc_config")},children:E&&C==="oidc_config"?"Copied!":"Copy Full Config"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.issuer&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Issuer:"})," ",d.issuer]}),d.jwks_uri&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"JWKS URI:"})," ",d.jwks_uri]}),d.token_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Token Endpoint:"})," ",d.token_endpoint]}),d.authorization_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Authorization Endpoint:"})," ",d.authorization_endpoint]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Available Scopes:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(F=d.scopes_supported)==null?void 0:F.slice(0,8).map(p=>e.jsx(z,{color:"info",children:p},p)),((B=d.scopes_supported)==null?void 0:B.length)>8&&e.jsxs(z,{color:"light",children:["+",d.scopes_supported.length-8," more"]})]})]})]})]}),r.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Keys Found (",r.length,")"]}),S&&((G=t==null?void 0:t.header)==null?void 0:G.kid)&&e.jsxs(z,{color:"success",children:["Found matching key for KID: ",t.header.kid]})]}),((U=t==null?void 0:t.header)==null?void 0:U.kid)&&!S&&r.length>0&&e.jsxs(V,{type:"warning",className:"mb-4",children:[`No key matching the token's kid "`,t.header.kid,'" was found in the JWKS.']}),r.map((p,D)=>O(p,D))]}),r.length>0&&e.jsxs(_,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"JWKS Usage Guide"})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"How to use a JWKS to verify a JWT:"}),e.jsxs("ol",{className:"list-decimal pl-5 space-y-2 text-sm",children:[e.jsx("li",{children:"Decode the JWT to extract the header and identify the key ID (kid)"}),e.jsx("li",{children:"Find the matching key in the JWKS with the same kid"}),e.jsx("li",{children:"Extract the public key components from the JWK (modulus, exponent for RSA)"}),e.jsx("li",{children:"Use the public key to verify the JWT signature with the algorithm specified in the header"})]}),e.jsx("h4",{className:"font-medium mt-4",children:"Security Best Practices:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2 text-sm",children:[e.jsx("li",{children:"Always validate the signature of JWTs using the public keys from the JWKS"}),e.jsx("li",{children:"Check that the key's intended use (if specified) matches your use case"}),e.jsx("li",{children:"Consider caching the JWKS to improve performance, but refresh regularly"}),e.jsx("li",{children:"Always use HTTPS when fetching JWKS endpoints"})]})]})})]})]})})},ne=["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512"],Ge={HS:"HMAC with SHA-2 - Symmetric key signatures using a shared secret",RS:"RSASSA-PKCS1-v1_5 - RSA signatures with PKCS#1 v1.5 padding",ES:"ECDSA - Elliptic Curve Digital Signature Algorithm",PS:"RSASSA-PSS - RSA signatures with Probabilistic Signature Scheme"},ye=i=>i.startsWith("HS")?"bg-blue-500":i.startsWith("RS")?"bg-green-500":i.startsWith("ES")?"bg-purple-500":i.startsWith("PS")?"bg-orange-500":"bg-gray-500",te=i=>i.toLocaleString(void 0,{maximumFractionDigits:2}),Ze=()=>{var N,A;const[i,t]=v.useState(!1),[s,f]=v.useState(null),[j,m]=v.useState(0),[g,b]=v.useState([]),[r,a]=v.useState(null),[d,l]=v.useState(!1),[o,k]=v.useState("performance"),S=v.useCallback(async n=>{try{const c=performance.now(),x=n.startsWith("ES")?50:100,$=await(await ie(()=>Promise.resolve().then(()=>oe),void 0)).bench(n),B=performance.now()-c;return{algorithm:n,operationsPerSecond:$,averageTime:x>0?B/x:0,totalOperations:x,color:ye(n)}}catch(c){return console.error(`Error benchmarking ${n}:`,c),{algorithm:n,operationsPerSecond:0,averageTime:0,totalOperations:0,color:ye(n)}}},[]),I=v.useCallback(async()=>{t(!0),b([]),a(null),m(0);try{const n=[];for(let x=0;x<ne.length;x++){const O=ne[x];f(O),await new Promise(F=>setTimeout(F,100));const $=await S(O);n.push($),m((x+1)/ne.length*100)}const c=[...n].sort((x,O)=>O.operationsPerSecond-x.operationsPerSecond);b(c)}catch(n){a(n instanceof Error?n.message:"An error occurred during benchmarking")}finally{f(null),t(!1)}},[S]);v.useEffect(()=>{if(g.length>0){const n=[...g].sort((c,x)=>o==="algorithm"?c.algorithm.localeCompare(x.algorithm):x.operationsPerSecond-c.operationsPerSecond);b(n)}},[o]);const E=v.useCallback(()=>g.length===0?null:g.reduce((n,c)=>c.operationsPerSecond>n.operationsPerSecond?c:n),[g]),T=v.useCallback(()=>{const n={};return g.forEach(c=>{const x=c.algorithm.substring(0,2);n[x]||(n[x]=[]),n[x].push(c)}),n},[g]),C=v.useCallback(()=>{if(g.length===0)return null;const n=Math.max(...g.map(c=>c.operationsPerSecond));return e.jsx("div",{className:"mt-4",children:g.map((c,x)=>{const O=c.operationsPerSecond/n*100,$=c.operationsPerSecond===n;return e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium w-16",children:c.algorithm}),$&&e.jsx(z,{color:"success",className:"ml-2",children:"Fastest"})]}),e.jsxs("span",{className:"text-sm",children:[te(c.operationsPerSecond)," op/s"]})]}),e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-md overflow-hidden",children:e.jsx("div",{className:`h-full ${c.color} transition-all duration-1000 ease-out`,style:{width:`${O}%`,animationDelay:`${x*.1}s`,opacity:i?.7:1}})}),d&&e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex justify-between",children:[e.jsxs("span",{children:["Avg: ",te(c.averageTime)," ms/op"]}),e.jsxs("span",{children:["Total: ",c.totalOperations," operations"]})]})]},c.algorithm)})})},[g,i,d]),w=v.useCallback(()=>{const n=T();return e.jsx("div",{className:"mt-6 space-y-6",children:Object.entries(n).map(([c,x])=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-md",children:[e.jsxs("h4",{className:"font-medium mb-2",children:[c," Family"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:Ge[c]||"JWT signature algorithm family"}),e.jsx("div",{className:"space-y-3",children:x.map(O=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:O.algorithm}),e.jsxs("div",{className:"font-mono",children:[te(O.operationsPerSecond)," op/s"]})]},O.algorithm))})]},c))})},[T]);return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JWT Algorithm Performance"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Benchmark JWT signing algorithms in your browser to determine the best performance."})]}),e.jsxs(_,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Performance Benchmark"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"⚡"}),"This tool tests JWT algorithm performance in your browser. Results may vary based on device capabilities and browser implementation."]})}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(W,{onClick:I,variant:"primary",disabled:i,children:i?"Benchmarking...":"Run Benchmark"}),g.length>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"mr-2 text-sm",children:"Sort by:"}),e.jsxs("select",{value:o,onChange:n=>k(n.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm p-1",children:[e.jsx("option",{value:"performance",children:"Speed (fastest first)"}),e.jsx("option",{value:"algorithm",children:"Algorithm name"})]})]})]}),i&&s&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-sm",children:["Testing algorithm: ",e.jsx("strong",{children:s})]}),e.jsxs("span",{className:"text-sm",children:[Math.round(j),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300 ease-out",style:{width:`${j}%`}})})]}),r&&e.jsx(V,{type:"error",className:"mb-4",children:r}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2 flex justify-between items-center",children:[e.jsx("h4",{className:"font-medium",children:"Results"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"show-details",checked:d,onChange:()=>l(!d),className:"mr-2"}),e.jsx("label",{htmlFor:"show-details",className:"text-sm",children:"Show detailed metrics"})]})]}),C(),!i&&E()&&e.jsxs("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-md border border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"font-medium text-green-800 dark:text-green-300 mb-1",children:"Performance Summary"}),e.jsxs("p",{className:"text-green-800 dark:text-green-200 text-sm",children:[e.jsx("span",{className:"font-medium",children:(N=E())==null?void 0:N.algorithm})," is the fastest algorithm in your browser, performing ",te(((A=E())==null?void 0:A.operationsPerSecond)||0)," operations per second."]})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Algorithm Family Comparison"}),w()]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"System:"}),e.jsx("span",{className:"ml-2 text-sm",children:navigator.userAgent})]}),e.jsx("div",{children:e.jsx(z,{color:"info",children:new Date().toLocaleString()})})]})})]}),!i&&g.length===0&&e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:'Click "Run Benchmark" to test JWT algorithm performance in your browser.'})]})]}),e.jsxs(_,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"About JWT Algorithms"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Symmetric Algorithms (HS*)"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"HMAC with SHA-2 algorithms use a shared secret key for both signing and verification. They are typically faster but require secure key distribution."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm space-y-1 text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"HS256: HMAC using SHA-256"}),e.jsx("li",{children:"HS384: HMAC using SHA-384"}),e.jsx("li",{children:"HS512: HMAC using SHA-512"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Asymmetric Algorithms (RS*, ES*, PS*)"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Asymmetric algorithms use a private key for signing and a public key for verification. They are typically slower but provide better security separation."}),e.jsxs("ul",{className:"list-disc pl-5 text-sm space-y-1 text-gray-600 dark:text-gray-400",children:[e.jsx("li",{children:"RS256: RSA Signature with SHA-256"}),e.jsx("li",{children:"ES256: ECDSA Signature with SHA-256"}),e.jsx("li",{children:"PS256: RSA-PSS Signature with SHA-256"})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Choosing the Right Algorithm"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"When selecting a JWT signing algorithm, consider these factors:"}),e.jsxs("ul",{className:"list-disc pl-5 text-sm space-y-2 text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Performance"}),": HMAC algorithms (HS*) are typically faster than RSA (RS*/PS*) and ECDSA (ES*)."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Security"}),": ES256 offers similar security to RS256 with smaller signatures and better performance."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Key Management"}),": Asymmetric algorithms allow public key distribution without exposing signing capabilities."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Standards Compliance"}),": Some standards require specific algorithms (e.g., OIDC prefers RS256)."]})]})]})]})]})]})},Ye=()=>e.jsx(He,{children:e.jsxs(Re,{children:[e.jsx(Y,{path:"/",element:e.jsx(_e,{})}),e.jsx(Y,{path:"/build",element:e.jsx(Ue,{})}),e.jsx(Y,{path:"/inspect",element:e.jsx(Le,{})}),e.jsx(Y,{path:"/jwks",element:e.jsx(Ve,{})}),e.jsx(Y,{path:"/benchmark",element:e.jsx(Ze,{})}),e.jsx(Y,{path:"*",element:e.jsx(Je,{to:"/jwt"})})]})}),Xe={id:"jwt",title:"JWT Toolkit",description:"Comprehensive tool suite for JSON Web Tokens",route:"/jwt",icon:()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e.jsx("path",{d:"M12 0L1.604 6v12L12 24l10.396-6V6L12 0zm-1 20.5v-17l9 5.2v6.6l-9 5.2z"})}),component:v.lazy(()=>Promise.resolve({default:()=>e.jsx(e.Fragment,{})})),category:"Security",metadata:{keywords:["jwt","token","authentication","json web token"]},uiOptions:{fullWidth:!0}},ts=()=>{const i=We(),s=De().pathname.split("/jwt")[1]||"/",f=[{id:"/",label:"Decoder",title:"Decode & Verify JWT Tokens"},{id:"/inspect",label:"Inspector",title:"Deep Inspection & Security Analysis"},{id:"/build",label:"Builder",title:"Create & Sign JWT Tokens"},{id:"/jwks",label:"JWKS",title:"JWKS Tool & Public Key Discovery"},{id:"/benchmark",label:"Performance",title:"Algorithm Performance Benchmarks"}],j=b=>{i(`/jwt${b}`)},m="JWT Toolkit | MyDebugger",g="Complete JWT toolkit for developers: decode, create, inspect, verify and benchmark JSON Web Tokens with our comprehensive suite of JWT tools.";return e.jsxs(e.Fragment,{children:[e.jsxs(fe,{children:[e.jsx("title",{children:m}),e.jsx("meta",{name:"description",content:g}),e.jsx("meta",{property:"og:title",content:m}),e.jsx("meta",{property:"og:description",content:g}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:m}),e.jsx("meta",{name:"twitter:description",content:g}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsx(Ie,{tool:Xe,children:e.jsxs(_,{className:"p-0 overflow-visible",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx(de,{activeTab:s,onChange:j,children:f.map(b=>e.jsx(X,{id:b.id,isActive:s===b.id,children:b.label},b.id))})}),e.jsx("div",{className:"p-5",children:e.jsx(Ye,{})})]})})]})};export{ts as default};
//# sourceMappingURL=JwtToolkit-6ac6171f.js.map
