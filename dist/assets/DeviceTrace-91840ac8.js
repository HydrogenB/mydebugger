import{g as J,j as e,b as W,C as T,B as f,L as z}from"./index-03788e60.js";import{r as d}from"./react-e68835f7.js";import{H as K}from"./vendor-975fbbe6.js";import"./TabGroup-60a1a443.js";import"./Modal-efe9865f.js";function m(i,n){const[c,g]=d.useState(()=>{try{const s=window.localStorage.getItem(i);return s?JSON.parse(s):n}catch(s){return console.error(`Error reading localStorage key "${i}":`,s),n}});return[c,s=>{try{const o=s instanceof Function?s(c):s;g(o),window.localStorage.setItem(i,JSON.stringify(o))}catch(o){console.error(`Error writing localStorage key "${i}":`,o)}}]}const _=()=>{const i=J("/device-trace"),[n,c]=d.useState(""),[g,p]=d.useState(!1),[s,o]=d.useState(null),[l,j]=d.useState(!1),[w,h]=d.useState(null),[v,N]=d.useState(null),[L,O]=m("probe:lastIosAppId",""),[S,U]=m("probe:lastAndroidPkg",""),[C,D]=m("probe:lastScheme",""),[u,F]=m("probe:lastLink",""),[R,M]=m("probe:recentLinks",[]),x=d.useRef(null),y=d.useRef(null);d.useEffect(()=>{u&&c(u)},[u]),d.useEffect(()=>{function r(a){y.current&&!y.current.contains(a.target)&&p(!1)}return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[]);const E=async()=>{if(!n){h("Please enter a URL");return}H(n),F(n),j(!0),h(null),o(null);try{const r=await fetch("/api/device-trace",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:n,maxHops:20,iosAppId:L,androidPackage:S,deepLinkScheme:C})});if(!r.ok){const t=await r.json();throw new Error(t.error||`Request failed with status ${r.status}`)}const a=await r.json();o(a)}catch(r){h(`Error tracing dynamic link: ${r instanceof Error?r.message:"Unknown error"}`)}finally{j(!1)}},H=r=>{M(a=>{const t=a.filter($=>$!==r);return[r,...t].slice(0,10)})},V=r=>{c(r),p(!1)},P=r=>{r.key==="Enter"&&E()},B=()=>{if(!s)return;const r=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),t=document.createElement("a");t.setAttribute("hidden",""),t.setAttribute("href",a),t.setAttribute("download","dynamic-link-trace.json"),document.body.appendChild(t),t.click(),document.body.removeChild(t),A("JSON file downloaded!")},I=()=>{if(!s)return;let r=`Scenario,Final URL,Status,Hops,Latency (ms)
`;s.results.forEach(a=>{const t=a.hops[a.hops.length-1]||{status:"N/A"};r+=`"${a.name}","${a.finalUrl}",${t.status},${a.hops.length},${a.totalTimeMs}
`}),navigator.clipboard.writeText(r),A("Table copied to clipboard as CSV!")},A=r=>{N(r),x.current&&window.clearTimeout(x.current),x.current=window.setTimeout(()=>{N(null)},3e3)};d.useEffect(()=>()=>{x.current&&window.clearTimeout(x.current)},[]);const b="Dynamic-Link Behavior Probe | MyDebugger",k="Test how App Flyer and OneLink URLs behave across different device contexts and installation states.";return e.jsxs(W,{tool:i,children:[e.jsxs(K,{children:[e.jsx("title",{children:b}),e.jsx("meta",{name:"description",content:k}),e.jsx("meta",{property:"og:title",content:b}),e.jsx("meta",{property:"og:description",content:k}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/device-trace"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:b}),e.jsx("meta",{name:"twitter:description",content:k}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/device-trace"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(T,{isElevated:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"url-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Dynamic Link URL"}),e.jsxs("div",{className:"flex relative",children:[e.jsxs("div",{className:"flex-grow flex",children:[e.jsx("input",{id:"url-input",type:"text",className:"flex-grow rounded-l-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:border-primary-500 focus:ring focus:ring-primary-200 dark:focus:ring-primary-900 focus:ring-opacity-50",placeholder:"https://example.onelink.me/abc",value:n,onChange:r=>c(r.target.value),onKeyPress:P,disabled:l}),R.length>0&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",className:"h-full px-3 border-t border-b border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-500 hover:text-gray-700 dark:hover:text-gray-200",onClick:()=>p(!g),children:e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})}),g&&e.jsx("div",{ref:y,className:"absolute right-0 mt-1 w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg z-10",children:e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-200 dark:border-gray-700",children:"Recent URLs"}),R.map((r,a)=>e.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 truncate",onClick:()=>V(r),children:r},a))]})})]})]}),e.jsx(f,{onClick:E,isLoading:l,disabled:l||!n,className:"rounded-l-none",children:"Probe Link"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ios-app-id",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"iOS App Store ID (optional)"}),e.jsx("input",{id:"ios-app-id",type:"text",className:"block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:border-primary-500 focus:ring focus:ring-primary-200 dark:focus:ring-primary-900 focus:ring-opacity-50 text-sm",placeholder:"id123456789",value:L,onChange:r=>O(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"android-pkg",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Android Package Name (optional)"}),e.jsx("input",{id:"android-pkg",type:"text",className:"block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:border-primary-500 focus:ring focus:ring-primary-200 dark:focus:ring-primary-900 focus:ring-opacity-50 text-sm",placeholder:"com.example.app",value:S,onChange:r=>U(r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"deep-link-scheme",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Deep-Link Scheme / Prefix (optional)"}),e.jsx("input",{id:"deep-link-scheme",type:"text",className:"block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:border-primary-500 focus:ring focus:ring-primary-200 dark:focus:ring-primary-900 focus:ring-opacity-50 text-sm",placeholder:"example://",value:C,onChange:r=>D(r.target.value)})]})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Enter any App Flyer or Firebase dynamic link to test how it behaves across different device contexts."})]}),w&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md text-red-700 dark:text-red-400 text-sm",children:w}),l&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(z,{})}),s&&!l&&e.jsxs("div",{className:"animate-fade-in space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsx("h2",{className:"text-xl font-medium text-gray-900 dark:text-white",children:"Dynamic Link Behavior Results"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Overall processing time: ",e.jsxs("span",{className:"font-medium",children:[s.overallTimeMs,"ms"]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-900 overflow-hidden border border-gray-200 dark:border-gray-700 rounded-md shadow",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Scenario"}),e.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Final URL"}),e.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Hops"}),e.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Latency"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.results.map((r,a)=>{const t=r.hops[r.hops.length-1]||{status:"N/A"};return e.jsxs("tr",{className:a%2===0?"bg-white dark:bg-gray-900":"bg-gray-50 dark:bg-gray-800",children:[e.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:r.name}),e.jsx("td",{className:"px-3 py-4 text-sm text-gray-700 dark:text-gray-300 font-mono break-all max-w-xs",children:r.finalUrl}),e.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.status>=200&&t.status<300?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":t.status>=300&&t.status<400?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":t.status>=400&&t.status<500?"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"}`,children:t.status})}),e.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300",children:r.hops.length}),e.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300",children:[r.totalTimeMs,"ms"]})]},r.scenario)})})]})})}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-6 bg-gray-50 dark:bg-gray-800 p-4 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Export Results"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Download or copy data in different formats"})]}),e.jsxs("div",{className:"flex space-x-2 mt-3 sm:mt-0",children:[e.jsxs(f,{onClick:B,variant:"light",size:"sm",className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 10V16M12 16L9 13M12 16L15 13M17 21H7C5.89543 21 5 20.1046 5 19V5C5 3.89543 5.89543 3 7 3H14L19 8V19C19 20.1046 18.1046 21 17 21Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Export JSON"]}),e.jsxs(f,{onClick:I,variant:"light",size:"sm",className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M8 5H6C4.89543 5 4 5.89543 4 7V19C4 20.1046 4.89543 21 6 21H16C17.1046 21 18 20.1046 18 19V18M8 5C8 3.89543 8.89543 3 10 3H14C15.1046 3 16 3.89543 16 5V7M8 5V7H16V5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Copy Table"]})]})]}),v&&e.jsxs("div",{className:"mt-2 flex items-center justify-center p-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md text-green-700 dark:text-green-400 text-sm",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),v]})]})]})}),e.jsx(T,{title:"About Dynamic Link Behavior",isElevated:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Dynamic links (like those from App Flyer or Firebase) change their behavior based on the user's device context. This tool simulates how the same link behaves across different scenarios."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"iOS + App Installed"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Opens the app via deep-link (app scheme URL)"})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"iOS + No App"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Redirects to the App Store listing"})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"Android + App Installed"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Opens the app via intent:// URL or app scheme"})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"Android + No App"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Redirects to Google Play Store"})]}),e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-md p-3 sm:col-span-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"Desktop"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Redirects to a marketing or landing page"})]})]})]})})]})]})};export{_ as default};
//# sourceMappingURL=DeviceTrace-91840ac8.js.map
