import{j as e,C as H,B as J,a as M,T as z,_ as q,L as G,b as je}from"./index-a06d4fdc.js";import{R as U,r as b,b as ve,c as $,N as ke,u as we,d as Ne}from"./react-e68835f7.js";import{H as ae}from"./vendor-975fbbe6.js";import{T as Z,a as P,b as L}from"./TabGroup-4a4651ff.js";import{T as ee}from"./Tooltip-366e21bc.js";const F=({type:c="info",title:i,children:n,showIcon:y=!0,dismissible:u=!1,onDismiss:h,className:v="",containerClassName:g="",outlined:r=!1,id:t,action:l})=>{const[o,a]=U.useState(!0),[x,C]=U.useState(!1);if(!o)return null;const T=()=>{C(!0),setTimeout(()=>{a(!1),h&&h()},300)},k={info:{solid:"bg-blue-50 border-blue-300 text-blue-800 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300",outlined:"bg-transparent border-blue-500 text-blue-700 dark:text-blue-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})},success:{solid:"bg-green-50 border-green-300 text-green-800 dark:bg-green-900/30 dark:border-green-800 dark:text-green-300",outlined:"bg-transparent border-green-500 text-green-700 dark:text-green-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},warning:{solid:"bg-yellow-50 border-yellow-300 text-yellow-800 dark:bg-yellow-900/30 dark:border-yellow-800 dark:text-yellow-300",outlined:"bg-transparent border-yellow-500 text-yellow-700 dark:text-yellow-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})},error:{solid:"bg-red-50 border-red-300 text-red-800 dark:bg-red-900/30 dark:border-red-800 dark:text-red-300",outlined:"bg-transparent border-red-500 text-red-700 dark:text-red-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}},S=r?k[c].outlined:k[c].solid,E=x?"animate-fade-out motion-reduce:opacity-0 motion-reduce:transition-opacity":"animate-fade-in motion-reduce:animate-none";return e.jsx("div",{id:t,className:`${g}`,children:e.jsxs("div",{className:`flex p-4 mb-4 border-l-4 rounded-md ${S} ${E} transition-all duration-300 motion-reduce:transition-none ${v}`,role:"alert","aria-live":"polite",children:[e.jsxs("div",{className:"flex items-start",children:[y&&e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("div",{className:"transition-transform duration-200 ease-in-out motion-reduce:transform-none",children:k[c].icon})}),e.jsxs("div",{className:"flex-1",children:[i&&e.jsx("h3",{className:"text-sm font-medium mb-1",children:i}),e.jsx("div",{className:"text-sm",children:n}),l&&e.jsx("div",{className:"mt-3",children:l})]})]}),u&&e.jsxs("button",{type:"button",className:"ml-auto -mx-1.5 -my-1.5 rounded-lg p-1.5 inline-flex h-8 w-8 focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 motion-reduce:transition-none",onClick:T,"aria-label":"Close",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{"aria-hidden":"true",className:"w-5 h-5 transform transition-transform duration-200 hover:scale-110 motion-reduce:transform-none",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})},Se=()=>{var I;const[c,i]=b.useState(""),[n,y]=b.useState(null),[u,h]=b.useState(null),[v,g]=b.useState(!1),[r,t]=b.useState(null),[l,o]=b.useState(""),[a,x]=b.useState(null),[C,T]=b.useState("table");b.useEffect(()=>{if(!c){y(null),h(null),x(null);return}try{const j=c.split(".");if(j.length!==3)throw new Error("Invalid JWT format. Expected three parts separated by dots.");const D={header:JSON.parse(atob(j[0].replace(/-/g,"+").replace(/_/g,"/"))),payload:JSON.parse(atob(j[1].replace(/-/g,"+").replace(/_/g,"/"))),signature:j[2],raw:{header:j[0],payload:j[1],signature:j[2]}};y(D),h(null),x(null)}catch(j){h(j instanceof Error?j.message:"Failed to decode JWT"),y(null),x(null)}},[c]),b.useEffect(()=>{if(v){const j=setTimeout(()=>{g(!1),t(null)},2e3);return()=>clearTimeout(j)}},[v]);const k=(j,D)=>{navigator.clipboard.writeText(j),g(!0),t(D)},S=()=>{i(""),y(null),h(null),o(""),x(null)},E=()=>{i("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMiwiZXhwIjoxNTE2MjM5MDIyfQ.sQGRWSev5kAPlYYkQgA1voON4tZdotVJO0xsJCRrCOw")},R=()=>{!n||!l||x(l.length>10)},w=j=>{try{return new Date(j*1e3).toLocaleString()}catch{return"Invalid date"}},N=j=>Date.now()>j*1e3,s=j=>{switch(j){case"sub":return"Subject (user) identifier";case"iss":return"Issuer of the token";case"aud":return"Audience the token is intended for";case"exp":return"Expiration time (when token becomes invalid)";case"nbf":return"Not before time (when token starts being valid)";case"iat":return"Issued at time (when token was issued)";case"jti":return"JWT ID (unique identifier for this token)";case"name":return"User name";case"given_name":return"User first name";case"family_name":return"User last name";case"email":return"User email address";case"roles":return"User roles/permissions";case"scope":return"OAuth 2.0 scopes";case"sid":return"Session ID";case"auth_time":return"Time when authentication occurred";default:return"Custom claim"}},d=j=>{switch(j){case"header":return"text-blue-600 dark:text-blue-400";case"payload":return"text-purple-600 dark:text-purple-400";case"signature":return"text-red-600 dark:text-red-400";default:return"text-gray-600"}},m="JWT Decoder | MyDebugger",f="Decode and verify JSON Web Tokens. Analyze headers, payload claims, and verify signatures securely in your browser.";return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx("title",{children:m}),e.jsx("meta",{name:"description",content:f}),e.jsx("meta",{property:"og:title",content:m}),e.jsx("meta",{property:"og:description",content:f}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:m}),e.jsx("meta",{name:"twitter:description",content:f}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JSON Web Token (JWT) Debugger"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Decode, verify, and analyze JSON Web Tokens (JWT) instantly. All processing happens in your browser."}),e.jsx("div",{className:"mb-6 bg-yellow-50 dark:bg-yellow-900/20 p-4 border border-yellow-200 dark:border-yellow-800 rounded-md",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),e.jsx("span",{className:"font-bold",children:"For your protection:"})," All JWT debugging and validation happens entirely in your browser. Your tokens and keys are never sent to any server."]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs(H,{isElevated:!0,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Encoded JWT"}),e.jsx(J,{onClick:E,variant:"light",size:"sm",children:"Generate example"})]}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[e.jsx("textarea",{id:"jwt-input",className:"w-full font-mono text-sm rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 flex-1 min-h-[300px]",value:c,onChange:j=>i(j.target.value),placeholder:"Paste your JWT token here...",autoFocus:!0,spellCheck:"false"}),u&&e.jsx(F,{type:"error",className:"mt-4",children:u}),n&&e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto break-all",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Header:"}),e.jsx("div",{className:`${d("header")} flex-1`,children:n.raw.header})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Payload:"}),e.jsx("div",{className:`${d("payload")} flex-1`,children:n.raw.payload})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row mt-2",children:[e.jsx("div",{className:"sm:w-20 text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-1 sm:mb-0",children:"Signature:"}),e.jsx("div",{className:`${d("signature")} flex-1`,children:n.raw.signature})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(J,{onClick:S,variant:"light",children:"Reset"})}),e.jsx("div",{children:e.jsx(J,{onClick:()=>k(c,"token"),variant:"primary",disabled:!c,children:v&&r==="token"?"Copied!":"Copy Token"})})]})]})]})}),e.jsx("div",{children:e.jsxs(H,{isElevated:!0,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Decoded Data"}),e.jsxs("div",{className:"flex border border-gray-200 dark:border-gray-700 rounded",children:[e.jsx("button",{className:`px-3 py-1 text-sm rounded-l ${C==="json"?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,onClick:()=>T("json"),children:"JSON"}),e.jsx("button",{className:`px-3 py-1 text-sm rounded-r ${C==="table"?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,onClick:()=>T("table"),children:"Table"})]})]}),e.jsx("div",{className:"p-4 flex-1 flex flex-col overflow-y-auto",children:n?e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:d("header"),children:"HEADER"}),e.jsx(J,{onClick:()=>k(JSON.stringify(n.header,null,2),"header"),variant:"light",size:"xs",className:"ml-2",children:v&&r==="header"?"Copied!":"Copy"})]}),C==="json"?e.jsx("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto mb-4 text-sm",children:JSON.stringify(n.header,null,2)}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(n.header).map(([j,D])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:j}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(ee,{content:j==="alg"?"Algorithm used to sign the token":j==="typ"?"Token type":`Header claim: ${j}`,children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:String(D)})})})]},j))})]})}),e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:d("payload"),children:"PAYLOAD"}),e.jsx(J,{onClick:()=>k(JSON.stringify(n.payload,null,2),"payload"),variant:"light",size:"xs",className:"ml-2",children:v&&r==="payload"?"Copied!":"Copy"})]}),C==="json"?e.jsx("pre",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto text-sm",children:JSON.stringify(n.payload,null,2)}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(n.payload).map(([j,D])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:j}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(ee,{content:s(j),children:e.jsx("span",{className:"cursor-help border-b border-dotted border-gray-400",children:j==="exp"||j==="iat"||j==="nbf"?e.jsxs("div",{children:[e.jsx("div",{children:String(D)}),e.jsxs("div",{className:`text-xs mt-1 ${j==="exp"&&N(D)?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:[w(D),j==="exp"&&e.jsx("span",{className:"ml-2",children:N(D)?e.jsx(M,{color:"danger",size:"sm",children:"Expired"}):e.jsx(M,{color:"success",size:"sm",children:"Valid"})})]})]}):typeof D=="boolean"?e.jsx("span",{className:D?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:String(D)}):String(D)})})})]},j))})]})})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2 flex items-center",children:[e.jsx("span",{className:d("signature"),children:"SIGNATURE"}),e.jsx(M,{color:a===!0?"success":a===!1?"danger":"light",className:"ml-2",children:a===!0?"Verified":a===!1?"Invalid":"Not verified"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md text-sm",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:["Signature algorithm: ",e.jsx("span",{className:"font-medium",children:n.header.alg||"HS256"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end",children:[e.jsxs("div",{className:"flex-grow mb-2 sm:mb-0 sm:mr-2",children:[e.jsx("label",{htmlFor:"secret-key",className:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Secret key"}),e.jsx("input",{id:"secret-key",type:"text",className:"w-full font-mono text-xs rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:l,onChange:j=>o(j.target.value),placeholder:(I=n.header.alg)!=null&&I.startsWith("HS")?"Enter your secret key...":"Enter your verification key..."})]}),e.jsx(J,{onClick:R,variant:"primary",size:"sm",disabled:!l,children:"Verify"})]}),a!==null&&e.jsx("div",{className:`mt-3 p-2 rounded-md text-sm ${a?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:a?"Signature verified successfully":"Invalid signature"})]})})]})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400 text-center p-6",children:e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:"Paste a JWT token on the left to decode it"}),e.jsx("div",{className:"text-sm",children:e.jsx(J,{onClick:E,variant:"light",size:"sm",children:"Or try an example token"})})]})})})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(H,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold",children:"About JWT"})}),e.jsxs("div",{className:"p-4 text-sm",children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:"JSON Web Tokens (JWTs) are an open, industry standard RFC 7519 method for representing claims securely between two parties."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${d("header")}`,children:"Header"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains metadata about the token's type and the signing algorithm."})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${d("payload")}`,children:"Payload"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contains the token claims - statements about the user and additional metadata."})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded-md",children:[e.jsx("h3",{className:`font-medium mb-1 ${d("signature")}`,children:"Signature"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Used to verify that the token wasn't changed along the way and came from an authentic source."})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-3",children:e.jsxs("a",{href:"https://jwt.io/introduction",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 inline-flex items-center",children:["Learn more about JWT",e.jsx("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})]})})]})]})},K=c=>btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),B=c=>{switch(c=c.replace(/-/g,"+").replace(/_/g,"/"),c.length%4){case 0:break;case 2:c+="==";break;case 3:c+="=";break;default:throw new Error("Invalid base64url string")}try{return decodeURIComponent(escape(atob(c)))}catch{return atob(c)}},te=async c=>{try{const i=c.split(".");if(i.length!==3)throw new Error("Invalid JWT format: expected 3 parts");const[n,y,u]=i;let h=null,v=null,g;try{const r=B(n);h=JSON.parse(r)}catch{g="Invalid JWT header: failed to parse"}try{const r=B(y);v=JSON.parse(r)}catch{g=g||"Invalid JWT payload: failed to parse"}return{header:h,payload:v,signature:u,isValid:!1,raw:{header:n,payload:y,signature:u},error:g}}catch(i){return{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:i instanceof Error?i.message:"Unknown error decoding token"}}},ne=(c,i=!1)=>{if(i){const n=atob(c),y=new Uint8Array(n.length);for(let u=0;u<n.length;u++)y[u]=n.charCodeAt(u);return y.buffer}else return new TextEncoder().encode(c).buffer},ie=async(c,i,n)=>{try{const y=c.split(".");if(y.length!==3)throw new Error("Invalid JWT format");const[u,h,v]=y,g=`${u}.${h}`;let r=n;if(!r)try{const k=B(u);r=JSON.parse(k).alg}catch{throw new Error("Failed to parse JWT header")}if(r==="none")return!1;const t=Uint8Array.from(atob(v.replace(/-/g,"+").replace(/_/g,"/")),k=>k.charCodeAt(0)),o=new TextEncoder().encode(g);let a,x=!1;switch(r){case"HS256":a={name:"HMAC",hash:"SHA-256"},x=!0;break;case"HS384":a={name:"HMAC",hash:"SHA-384"},x=!0;break;case"HS512":a={name:"HMAC",hash:"SHA-512"},x=!0;break;case"RS256":a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"ES256":a={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":a={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":a={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${r}`)}const C=ne(i,!1),T=await window.crypto.subtle.importKey(x?"raw":"spki",C,a,!1,["verify"]);return await window.crypto.subtle.verify(a,T,t,o)}catch(y){return console.error("JWT verification error:",y),!1}},Q=async(c,i,n)=>{try{const y={typ:"JWT",...c},u=y.alg;if(!u)throw new Error("Algorithm is required in header");const h=K(JSON.stringify(y)),v=K(JSON.stringify(i)),g=`${h}.${v}`;if(u==="none")return`${g}.`;let r,t=!1;switch(u){case"HS256":r={name:"HMAC",hash:"SHA-256"},t=!0;break;case"HS384":r={name:"HMAC",hash:"SHA-384"},t=!0;break;case"HS512":r={name:"HMAC",hash:"SHA-512"},t=!0;break;case"RS256":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":r={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"ES256":r={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":r={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":r={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${u}`)}const l=ne(n,!1),o=await window.crypto.subtle.importKey(t?"raw":u.startsWith("RS")?"pkcs8":"raw",l,r,!1,["sign"]),x=new TextEncoder().encode(g),C=await window.crypto.subtle.sign(r,o,x),T=new Uint8Array(C);let k="";for(let S=0;S<T.length;S++)k+=String.fromCharCode(T[S]);return k=K(k),`${g}.${k}`}catch(y){throw console.error("JWT signing error:",y),y}},le=async c=>{const y={sub:"1234567890",name:"John Doe",iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+3600,data:Array(1024).fill("a").join("")},u={alg:c,typ:"JWT"},h=Array(32).fill(0).map(()=>Math.floor(Math.random()*256).toString(16).padStart(2,"0")).join(""),v=performance.now();for(let t=0;t<100;t++)try{await Q(u,{...y,nonce:t},h)}catch(l){return console.error(`Error benchmarking algorithm ${c}:`,l),0}const r=performance.now()-v;return Math.floor(100/(r/1e3))},oe=Q,Te=ie,Ce=te,de=le,re=Object.freeze(Object.defineProperty({__proto__:null,base64UrlDecode:B,base64UrlEncode:K,bench:de,benchmarkAlgorithm:le,decode:Ce,decodeSafely:te,sign:oe,signToken:Q,verify:Te,verifyToken:ie},Symbol.toStringTag,{value:"Module"})),Ee=()=>{const[c,i]=b.useState("header"),[n,y]=b.useState("HS256"),[u,h]=b.useState(""),[v,g]=b.useState("JWT"),[r,t]=b.useState([{name:"sub",value:"1234567890",type:"string"},{name:"name",value:"John Doe",type:"string"},{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}]),[l,o]=b.useState(""),[a,x]=b.useState(""),[C,T]=b.useState("string"),[k,S]=b.useState("your-256-bit-secret"),[E,R]=b.useState(""),[w,N]=b.useState(0),[s,d]=b.useState(!1),[m,f]=b.useState(null),[I,j]=b.useState(!1);b.useEffect(()=>{if(I){const p=setTimeout(()=>j(!1),2e3);return()=>clearTimeout(p)}},[I]),b.useEffect(()=>{D()},[n,u,v,r]);const D=async()=>{try{const p={alg:n,typ:v};u&&(p.kid=u);const A={};for(const W of r)try{switch(W.type){case"string":A[W.name]=W.value;break;case"number":A[W.name]=Number(W.value);break;case"boolean":A[W.name]=W.value.toLowerCase()==="true";break;case"json":A[W.name]=JSON.parse(W.value);break}}catch{A[W.name]=W.value}const _=K(JSON.stringify(p)),O=K(JSON.stringify(A)),Y=`${_}.${O}.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`;R(Y),N(new TextEncoder().encode(Y).length)}catch(p){console.error("Error generating token preview:",p)}},xe=()=>{!l||!l.trim()||(t([...r,{name:l.trim(),value:a,type:C}]),o(""),x(""))},ue=p=>{const A=[...r];A.splice(p,1),t(A)},V=(p,A,_)=>{const O=[...r];O[p][A]=_,t(O)},ge=async()=>{d(!0),f(null);try{const p={alg:n,typ:v};u&&(p.kid=u);const A={};for(const O of r)try{switch(O.type){case"string":A[O.name]=O.value;break;case"number":A[O.name]=Number(O.value);break;case"boolean":A[O.name]=O.value.toLowerCase()==="true";break;case"json":A[O.name]=JSON.parse(O.value);break}}catch{A[O.name]=O.value}const _=await oe(p,A,k);R(_),N(new TextEncoder().encode(_).length)}catch(p){f(`Error signing token: ${p instanceof Error?p.message:String(p)}`)}d(!1)},pe=()=>{navigator.clipboard.writeText(E),j(!0)},ye=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Algorithm (alg)"}),e.jsxs("select",{value:n,onChange:p=>y(p.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[e.jsxs("optgroup",{label:"HMAC",children:[e.jsx("option",{value:"HS256",children:"HS256 (HMAC + SHA256)"}),e.jsx("option",{value:"HS384",children:"HS384 (HMAC + SHA384)"}),e.jsx("option",{value:"HS512",children:"HS512 (HMAC + SHA512)"})]}),e.jsxs("optgroup",{label:"RSA",children:[e.jsx("option",{value:"RS256",children:"RS256 (RSA + SHA256)"}),e.jsx("option",{value:"RS384",children:"RS384 (RSA + SHA384)"}),e.jsx("option",{value:"RS512",children:"RS512 (RSA + SHA512)"})]}),e.jsxs("optgroup",{label:"ECDSA",children:[e.jsx("option",{value:"ES256",children:"ES256 (ECDSA + SHA256)"}),e.jsx("option",{value:"ES384",children:"ES384 (ECDSA + SHA384)"}),e.jsx("option",{value:"ES512",children:"ES512 (ECDSA + SHA512)"})]}),e.jsx("optgroup",{label:"Unsafe",children:e.jsx("option",{value:"none",children:"none (Unsigned Token)"})})]}),n==="none"&&e.jsx("div",{className:"mt-2 text-red-600 dark:text-red-400 text-sm",children:'Warning: The "none" algorithm creates unsigned tokens which provide no security.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Token Type (typ)"}),e.jsx(z,{value:v,onChange:p=>g(p.target.value),placeholder:"JWT"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:'Usually "JWT" for JSON Web Token'})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Key ID (kid)"}),e.jsx(z,{value:u,onChange:p=>h(p.target.value),placeholder:"Optional Key ID"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Optional identifier for the key used to sign this token"})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("div",{}),e.jsx(J,{variant:"primary",onClick:()=>i("payload"),children:"Continue to Payload"})]})]}),fe=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Current Claims"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Type"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Action"})]})}),e.jsx("tbody",{children:r.map((p,A)=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3",children:e.jsx(z,{value:p.name,onChange:_=>V(A,"name",_.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3",children:e.jsxs("select",{value:p.type,onChange:_=>V(A,"type",_.target.value),className:"p-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(z,{value:p.value,onChange:_=>V(A,"value",_.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsx(J,{variant:"light",size:"sm",onClick:()=>ue(A),children:"Remove"})})]},A))})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Add Claim"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),e.jsx(z,{value:l,onChange:p=>o(p.target.value),placeholder:"Claim name",size:"sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),e.jsxs("select",{value:C,onChange:p=>T(p.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Value"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:a,onChange:p=>x(p.target.value),placeholder:"Value",size:"sm",className:"flex-grow"}),e.jsx(J,{variant:"primary",size:"sm",className:"ml-2",onClick:xe,children:"Add"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-1",children:"Common Claims"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(J,{variant:"light",size:"sm",onClick:()=>{r.some(p=>p.name==="exp")||t([...r,{name:"exp",value:String(Math.floor(Date.now()/1e3)+3600),type:"number"}])},children:"Add exp (Expiry)"}),e.jsx(J,{variant:"light",size:"sm",onClick:()=>{r.some(p=>p.name==="iat")||t([...r,{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add iat (Issued At)"}),e.jsx(J,{variant:"light",size:"sm",onClick:()=>{r.some(p=>p.name==="nbf")||t([...r,{name:"nbf",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add nbf (Not Before)"}),e.jsx(J,{variant:"light",size:"sm",onClick:()=>{r.some(p=>p.name==="iss")||t([...r,{name:"iss",value:"https://example.com",type:"string"}])},children:"Add iss (Issuer)"}),e.jsx(J,{variant:"light",size:"sm",onClick:()=>{r.some(p=>p.name==="aud")||t([...r,{name:"aud",value:"client-id",type:"string"}])},children:"Add aud (Audience)"}),e.jsx(J,{variant:"light",size:"sm",onClick:()=>{r.some(p=>p.name==="jti")||t([...r,{name:"jti",value:crypto.randomUUID(),type:"string"}])},children:"Add jti (JWT ID)"})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx(J,{variant:"light",onClick:()=>i("header"),children:"Back to Header"}),e.jsx(J,{variant:"primary",onClick:()=>i("signature"),children:"Continue to Signature"})]})]}),be=()=>{let p="Secret Key",A="Enter the secret key for HMAC signing";return n.startsWith("RS")?(p="Private Key (PKCS#8)",A="Enter the PEM-formatted RSA private key"):n.startsWith("ES")?(p="Private Key (PKCS#8)",A="Enter the PEM-formatted EC private key"):n==="none"&&(p="No Key Required",A="The 'none' algorithm does not use a key"),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-blue-800 dark:text-blue-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"â„¹ï¸"}),"You're creating a token with algorithm ",e.jsx("strong",{children:n})," and ",r.length," claims.",n==="none"&&e.jsx("span",{className:"text-red-600 dark:text-red-400 ml-1",children:" (Unsigned Token - Not secure)"})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:p}),e.jsx("textarea",{value:k,onChange:_=>S(_.target.value),placeholder:n==="none"?'No key needed for "none" algorithm':"Enter key here...",disabled:n==="none",className:"w-full font-mono h-32 p-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 dark:text-gray-200"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:A})]}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{variant:"primary",className:"w-full",onClick:ge,disabled:s||n!=="none"&&!k,children:s?"Signing...":"Sign Token"})}),m&&e.jsx("div",{className:"mt-4 bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-red-800 dark:text-red-300 text-sm",children:m})}),e.jsx("div",{className:"mt-6 flex justify-between",children:e.jsx(J,{variant:"light",onClick:()=>i("payload"),children:"Back to Payload"})})]})};return e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"mb-6",children:e.jsxs(Z,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(P,{id:"header-tab",isActive:c==="header",onClick:()=>i("header"),children:"1. Header"}),e.jsx(P,{id:"payload-tab",isActive:c==="payload",onClick:()=>i("payload"),children:"2. Payload"}),e.jsx(P,{id:"signature-tab",isActive:c==="signature",onClick:()=>i("signature"),children:"3. Signature"})]}),c==="header"&&ye(),c==="payload"&&fe(),c==="signature"&&be()]})}),e.jsxs(H,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Generated Token"}),e.jsxs(M,{color:"info",children:["Size: ",w," bytes"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto whitespace-nowrap",children:E||"Your token will appear here..."}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(J,{onClick:pe,variant:"primary",disabled:!E,children:I?"Copied!":"Copy Token"})})]})]})]})};var X={exports:{}};X.exports;(function(c){var i=function(){var n=String.fromCharCode,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",h={};function v(r,t){if(!h[r]){h[r]={};for(var l=0;l<r.length;l++)h[r][r.charAt(l)]=l}return h[r][t]}var g={compressToBase64:function(r){if(r==null)return"";var t=g._compress(r,6,function(l){return y.charAt(l)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(r){return r==null?"":r==""?null:g._decompress(r.length,32,function(t){return v(y,r.charAt(t))})},compressToUTF16:function(r){return r==null?"":g._compress(r,15,function(t){return n(t+32)})+" "},decompressFromUTF16:function(r){return r==null?"":r==""?null:g._decompress(r.length,16384,function(t){return r.charCodeAt(t)-32})},compressToUint8Array:function(r){for(var t=g.compress(r),l=new Uint8Array(t.length*2),o=0,a=t.length;o<a;o++){var x=t.charCodeAt(o);l[o*2]=x>>>8,l[o*2+1]=x%256}return l},decompressFromUint8Array:function(r){if(r==null)return g.decompress(r);for(var t=new Array(r.length/2),l=0,o=t.length;l<o;l++)t[l]=r[l*2]*256+r[l*2+1];var a=[];return t.forEach(function(x){a.push(n(x))}),g.decompress(a.join(""))},compressToEncodedURIComponent:function(r){return r==null?"":g._compress(r,6,function(t){return u.charAt(t)})},decompressFromEncodedURIComponent:function(r){return r==null?"":r==""?null:(r=r.replace(/ /g,"+"),g._decompress(r.length,32,function(t){return v(u,r.charAt(t))}))},compress:function(r){return g._compress(r,16,function(t){return n(t)})},_compress:function(r,t,l){if(r==null)return"";var o,a,x={},C={},T="",k="",S="",E=2,R=3,w=2,N=[],s=0,d=0,m;for(m=0;m<r.length;m+=1)if(T=r.charAt(m),Object.prototype.hasOwnProperty.call(x,T)||(x[T]=R++,C[T]=!0),k=S+T,Object.prototype.hasOwnProperty.call(x,k))S=k;else{if(Object.prototype.hasOwnProperty.call(C,S)){if(S.charCodeAt(0)<256){for(o=0;o<w;o++)s=s<<1,d==t-1?(d=0,N.push(l(s)),s=0):d++;for(a=S.charCodeAt(0),o=0;o<8;o++)s=s<<1|a&1,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=a>>1}else{for(a=1,o=0;o<w;o++)s=s<<1|a,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=0;for(a=S.charCodeAt(0),o=0;o<16;o++)s=s<<1|a&1,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=a>>1}E--,E==0&&(E=Math.pow(2,w),w++),delete C[S]}else for(a=x[S],o=0;o<w;o++)s=s<<1|a&1,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=a>>1;E--,E==0&&(E=Math.pow(2,w),w++),x[k]=R++,S=String(T)}if(S!==""){if(Object.prototype.hasOwnProperty.call(C,S)){if(S.charCodeAt(0)<256){for(o=0;o<w;o++)s=s<<1,d==t-1?(d=0,N.push(l(s)),s=0):d++;for(a=S.charCodeAt(0),o=0;o<8;o++)s=s<<1|a&1,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=a>>1}else{for(a=1,o=0;o<w;o++)s=s<<1|a,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=0;for(a=S.charCodeAt(0),o=0;o<16;o++)s=s<<1|a&1,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=a>>1}E--,E==0&&(E=Math.pow(2,w),w++),delete C[S]}else for(a=x[S],o=0;o<w;o++)s=s<<1|a&1,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=a>>1;E--,E==0&&(E=Math.pow(2,w),w++)}for(a=2,o=0;o<w;o++)s=s<<1|a&1,d==t-1?(d=0,N.push(l(s)),s=0):d++,a=a>>1;for(;;)if(s=s<<1,d==t-1){N.push(l(s));break}else d++;return N.join("")},decompress:function(r){return r==null?"":r==""?null:g._decompress(r.length,32768,function(t){return r.charCodeAt(t)})},_decompress:function(r,t,l){var o=[],a=4,x=4,C=3,T="",k=[],S,E,R,w,N,s,d,m={val:l(0),position:t,index:1};for(S=0;S<3;S+=1)o[S]=S;for(R=0,N=Math.pow(2,2),s=1;s!=N;)w=m.val&m.position,m.position>>=1,m.position==0&&(m.position=t,m.val=l(m.index++)),R|=(w>0?1:0)*s,s<<=1;switch(R){case 0:for(R=0,N=Math.pow(2,8),s=1;s!=N;)w=m.val&m.position,m.position>>=1,m.position==0&&(m.position=t,m.val=l(m.index++)),R|=(w>0?1:0)*s,s<<=1;d=n(R);break;case 1:for(R=0,N=Math.pow(2,16),s=1;s!=N;)w=m.val&m.position,m.position>>=1,m.position==0&&(m.position=t,m.val=l(m.index++)),R|=(w>0?1:0)*s,s<<=1;d=n(R);break;case 2:return""}for(o[3]=d,E=d,k.push(d);;){if(m.index>r)return"";for(R=0,N=Math.pow(2,C),s=1;s!=N;)w=m.val&m.position,m.position>>=1,m.position==0&&(m.position=t,m.val=l(m.index++)),R|=(w>0?1:0)*s,s<<=1;switch(d=R){case 0:for(R=0,N=Math.pow(2,8),s=1;s!=N;)w=m.val&m.position,m.position>>=1,m.position==0&&(m.position=t,m.val=l(m.index++)),R|=(w>0?1:0)*s,s<<=1;o[x++]=n(R),d=x-1,a--;break;case 1:for(R=0,N=Math.pow(2,16),s=1;s!=N;)w=m.val&m.position,m.position>>=1,m.position==0&&(m.position=t,m.val=l(m.index++)),R|=(w>0?1:0)*s,s<<=1;o[x++]=n(R),d=x-1,a--;break;case 2:return k.join("")}if(a==0&&(a=Math.pow(2,C),C++),o[d])T=o[d];else if(d===x)T=E+E.charAt(0);else return null;k.push(T),o[x++]=E+T.charAt(0),a--,E=T,a==0&&(a=Math.pow(2,C),C++)}}};return g}();c!=null?c.exports=i:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return i})})(X);var se=X.exports;const ce={token:"",decoded:null,isVerified:null,verificationKey:"",error:null,history:[],securityIssues:[]};function Ae(c,i){switch(i.type){case"SET_TOKEN":return{...c,token:i.payload};case"SET_DECODED":return{...c,decoded:i.payload};case"SET_VERIFIED":return{...c,isVerified:i.payload};case"SET_VERIFICATION_KEY":return{...c,verificationKey:i.payload};case"SET_ERROR":return{...c,error:i.payload};case"ADD_HISTORY_ITEM":return{...c,history:[i.payload,...c.history.filter(n=>n.id!==i.payload.id)].slice(0,10)};case"CLEAR_HISTORY":return{...c,history:[]};case"REMOVE_HISTORY_ITEM":return{...c,history:c.history.filter(n=>n.id!==i.payload)};case"SET_SECURITY_ISSUES":return{...c,securityIssues:i.payload};case"RESET":return ce;default:return c}}const me=b.createContext(void 0),Re=({children:c})=>{const[i,n]=b.useReducer(Ae,ce);U.useEffect(()=>{g()},[]),U.useEffect(()=>{try{localStorage.setItem("jwt.history",JSON.stringify(i.history))}catch(r){console.error("Failed to save JWT history:",r)}},[i.history]),U.useEffect(()=>{try{const r=localStorage.getItem("jwt.history");r&&JSON.parse(r).forEach(l=>{n({type:"ADD_HISTORY_ITEM",payload:l})})}catch(r){console.error("Failed to load JWT history:",r)}},[]);const y=async r=>{var t,l;if(!r){n({type:"SET_DECODED",payload:null}),n({type:"SET_ERROR",payload:null}),n({type:"SET_VERIFIED",payload:null});return}try{const a=await(await q(()=>Promise.resolve().then(()=>re),void 0)).decode(r);if(a.header&&a.payload&&a.signature){const x={header:a.header,payload:a.payload,signature:a.signature,raw:a.raw};n({type:"SET_TOKEN",payload:r}),n({type:"SET_DECODED",payload:x}),n({type:"SET_ERROR",payload:null}),n({type:"SET_VERIFIED",payload:null});const C=((t=a.payload)==null?void 0:t.sub)||((l=a.payload)==null?void 0:l.name)||`Token ${new Date().toLocaleDateString()}`;n({type:"ADD_HISTORY_ITEM",payload:{id:Math.random().toString(36).substring(2,9),token:r,timestamp:Date.now(),label:C}}),h(r)}else throw new Error("Failed to decode JWT: Invalid token structure")}catch(o){n({type:"SET_ERROR",payload:o instanceof Error?o.message:"Failed to decode JWT"}),n({type:"SET_DECODED",payload:null}),n({type:"SET_VERIFIED",payload:null})}},u=async(r,t)=>{if(!(!i.decoded||!t))try{const o=await(await q(()=>Promise.resolve().then(()=>re),void 0)).verify(i.token,t,r||i.decoded.header.alg);n({type:"SET_VERIFICATION_KEY",payload:t}),n({type:"SET_VERIFIED",payload:o})}catch(l){n({type:"SET_ERROR",payload:l instanceof Error?l.message:"Failed to verify signature"}),n({type:"SET_VERIFIED",payload:!1})}},h=r=>{if(!i.decoded)return;const t=[];if(i.decoded.header.alg==="none"&&t.push({id:"alg-none",severity:"high",title:"UNSIGNED TOKEN",description:'The token uses algorithm "none" and has no signature. Do not accept in production.'}),i.decoded.payload.exp){const l=i.decoded.payload.exp*1e3;Date.now()>l&&t.push({id:"token-expired",severity:"medium",title:"Token Expired",description:`Token expired on ${new Date(l).toLocaleString()}.`});const o=24*60*60*1e3;l-Date.now()<o&&Date.now()<l&&t.push({id:"token-expiring",severity:"low",title:"Token Expiring Soon",description:`Token will expire on ${new Date(l).toLocaleString()}.`})}else t.push({id:"no-expiration",severity:"medium",title:"No Expiration Time",description:"This token has no expiration time (exp claim), which is not recommended."});i.decoded.header.alg&&["HS256","RS256","ES256"].indexOf(i.decoded.header.alg)===-1&&t.push({id:"weak-algorithm",severity:"info",title:"Algorithm Consideration",description:`Algorithm ${i.decoded.header.alg} is used. Consider using HS256, RS256, or ES256.`}),n({type:"SET_SECURITY_ISSUES",payload:t})},v=()=>{if(!i.token)return window.location.href.split("#")[0];const r=se.compressToEncodedURIComponent(i.token);return`${window.location.href.split("#")[0]}#${r}`},g=async()=>{const r=window.location.hash.substring(1);if(r)try{const t=se.decompressFromEncodedURIComponent(r);if(t)return await y(t),!0}catch(t){console.error("Failed to load token from URL hash:",t)}return!1};return e.jsx(me.Provider,{value:{state:i,dispatch:n,decodeToken:y,verifySignature:u,analyzeToken:h,shareToken:v,loadFromHash:g},children:c})},he=()=>{const c=b.useContext(me);if(c===void 0)throw new Error("useJwt must be used within a JwtProvider");return c},Je=()=>{const{state:c,dispatch:i,decodeToken:n,verifySignature:y}=he(),{token:u,decoded:h,isVerified:v,error:g,securityIssues:r}=c,[t,l]=b.useState(""),[o,a]=b.useState("json"),[x,C]=b.useState(!1);b.useState(!1),b.useEffect(()=>{if(x){const f=setTimeout(()=>C(!1),2e3);return()=>clearTimeout(f)}},[x]);const T=f=>{const I=f.target.value.trim();I!==u&&n(I)},k=()=>{n("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNjE2MjM5MDIyLCJleHAiOjE5MTYyMzkwMjIsInJvbGUiOiJhZG1pbiJ9.8TT2jkQV3a9lQfNSJz7USP9vgKzlhWPMnDxCQfFgj3w")},S=()=>{i({type:"RESET"}),l("")},E=f=>{navigator.clipboard.writeText(f),C(!0)},R=()=>{!h||!t||y(h.header.alg,t)},w=f=>{try{return new Date(f*1e3).toLocaleString()}catch{return"Invalid date"}},N=f=>Date.now()>f*1e3,s=f=>{switch(f){case"high":return"error";case"medium":return"warning";case"low":return"info";default:return"neutral"}},d=f=>{switch(f){case"high":return"âš ï¸";case"medium":return"âš ";case"low":return"â„¹ï¸";default:return"â„¹ï¸"}},m=()=>r.length===0?null:e.jsx("div",{className:"mb-4",children:r.map(f=>e.jsx(F,{type:s(f.severity),className:"mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:d(f.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:f.title}),e.jsx("div",{className:"text-sm",children:f.description})]})]})},f.id))});return e.jsxs(e.Fragment,{children:[e.jsxs(H,{className:"mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"JWT Token"}),e.jsx(J,{onClick:k,size:"sm",variant:"light",children:"Generate Demo"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"All JWT processing happens locally in your browser. Your tokens are never sent to a server."]})}),e.jsx("textarea",{className:"w-full font-mono text-sm p-3 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 h-28 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:u,onChange:T,placeholder:"Paste your JWT token here...",spellCheck:"false"}),g&&e.jsx(F,{type:"error",className:"mt-4",children:g}),h&&e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto whitespace-nowrap",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:h.raw.header}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"."}),e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:h.raw.payload}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"."}),e.jsx("span",{className:"text-red-500 dark:text-red-400",children:h.raw.signature})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(J,{onClick:S,variant:"light",children:"Reset"})}),e.jsx(J,{onClick:()=>E(u),variant:"primary",children:x?"Copied!":"Copy Token"})]})]})]}),m(),h&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(H,{children:e.jsxs(Z,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(P,{id:"tab-json",isActive:o==="json",onClick:()=>a("json"),children:"JSON"}),e.jsx(P,{id:"tab-claims",isActive:o==="claims",onClick:()=>a("claims"),children:"Claims Table"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"HEADER"}),e.jsx(L,{id:"panel-json-header",isActive:o==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(h.header,null,2)})})}),e.jsx(L,{id:"panel-claims-header",isActive:o==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(h.header).map(([f,I])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:f}),e.jsx("td",{className:"py-2 px-3",children:String(I)})]},f))})]})})}),e.jsx("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mt-6 mb-2",children:"PAYLOAD"}),e.jsx(L,{id:"panel-json-payload",isActive:o==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(h.payload,null,2)})})}),e.jsx(L,{id:"panel-claims-payload",isActive:o==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(h.payload).map(([f,I])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:f}),e.jsx("td",{className:"py-2 px-3",children:f==="exp"||f==="iat"||f==="nbf"?`${String(I)} (${w(I)})`:String(I)})]},f))})]})})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(J,{onClick:()=>E(JSON.stringify({header:h.header,payload:h.payload},null,2)),variant:"primary",children:x?"Copied!":"Copy JSON"})})]})]})})}),e.jsxs("div",{children:[e.jsxs(H,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Signature Verification"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Verify the signature using your secret key. Algorithm: ",h.header.alg||"unknown"]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"secret-key",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secret/Public Key"}),e.jsx(z,{id:"secret-key",value:t,onChange:f=>l(f.target.value),placeholder:"Enter secret key or paste public key...",className:"font-mono"})]}),e.jsx(J,{onClick:R,variant:"primary",className:"w-full mt-3",disabled:!t,children:"Verify Signature"}),v!==null&&e.jsx("div",{className:`mt-4 p-3 rounded-md ${v?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:v?"âœ…":"âŒ"}),e.jsx("span",{className:"font-medium",children:v?"Signature Verified":"Invalid Signature"})]})})]})]}),h.payload.exp&&e.jsxs(H,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Token Status"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:`p-3 rounded-md ${N(h.payload.exp)?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"}`,children:[e.jsx("div",{className:"font-medium",children:N(h.payload.exp)?"ðŸ•’ Expired":"âœ… Valid"}),e.jsx("div",{className:"text-sm mt-1",children:w(h.payload.exp)})]}),h.payload.iat&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issued at:"}),e.jsx("div",{className:"text-sm",children:w(h.payload.iat)})]})]})]})]})]})})]})},Ie=()=>{var N;const{state:c}=he(),{decoded:i}=c,[n,y]=b.useState(""),[u,h]=b.useState("jwks"),[v,g]=b.useState(!1),[r,t]=b.useState([]),[l,o]=b.useState(null),[a,x]=b.useState(null),[C,T]=b.useState(null);b.useEffect(()=>{var s;if((s=i==null?void 0:i.payload)!=null&&s.iss&&!n){const d=i.payload.iss;d.endsWith("/")?y(`${d}.well-known/openid-configuration`):y(`${d}/.well-known/openid-configuration`),h("oidc")}},[i]),b.useEffect(()=>{var s;if((s=i==null?void 0:i.header)!=null&&s.kid&&r.length>0){const d=i.header.kid,m=r.find(f=>f.kid===d);T(m||null)}else T(null)},[i,r]);const k=async()=>{if(n){g(!0),x(null),t([]),o(null);try{const s=await fetch(n);if(!s.ok)throw new Error(`HTTP error: ${s.status} ${s.statusText}`);const d=await s.json();try{sessionStorage.setItem(`jwks_${n}`,JSON.stringify(d))}catch(m){console.warn("Failed to cache JWKS in sessionStorage:",m)}if(d.keys)t(d.keys);else throw new Error("No keys found in the JWKS response")}catch(s){x(`Failed to fetch JWKS: ${s instanceof Error?s.message:String(s)}`)}finally{g(!1)}}},S=async()=>{if(n){g(!0),x(null),t([]),o(null);try{const s=await fetch(n);if(!s.ok)throw new Error(`HTTP error: ${s.status} ${s.statusText}`);const d=await s.json();o(d);try{sessionStorage.setItem(`oidc_${n}`,JSON.stringify(d))}catch(I){console.warn("Failed to cache OIDC config in sessionStorage:",I)}if(!d.jwks_uri)throw new Error("No JWKS URI found in the OIDC configuration");const m=await fetch(d.jwks_uri);if(!m.ok)throw new Error(`HTTP error fetching JWKS: ${m.status} ${m.statusText}`);const f=await m.json();try{sessionStorage.setItem(`jwks_${d.jwks_uri}`,JSON.stringify(f))}catch(I){console.warn("Failed to cache JWKS in sessionStorage:",I)}if(f.keys)t(f.keys);else throw new Error("No keys found in the JWKS response")}catch(s){x(`Failed to fetch OIDC configuration or JWKS: ${s instanceof Error?s.message:String(s)}`)}finally{g(!1)}}},E=()=>{u==="jwks"?k():S()},R=()=>{y(u==="jwks"?"https://www.googleapis.com/oauth2/v3/certs":"https://accounts.google.com/.well-known/openid-configuration")},w=(s,d)=>{var f;const m=((f=i==null?void 0:i.header)==null?void 0:f.kid)&&s.kid===i.header.kid;return e.jsxs(H,{className:`mb-4 ${m?"border-green-500 dark:border-green-500":""}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("h4",{className:"font-semibold flex items-center",children:[m&&e.jsx("span",{className:"mr-2 text-green-500",children:"âœ“ "}),"Key ",s.kid?`ID: ${s.kid}`:d+1]}),e.jsxs("div",{className:"flex gap-2",children:[s.alg&&e.jsx(M,{color:"primary",children:s.alg}),e.jsx(M,{color:"info",children:s.kty}),s.use&&e.jsx(M,{color:"success",children:s.use})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",s.kty]}),s.alg&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Algorithm:"})," ",s.alg]}),s.use&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Use:"})," ",s.use]}),s.key_ops&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Operations:"})," ",s.key_ops.join(", ")]}),s.kty==="RSA"&&s.n&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Modulus (n):"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:s.n})]}),s.kty==="RSA"&&s.e&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Exponent (e):"})," ",s.e]}),s.kty==="EC"&&e.jsxs(e.Fragment,{children:[s.crv&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Curve:"})," ",s.crv]}),s.x&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"X:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:s.x})]}),s.y&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Y:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:s.y})]})]})]})]},s.kid||d)};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"JWKS Probe"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"URL Type"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"jwks",checked:u==="jwks",onChange:()=>h("jwks"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"JWKS Endpoint"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"oidc",checked:u==="oidc",onChange:()=>h("oidc"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"OIDC Discovery"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"jwks-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:u==="jwks"?"JWKS URL":"OIDC Discovery URL"}),e.jsxs("div",{className:"flex",children:[e.jsx(z,{id:"jwks-url",value:n,onChange:s=>y(s.target.value),placeholder:u==="jwks"?"https://example.com/.well-known/jwks.json":"https://example.com/.well-known/openid-configuration",className:"flex-grow"}),e.jsx(J,{onClick:R,variant:"light",className:"ml-2",children:"Sample"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:u==="jwks"?"Direct URL to a JWKS endpoint containing public keys":"URL to an OpenID Connect discovery document"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(J,{onClick:E,variant:"primary",disabled:!n||v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:"sm",className:"mr-2"}),"Fetching..."]}):"Fetch Keys"})})]})]}),a&&e.jsx(F,{type:"error",className:"mb-6",children:a}),l&&e.jsxs(H,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"OIDC Configuration"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.issuer&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Issuer:"})," ",l.issuer]}),l.jwks_uri&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"JWKS URI:"})," ",l.jwks_uri]}),l.token_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Token Endpoint:"})," ",l.token_endpoint]}),l.authorization_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Authorization Endpoint:"})," ",l.authorization_endpoint]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{variant:"light",onClick:()=>{const s=JSON.stringify(l,null,2);navigator.clipboard.writeText(s)},children:"Copy Full Config"})})]})]}),r.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Keys Found (",r.length,")"]}),C&&((N=i==null?void 0:i.header)==null?void 0:N.kid)&&e.jsxs(M,{color:"success",children:["Found matching key for KID: ",i.header.kid]})]}),r.map((s,d)=>w(s,d))]})]})},De=({onRun:c})=>{const[i,n]=b.useState([]),[y,u]=b.useState(!1),[h,v]=b.useState(null),g=[{name:"HS256",category:"sign"},{name:"HS384",category:"sign"},{name:"HS512",category:"sign"},{name:"RS256",category:"sign"},{name:"RS384",category:"sign"},{name:"RS512",category:"sign"},{name:"ES256",category:"sign"},{name:"ES384",category:"sign"},{name:"ES512",category:"sign"}],r=async()=>{u(!0),v(null),n([]);try{const a=[],x={alg:"none",typ:"JWT"},C={sub:"1234567890",name:"John Doe",iat:1516239022};for(const T of g){try{const k=await de(T.name);a.push({algorithm:T.name,opsPerSecond:k,category:T.category})}catch(k){a.push({algorithm:T.name,opsPerSecond:0,error:k instanceof Error?k.message:String(k),category:T.category})}n([...a])}}catch(a){v(`Benchmark error: ${a instanceof Error?a.message:String(a)}`)}finally{u(!1)}c&&c()},t=Math.max(...i.map(a=>a.opsPerSecond),100),l=i.filter(a=>a.category==="sign"),o=i.filter(a=>a.category==="verify");return e.jsxs(H,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"JWT Algorithm Benchmark"}),e.jsx(J,{variant:"primary",onClick:r,disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:"sm",className:"mr-2"}),"Running..."]}):"Run Benchmark"})]}),e.jsxs("div",{className:"p-4",children:[h&&e.jsx("div",{className:"p-3 mb-4 bg-red-50 dark:bg-red-900/20 rounded-md border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-red-800 dark:text-red-300 text-sm",children:h})}),y&&!i.length&&e.jsxs("div",{className:"py-12 flex flex-col items-center justify-center text-gray-500 dark:text-gray-400",children:[e.jsx(G,{size:"lg",className:"mb-4"}),e.jsx("p",{children:"Initializing benchmark tests..."}),e.jsx("p",{className:"text-sm mt-1",children:"This may take a few moments"})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"mb-4 text-sm text-gray-500 dark:text-gray-400",children:"Results show operations per second. Higher is better. Tests run in this browser."}),e.jsx("h4",{className:"font-semibold mb-2",children:"Signing Performance"}),e.jsx("div",{className:"mb-6",children:l.map((a,x)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"w-16 font-medium",children:a.algorithm}),e.jsx("div",{className:"flex-grow",children:e.jsx("div",{className:"h-6 bg-gray-100 dark:bg-gray-800 rounded-sm overflow-hidden",children:e.jsx("div",{className:`h-full ${a.error?"bg-red-500":"bg-blue-500"}`,style:{width:`${a.opsPerSecond/t*100}%`}})})}),e.jsx("span",{className:"ml-2 w-24 text-right font-mono text-sm",children:a.error?"Error":Math.round(a.opsPerSecond).toLocaleString()})]}),a.error&&e.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs ml-16",children:a.error})]},x))}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Verification Performance"}),e.jsx("div",{children:o.map((a,x)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"w-16 font-medium",children:a.algorithm}),e.jsx("div",{className:"flex-grow",children:e.jsx("div",{className:"h-6 bg-gray-100 dark:bg-gray-800 rounded-sm overflow-hidden",children:e.jsx("div",{className:`h-full ${a.error?"bg-red-500":"bg-green-500"}`,style:{width:`${a.opsPerSecond/t*100}%`}})})}),e.jsx("span",{className:"ml-2 w-24 text-right font-mono text-sm",children:a.error?"Error":Math.round(a.opsPerSecond).toLocaleString()})]}),a.error&&e.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs ml-16",children:a.error})]},x))})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"System:"}),e.jsx("span",{className:"ml-2 text-sm",children:navigator.userAgent})]}),e.jsx("div",{children:e.jsx(M,{color:"info",children:new Date().toLocaleString()})})]})]}),!y&&i.length===0&&e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:'Click "Run Benchmark" to test JWT algorithm performance in your browser.'})]})]})},Oe=()=>e.jsx(Re,{children:e.jsxs(ve,{children:[e.jsx($,{path:"/",element:e.jsx(Se,{})}),e.jsx($,{path:"/build",element:e.jsx(Ee,{})}),e.jsx($,{path:"/inspect",element:e.jsx(Je,{})}),e.jsx($,{path:"/jwks",element:e.jsx(Ie,{})}),e.jsx($,{path:"/benchmark",element:e.jsx(De,{})}),e.jsx($,{path:"*",element:e.jsx(ke,{to:"/jwt"})})]})}),_e={id:"jwt",title:"JWT Toolkit",description:"Comprehensive tool suite for JSON Web Tokens",route:"/jwt",icon:()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e.jsx("path",{d:"M12 0L1.604 6v12L12 24l10.396-6V6L12 0zm-1 20.5v-17l9 5.2v6.6l-9 5.2z"})}),component:b.lazy(()=>Promise.resolve({default:()=>e.jsx(e.Fragment,{})})),category:"Security",metadata:{keywords:["jwt","token","authentication","json web token"]},uiOptions:{fullWidth:!0}},Ke=()=>{const c=we(),n=Ne().pathname.split("/jwt")[1]||"/",y=[{id:"/",label:"Decoder",title:"Decode & Verify JWT Tokens"},{id:"/inspect",label:"Inspector",title:"Deep Inspection & Security Analysis"},{id:"/build",label:"Builder",title:"Create & Sign JWT Tokens"},{id:"/jwks",label:"JWKS",title:"JWKS Tool & Public Key Discovery"},{id:"/benchmark",label:"Performance",title:"Algorithm Performance Benchmarks"}],u=g=>{c(`/jwt${g}`)},h="JWT Toolkit | MyDebugger",v="Complete JWT toolkit for developers: decode, create, inspect, verify and benchmark JSON Web Tokens with our comprehensive suite of JWT tools.";return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx("title",{children:h}),e.jsx("meta",{name:"description",content:v}),e.jsx("meta",{property:"og:title",content:h}),e.jsx("meta",{property:"og:description",content:v}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:h}),e.jsx("meta",{name:"twitter:description",content:v}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsx(je,{tool:_e,children:e.jsxs(H,{className:"p-0 overflow-visible",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx(Z,{activeTab:n,onChange:u,children:y.map(g=>e.jsx(P,{id:g.id,isActive:n===g.id,children:g.label},g.id))})}),e.jsx("div",{className:"p-5",children:e.jsx(Oe,{})})]})})]})};export{Ke as default};
//# sourceMappingURL=JwtToolkit-4c6e1f4e.js.map
