import{g as B,j as e,b as I,C as b,B as v,L as N}from"./index-03788e60.js";import{r as i}from"./react-e68835f7.js";import{H as A}from"./vendor-975fbbe6.js";const W=()=>{const w=B("/clickjacking"),[m,p]=i.useState(""),[n,x]=i.useState(!1),[y,d]=i.useState(null),[t,l]=i.useState(null),P=i.useRef(null),[C,g]=i.useState(!1),[j,h]=i.useState(!1),u="Click Jacking Validator | MyDebugger",f="Test if a website is vulnerable to click jacking attacks by examining headers and framing capability.",E=s=>{try{return new URL(s),!0}catch{return!1}},L=s=>s?!s.startsWith("http://")&&!s.startsWith("https://")?`https://${s}`:s:"",k=async()=>{x(!0),d(null),l(null),g(!1),h(!1);const s=L(m);if(!E(s)){d("Please enter a valid URL"),x(!1);return}try{const c=`/api/clickjacking-analysis?url=${encodeURIComponent(s)}`,a={url:s,headers:{},canBeFramed:!0,frameLoaded:!1,timestamp:new Date},o=await fetch(c);if(!o.ok){const U=await o.json();throw new Error(U.error||`Server returned ${o.status}`)}const r=await o.json();a.statusCode=r.status,a.statusText=r.statusText,r.headers["x-frame-options"]&&(a.headers["x-frame-options"]=r.headers["x-frame-options"]),r.headers["content-security-policy"]&&(a.headers["content-security-policy"]=r.headers["content-security-policy"]),r.clickjackingProtection&&r.clickjackingProtection.frameAncestorsValue&&(a.headers["frame-ancestors"]=r.clickjackingProtection.frameAncestorsValue),a.canBeFramed=!r.clickjackingProtection.protected,a.canBeFramed?r.recommendations&&r.recommendations.length&&(a.message=`Recommendations: ${r.recommendations.join("; ")}`):r.clickjackingProtection.hasXFrameOptions?a.message=`X-Frame-Options header is set to ${r.headers["x-frame-options"]}`:r.clickjackingProtection.hasCSPProtection?a.message=`Content-Security-Policy header restricts framing with: ${r.clickjackingProtection.frameAncestorsValue}`:a.message="Site is protected against clickjacking",l(a)}catch(c){d(`Error validating website: ${c instanceof Error?c.message:"Unknown error"}`)}finally{x(!1)}},F=()=>{g(!0),t&&l({...t,frameLoaded:!0})},R=()=>{h(!0),t&&l({...t,frameLoaded:!1,canBeFramed:!1,message:t.message||"Website refused to load in iframe. This indicates clickjacking protection is in place."})},S=s=>{s.key==="Enter"&&k()},T=()=>{p(""),l(null),d(null),g(!1),h(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx("title",{children:u}),e.jsx("meta",{name:"description",content:f}),e.jsx("meta",{property:"og:title",content:u}),e.jsx("meta",{property:"og:description",content:f}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/clickjacking"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:u}),e.jsx("meta",{name:"twitter:description",content:f}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/clickjacking"})]}),e.jsx(I,{tool:w,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(b,{isElevated:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"url-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Enter website URL to check for click jacking vulnerabilities"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{id:"url-input",type:"text",className:"flex-grow rounded-l-md border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white shadow-sm focus:border-primary-500 focus:ring focus:ring-primary-200 dark:focus:ring-primary-900 focus:ring-opacity-50",placeholder:"example.com",value:m,onChange:s=>p(s.target.value),onKeyPress:S,disabled:n}),e.jsx(v,{onClick:k,isLoading:n,disabled:n||!m,className:"rounded-l-none",children:"Check"})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Enter a URL to check if it's vulnerable to click jacking attacks"})]}),y&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md text-red-700 dark:text-red-400 text-sm",children:y}),n&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(N,{})}),t&&!n&&e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"p-4 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"font-medium text-lg mb-3 text-gray-800 dark:text-gray-200",children:"Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-md bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"URL"}),e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 text-sm",children:"Visit Site â†—"})]}),e.jsx("div",{className:"mt-1 text-sm break-all",children:t.url})]}),e.jsxs("div",{className:`p-3 rounded-md ${t.canBeFramed?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium",children:"Click Jacking Protection"}),t.canBeFramed?e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 rounded-full",children:"Vulnerable"}):e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Protected"})]}),e.jsx("div",{className:"mt-1 text-sm",children:t.canBeFramed?"This site may be vulnerable to click jacking attacks":"This site is protected against click jacking"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-md mb-2 text-gray-800 dark:text-gray-200",children:"Security Headers"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"X-Frame-Options"}),t.headers["x-frame-options"]?e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Present"}):e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 rounded-full",children:"Missing"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:[t.headers["x-frame-options"]||"Not specified",!t.headers["x-frame-options"]&&e.jsx("p",{className:"text-xs mt-1 text-yellow-600 dark:text-yellow-400",children:'Recommendation: Add X-Frame-Options header with value "DENY" or "SAMEORIGIN"'})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"CSP frame-ancestors"}),t.headers["frame-ancestors"]?e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded-full",children:"Present"}):e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 rounded-full",children:"Missing"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:[t.headers["frame-ancestors"]||"Not specified",!t.headers["frame-ancestors"]&&e.jsx("p",{className:"text-xs mt-1 text-yellow-600 dark:text-yellow-400",children:`Recommendation: Add Content-Security-Policy header with frame-ancestors directive set to "'none'" or "'self'"`})]})]})]})]})]}),e.jsxs("div",{className:"p-4 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"font-medium text-lg mb-3 text-gray-800 dark:text-gray-200",children:"iframe Test"}),e.jsx("div",{className:"mb-3 text-sm text-gray-600 dark:text-gray-400",children:"This test attempts to load the website in an iframe. If the website has click jacking protection, the iframe should not display content."}),e.jsx("div",{className:"relative rounded-md overflow-hidden border border-gray-300 dark:border-gray-600",style:{height:"400px"},children:n?e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50 dark:bg-gray-800",children:e.jsx(N,{})}):e.jsxs(e.Fragment,{children:[e.jsx("iframe",{ref:P,src:t.url,className:"w-full h-full",onLoad:F,onError:R,sandbox:"allow-same-origin allow-scripts",title:"Click Jacking Test"}),j&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50/90 dark:bg-gray-800/90",children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"text-red-500 dark:text-red-400 mb-2",children:e.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Failed to load content"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"The website could not be loaded in an iframe, which may indicate click jacking protection."})]})}),!j&&C&&e.jsx("div",{className:"absolute top-0 left-0 right-0 bg-red-500 text-white text-center py-1 text-sm",children:"This website can be embedded in iframes (potentially vulnerable to click jacking)"})]})})]})]}),t&&e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx(v,{onClick:T,variant:"light",children:"Test Another Site"})})]})}),e.jsx(b,{title:"About Click Jacking",isElevated:!0,children:e.jsxs("div",{className:"prose dark:prose-invert max-w-none",children:[e.jsx("p",{children:"Click jacking is a malicious technique where an attacker tricks a user into clicking something different from what they perceive, potentially causing them to perform unintended actions."}),e.jsx("h3",{children:"How Click Jacking Works"}),e.jsx("p",{children:"In a typical click jacking attack, the attacker loads the target website in a transparent iframe and overlays it with their own content. When users think they are clicking on the visible content, they are actually clicking on elements in the invisible, target website."}),e.jsx("h3",{children:"Protection Methods"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"X-Frame-Options Header:"})," Prevents a webpage from being displayed in a frame. Values include:",e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"DENY"})," - prevents any domain from framing the content"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"SAMEORIGIN"})," - allows framing by the same site"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"ALLOW-FROM uri"})," - permits specified origins to frame"]})]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Content Security Policy (frame-ancestors):"})," Modern alternative to X-Frame-Options that provides more flexibility. Examples:",e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"frame-ancestors 'none'"})," - prevents any framing"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"frame-ancestors 'self'"})," - allows same-origin framing only"]})]})]})]})]})})]})})]})};export{W as default};
//# sourceMappingURL=ClickJackingValidator-52a36434.js.map
