import{j as e,C as D,B as R,a as M,T as H,_ as X,L as V,b as je}from"./index-a8d3ac02.js";import{R as K,r as f,b as be,c as W,N as ve,u as we,d as Ne}from"./react-e68835f7.js";import{H as re}from"./vendor-975fbbe6.js";import{T as Y,a as z,b as $}from"./TabGroup-7cc04562.js";const L=({type:m="info",title:o,children:i,showIcon:y=!0,dismissible:x=!1,onDismiss:h,className:b="",containerClassName:u="",outlined:s=!1,id:t,action:l})=>{const[d,a]=K.useState(!0),[g,A]=K.useState(!1);if(!d)return null;const S=()=>{A(!0),setTimeout(()=>{a(!1),h&&h()},300)},N={info:{solid:"bg-blue-50 border-blue-300 text-blue-800 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300",outlined:"bg-transparent border-blue-500 text-blue-700 dark:text-blue-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})},success:{solid:"bg-green-50 border-green-300 text-green-800 dark:bg-green-900/30 dark:border-green-800 dark:text-green-300",outlined:"bg-transparent border-green-500 text-green-700 dark:text-green-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},warning:{solid:"bg-yellow-50 border-yellow-300 text-yellow-800 dark:bg-yellow-900/30 dark:border-yellow-800 dark:text-yellow-300",outlined:"bg-transparent border-yellow-500 text-yellow-700 dark:text-yellow-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})},error:{solid:"bg-red-50 border-red-300 text-red-800 dark:bg-red-900/30 dark:border-red-800 dark:text-red-300",outlined:"bg-transparent border-red-500 text-red-700 dark:text-red-400",icon:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}},k=s?N[m].outlined:N[m].solid,E=g?"animate-fade-out motion-reduce:opacity-0 motion-reduce:transition-opacity":"animate-fade-in motion-reduce:animate-none";return e.jsx("div",{id:t,className:`${u}`,children:e.jsxs("div",{className:`flex p-4 mb-4 border-l-4 rounded-md ${k} ${E} transition-all duration-300 motion-reduce:transition-none ${b}`,role:"alert","aria-live":"polite",children:[e.jsxs("div",{className:"flex items-start",children:[y&&e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("div",{className:"transition-transform duration-200 ease-in-out motion-reduce:transform-none",children:N[m].icon})}),e.jsxs("div",{className:"flex-1",children:[o&&e.jsx("h3",{className:"text-sm font-medium mb-1",children:o}),e.jsx("div",{className:"text-sm",children:i}),l&&e.jsx("div",{className:"mt-3",children:l})]})]}),x&&e.jsxs("button",{type:"button",className:"ml-auto -mx-1.5 -my-1.5 rounded-lg p-1.5 inline-flex h-8 w-8 focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200 motion-reduce:transition-none",onClick:S,"aria-label":"Close",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{"aria-hidden":"true",className:"w-5 h-5 transform transition-transform duration-200 hover:scale-110 motion-reduce:transform-none",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})},ke=()=>{const[m,o]=f.useState(""),[i,y]=f.useState(null),[x,h]=f.useState(null),[b,u]=f.useState(!1),[s,t]=f.useState(""),[l,d]=f.useState(null),[a,g]=f.useState("json");f.useEffect(()=>{if(!m){y(null),h(null),d(null);return}try{const n=m.split(".");if(n.length!==3)throw new Error("Invalid JWT format. Expected three parts separated by dots.");const c={header:JSON.parse(atob(n[0].replace(/-/g,"+").replace(/_/g,"/"))),payload:JSON.parse(atob(n[1].replace(/-/g,"+").replace(/_/g,"/"))),signature:n[2],raw:{header:n[0],payload:n[1],signature:n[2]}};y(c),h(null),d(null)}catch(n){h(n instanceof Error?n.message:"Failed to decode JWT"),y(null),d(null)}},[m]),f.useEffect(()=>{if(b){const n=setTimeout(()=>u(!1),2e3);return()=>clearTimeout(n)}},[b]);const A=()=>{if(!i)return;const n=JSON.stringify({header:i.header,payload:i.payload},null,2);navigator.clipboard.writeText(n),u(!0)},S=()=>{navigator.clipboard.writeText(m),u(!0)},N=()=>{o(""),y(null),h(null),t(""),d(null)},k=()=>{o("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMiwiZXhwIjoxNTE2MjM5MDIyfQ.sQGRWSev5kAPlYYkQgA1voON4tZdotVJO0xsJCRrCOw")},E=()=>{!i||!s||d(s.length>10)},T=n=>{try{return new Date(n*1e3).toLocaleString()}catch{return"Invalid date"}},v=n=>Date.now()>n*1e3,w="JWT Decoder | MyDebugger",r="Decode and verify JSON Web Tokens. Analyze headers, payload claims, and verify signatures securely in your browser.";return e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx("title",{children:w}),e.jsx("meta",{name:"description",content:r}),e.jsx("meta",{property:"og:title",content:w}),e.jsx("meta",{property:"og:description",content:r}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:w}),e.jsx("meta",{name:"twitter:description",content:r}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"JSON Web Token (JWT) Debugger"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Decode, verify, and generate JSON Web Tokens (JWT) instantly. All processing happens in your browser."}),e.jsx("div",{className:"mb-4 bg-yellow-50 p-4 border border-yellow-200 rounded-md",children:e.jsxs("p",{className:"text-yellow-800",children:[e.jsx("span",{className:"font-bold",children:"For your protection:"})," All JWT debugging and validation happens in your browser. This site does not store or transmit your tokens or keys outside of your browser."]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs(D,{isElevated:!0,children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Encoded JWT"}),e.jsx(R,{onClick:k,variant:"light",size:"sm",children:"Generate example"})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("textarea",{id:"jwt-input",className:"w-full font-mono rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50 h-32",value:m,onChange:n=>o(n.target.value),placeholder:"Paste your JWT token here...",autoFocus:!0,spellCheck:"false"}),x&&e.jsx(L,{type:"error",className:"mt-4",children:x}),i&&e.jsxs("div",{className:"mt-4 bg-gray-50 p-4 rounded-md border border-gray-200 font-mono text-sm overflow-x-auto break-all",children:[e.jsx("span",{className:"text-blue-600",children:i.raw.header}),e.jsx("span",{className:"text-gray-500",children:"."}),e.jsx("span",{className:"text-purple-600",children:i.raw.payload}),e.jsx("span",{className:"text-gray-500",children:"."}),e.jsx("span",{className:"text-red-500",children:i.raw.signature})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(R,{onClick:N,variant:"light",children:"Reset"})}),e.jsx("div",{className:"space-x-3",children:e.jsx(R,{onClick:S,variant:"primary",children:b?"Copied!":"Copy Token"})})]})]})]}),i&&e.jsx("div",{className:"mt-6",children:e.jsxs(D,{isElevated:!0,children:[e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsx("div",{className:`px-4 py-2 cursor-pointer transition ${a==="json"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 hover:text-gray-800"}`,onClick:()=>g("json"),children:"JSON"}),e.jsx("div",{className:`px-4 py-2 cursor-pointer transition ${a==="table"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 hover:text-gray-800"}`,onClick:()=>g("table"),children:"Claims Table"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"HEADER"}),a==="json"?e.jsx("pre",{className:"bg-gray-50 p-3 rounded-md overflow-x-auto",children:JSON.stringify(i.header,null,2)}):e.jsx("div",{className:"bg-gray-50 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(i.header).map(([n,c])=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:n}),e.jsx("td",{className:"py-2 px-3",children:String(c)})]},n))})]})}),e.jsx("h3",{className:"font-medium text-gray-800 mt-6 mb-2",children:"PAYLOAD"}),a==="json"?e.jsx("pre",{className:"bg-gray-50 p-3 rounded-md overflow-x-auto",children:JSON.stringify(i.payload,null,2)}):e.jsx("div",{className:"bg-gray-50 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(i.payload).map(([n,c])=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:n}),e.jsx("td",{className:"py-2 px-3",children:n==="exp"||n==="iat"||n==="nbf"?`${String(c)} (${T(c)})`:String(c)})]},n))})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(R,{onClick:A,variant:"primary",children:b?"Copied!":"Copy JSON"})})]})]})})]}),e.jsxs("div",{children:[e.jsxs(D,{isElevated:!0,children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Signature Verification"})}),e.jsx("div",{className:"p-4",children:i?e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Verify the signature with your secret key. Uses ",i.header.alg||"HS256"," algorithm."]}),e.jsx("label",{htmlFor:"secret-key",className:"block font-medium text-gray-700 mb-2",children:"Secret Key"}),e.jsx("input",{id:"secret-key",type:"text",className:"w-full mb-4 font-mono rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",value:s,onChange:n=>t(n.target.value),placeholder:"Enter your secret key..."}),e.jsx(R,{onClick:E,variant:"primary",className:"w-full",children:"Verify Signature"}),l!==null&&e.jsx("div",{className:`mt-4 p-3 rounded-md ${l?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:`h-5 w-5 mr-2 ${l?"text-green-500":"text-red-500"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:l?"Signature Verified":"Invalid Signature"})]})})]}):e.jsx("p",{className:"text-gray-600",children:"Enter a JWT above to verify its signature."})})]}),i&&i.payload.exp&&e.jsxs(D,{isElevated:!0,className:"mt-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Token Status"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:`p-3 rounded-md ${v(i.payload.exp)?"bg-red-50":"bg-green-50"}`,children:[e.jsx("div",{className:"font-medium",children:v(i.payload.exp)?"Expired":"Valid"}),e.jsx("div",{className:"text-sm mt-1",children:T(i.payload.exp)})]}),i.payload.iat&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-medium text-gray-700",children:"Issued at:"}),e.jsx("div",{className:"text-sm",children:T(i.payload.iat)})]})]})]}),e.jsxs(D,{isElevated:!0,className:"mt-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"About JWT"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"JWT consists of three parts separated by dots:"}),e.jsxs("ul",{className:"list-disc pl-5 text-sm text-gray-700 mb-3",children:[e.jsxs("li",{className:"mb-1",children:[e.jsx("span",{className:"text-blue-600 font-medium",children:"Header"}),": Algorithm & token type"]}),e.jsxs("li",{className:"mb-1",children:[e.jsx("span",{className:"text-purple-600 font-medium",children:"Payload"}),": Data (claims)"]}),e.jsxs("li",{className:"mb-1",children:[e.jsx("span",{className:"text-red-500 font-medium",children:"Signature"}),": Verification"]})]}),e.jsxs("a",{href:"https://jwt.io/introduction",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 text-sm font-medium inline-flex items-center",children:["Learn more about JWT",e.jsx("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})]}),e.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Related Tools"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("a",{href:"/jwt-playground",className:"bg-white p-4 rounded-md border border-gray-200 hover:shadow-md transition",children:[e.jsx("h3",{className:"font-medium text-lg mb-1",children:"JWT Playground"}),e.jsx("p",{className:"text-gray-600",children:"Create and experiment with custom JWTs."})]}),e.jsxs("a",{href:"/url-encoder",className:"bg-white p-4 rounded-md border border-gray-200 hover:shadow-md transition",children:[e.jsx("h3",{className:"font-medium text-lg mb-1",children:"URL Encoder/Decoder"}),e.jsx("p",{className:"text-gray-600",children:"Encode or decode URL components safely."})]}),e.jsxs("a",{href:"/headers",className:"bg-white p-4 rounded-md border border-gray-200 hover:shadow-md transition",children:[e.jsx("h3",{className:"font-medium text-lg mb-1",children:"HTTP Headers Analyzer"}),e.jsx("p",{className:"text-gray-600",children:"Analyze and understand HTTP request/response headers."})]})]})]})]})]})},P=m=>btoa(m).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),U=m=>{switch(m=m.replace(/-/g,"+").replace(/_/g,"/"),m.length%4){case 0:break;case 2:m+="==";break;case 3:m+="=";break;default:throw new Error("Invalid base64url string")}try{return decodeURIComponent(escape(atob(m)))}catch{return atob(m)}},se=async m=>{try{const o=m.split(".");if(o.length!==3)throw new Error("Invalid JWT format: expected 3 parts");const[i,y,x]=o;let h=null,b=null,u;try{const s=U(i);h=JSON.parse(s)}catch{u="Invalid JWT header: failed to parse"}try{const s=U(y);b=JSON.parse(s)}catch{u=u||"Invalid JWT payload: failed to parse"}return{header:h,payload:b,signature:x,isValid:!1,raw:{header:i,payload:y,signature:x},error:u}}catch(o){return{header:null,payload:null,signature:null,isValid:!1,raw:{header:"",payload:"",signature:""},error:o instanceof Error?o.message:"Unknown error decoding token"}}},ae=(m,o=!1)=>{if(o){const i=atob(m),y=new Uint8Array(i.length);for(let x=0;x<i.length;x++)y[x]=i.charCodeAt(x);return y.buffer}else return new TextEncoder().encode(m).buffer},te=async(m,o,i)=>{try{const y=m.split(".");if(y.length!==3)throw new Error("Invalid JWT format");const[x,h,b]=y,u=`${x}.${h}`;let s=i;if(!s)try{const N=U(x);s=JSON.parse(N).alg}catch{throw new Error("Failed to parse JWT header")}if(s==="none")return!1;const t=Uint8Array.from(atob(b.replace(/-/g,"+").replace(/_/g,"/")),N=>N.charCodeAt(0)),d=new TextEncoder().encode(u);let a,g=!1;switch(s){case"HS256":a={name:"HMAC",hash:"SHA-256"},g=!0;break;case"HS384":a={name:"HMAC",hash:"SHA-384"},g=!0;break;case"HS512":a={name:"HMAC",hash:"SHA-512"},g=!0;break;case"RS256":a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"ES256":a={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":a={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":a={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${s}`)}const A=ae(o,!1),S=await window.crypto.subtle.importKey(g?"raw":"spki",A,a,!1,["verify"]);return await window.crypto.subtle.verify(a,S,t,d)}catch(y){return console.error("JWT verification error:",y),!1}},G=async(m,o,i)=>{try{const y={typ:"JWT",...m},x=y.alg;if(!x)throw new Error("Algorithm is required in header");const h=P(JSON.stringify(y)),b=P(JSON.stringify(o)),u=`${h}.${b}`;if(x==="none")return`${u}.`;let s,t=!1;switch(x){case"HS256":s={name:"HMAC",hash:"SHA-256"},t=!0;break;case"HS384":s={name:"HMAC",hash:"SHA-384"},t=!0;break;case"HS512":s={name:"HMAC",hash:"SHA-512"},t=!0;break;case"RS256":s={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"};break;case"RS384":s={name:"RSASSA-PKCS1-v1_5",hash:"SHA-384"};break;case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:"SHA-512"};break;case"ES256":s={name:"ECDSA",hash:"SHA-256",namedCurve:"P-256"};break;case"ES384":s={name:"ECDSA",hash:"SHA-384",namedCurve:"P-384"};break;case"ES512":s={name:"ECDSA",hash:"SHA-512",namedCurve:"P-521"};break;default:throw new Error(`Unsupported algorithm: ${x}`)}const l=ae(i,!1),d=await window.crypto.subtle.importKey(t?"raw":x.startsWith("RS")?"pkcs8":"raw",l,s,!1,["sign"]),g=new TextEncoder().encode(u),A=await window.crypto.subtle.sign(s,d,g),S=new Uint8Array(A);let N="";for(let k=0;k<S.length;k++)N+=String.fromCharCode(S[k]);return N=P(N),`${u}.${N}`}catch(y){throw console.error("JWT signing error:",y),y}},ne=async m=>{const y={sub:"1234567890",name:"John Doe",iat:Math.floor(Date.now()/1e3),exp:Math.floor(Date.now()/1e3)+3600,data:Array(1024).fill("a").join("")},x={alg:m,typ:"JWT"},h=Array(32).fill(0).map(()=>Math.floor(Math.random()*256).toString(16).padStart(2,"0")).join(""),b=performance.now();for(let t=0;t<100;t++)try{await G(x,{...y,nonce:t},h)}catch(l){return console.error(`Error benchmarking algorithm ${m}:`,l),0}const s=performance.now()-b;return Math.floor(100/(s/1e3))},ie=G,Se=te,Te=se,oe=ne,q=Object.freeze(Object.defineProperty({__proto__:null,base64UrlDecode:U,base64UrlEncode:P,bench:oe,benchmarkAlgorithm:ne,decode:Te,decodeSafely:se,sign:ie,signToken:G,verify:Se,verifyToken:te},Symbol.toStringTag,{value:"Module"})),Ee=()=>{const[m,o]=f.useState("header"),[i,y]=f.useState("HS256"),[x,h]=f.useState(""),[b,u]=f.useState("JWT"),[s,t]=f.useState([{name:"sub",value:"1234567890",type:"string"},{name:"name",value:"John Doe",type:"string"},{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}]),[l,d]=f.useState(""),[a,g]=f.useState(""),[A,S]=f.useState("string"),[N,k]=f.useState("your-256-bit-secret"),[E,T]=f.useState(""),[v,w]=f.useState(0),[r,n]=f.useState(!1),[c,j]=f.useState(null),[J,Q]=f.useState(!1);f.useEffect(()=>{if(J){const p=setTimeout(()=>Q(!1),2e3);return()=>clearTimeout(p)}},[J]),f.useEffect(()=>{me()},[i,x,b,s]);const me=async()=>{try{const p={alg:i,typ:b};x&&(p.kid=x);const C={};for(const _ of s)try{switch(_.type){case"string":C[_.name]=_.value;break;case"number":C[_.name]=Number(_.value);break;case"boolean":C[_.name]=_.value.toLowerCase()==="true";break;case"json":C[_.name]=JSON.parse(_.value);break}}catch{C[_.name]=_.value}const O=P(JSON.stringify(p)),I=P(JSON.stringify(C)),F=`${O}.${I}.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`;T(F),w(new TextEncoder().encode(F).length)}catch(p){console.error("Error generating token preview:",p)}},he=()=>{!l||!l.trim()||(t([...s,{name:l.trim(),value:a,type:A}]),d(""),g(""))},xe=p=>{const C=[...s];C.splice(p,1),t(C)},B=(p,C,O)=>{const I=[...s];I[p][C]=O,t(I)},ue=async()=>{n(!0),j(null);try{const p={alg:i,typ:b};x&&(p.kid=x);const C={};for(const I of s)try{switch(I.type){case"string":C[I.name]=I.value;break;case"number":C[I.name]=Number(I.value);break;case"boolean":C[I.name]=I.value.toLowerCase()==="true";break;case"json":C[I.name]=JSON.parse(I.value);break}}catch{C[I.name]=I.value}const O=await ie(p,C,N);T(O),w(new TextEncoder().encode(O).length)}catch(p){j(`Error signing token: ${p instanceof Error?p.message:String(p)}`)}n(!1)},pe=()=>{navigator.clipboard.writeText(E),Q(!0)},ge=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Algorithm (alg)"}),e.jsxs("select",{value:i,onChange:p=>y(p.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[e.jsxs("optgroup",{label:"HMAC",children:[e.jsx("option",{value:"HS256",children:"HS256 (HMAC + SHA256)"}),e.jsx("option",{value:"HS384",children:"HS384 (HMAC + SHA384)"}),e.jsx("option",{value:"HS512",children:"HS512 (HMAC + SHA512)"})]}),e.jsxs("optgroup",{label:"RSA",children:[e.jsx("option",{value:"RS256",children:"RS256 (RSA + SHA256)"}),e.jsx("option",{value:"RS384",children:"RS384 (RSA + SHA384)"}),e.jsx("option",{value:"RS512",children:"RS512 (RSA + SHA512)"})]}),e.jsxs("optgroup",{label:"ECDSA",children:[e.jsx("option",{value:"ES256",children:"ES256 (ECDSA + SHA256)"}),e.jsx("option",{value:"ES384",children:"ES384 (ECDSA + SHA384)"}),e.jsx("option",{value:"ES512",children:"ES512 (ECDSA + SHA512)"})]}),e.jsx("optgroup",{label:"Unsafe",children:e.jsx("option",{value:"none",children:"none (Unsigned Token)"})})]}),i==="none"&&e.jsx("div",{className:"mt-2 text-red-600 dark:text-red-400 text-sm",children:'Warning: The "none" algorithm creates unsigned tokens which provide no security.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Token Type (typ)"}),e.jsx(H,{value:b,onChange:p=>u(p.target.value),placeholder:"JWT"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:'Usually "JWT" for JSON Web Token'})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Key ID (kid)"}),e.jsx(H,{value:x,onChange:p=>h(p.target.value),placeholder:"Optional Key ID"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Optional identifier for the key used to sign this token"})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("div",{}),e.jsx(R,{variant:"primary",onClick:()=>o("payload"),children:"Continue to Payload"})]})]}),ye=()=>e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Current Claims"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Type"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Action"})]})}),e.jsx("tbody",{children:s.map((p,C)=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3",children:e.jsx(H,{value:p.name,onChange:O=>B(C,"name",O.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3",children:e.jsxs("select",{value:p.type,onChange:O=>B(C,"type",O.target.value),className:"p-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})}),e.jsx("td",{className:"py-2 px-3",children:e.jsx(H,{value:p.value,onChange:O=>B(C,"value",O.target.value),size:"sm"})}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsx(R,{variant:"light",size:"sm",onClick:()=>xe(C),children:"Remove"})})]},C))})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"Add Claim"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),e.jsx(H,{value:l,onChange:p=>d(p.target.value),placeholder:"Claim name",size:"sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),e.jsxs("select",{value:A,onChange:p=>S(p.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-sm",children:[e.jsx("option",{value:"string",children:"String"}),e.jsx("option",{value:"number",children:"Number"}),e.jsx("option",{value:"boolean",children:"Boolean"}),e.jsx("option",{value:"json",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Value"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:a,onChange:p=>g(p.target.value),placeholder:"Value",size:"sm",className:"flex-grow"}),e.jsx(R,{variant:"primary",size:"sm",className:"ml-2",onClick:he,children:"Add"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-200 mb-1",children:"Common Claims"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(R,{variant:"light",size:"sm",onClick:()=>{s.some(p=>p.name==="exp")||t([...s,{name:"exp",value:String(Math.floor(Date.now()/1e3)+3600),type:"number"}])},children:"Add exp (Expiry)"}),e.jsx(R,{variant:"light",size:"sm",onClick:()=>{s.some(p=>p.name==="iat")||t([...s,{name:"iat",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add iat (Issued At)"}),e.jsx(R,{variant:"light",size:"sm",onClick:()=>{s.some(p=>p.name==="nbf")||t([...s,{name:"nbf",value:String(Math.floor(Date.now()/1e3)),type:"number"}])},children:"Add nbf (Not Before)"}),e.jsx(R,{variant:"light",size:"sm",onClick:()=>{s.some(p=>p.name==="iss")||t([...s,{name:"iss",value:"https://example.com",type:"string"}])},children:"Add iss (Issuer)"}),e.jsx(R,{variant:"light",size:"sm",onClick:()=>{s.some(p=>p.name==="aud")||t([...s,{name:"aud",value:"client-id",type:"string"}])},children:"Add aud (Audience)"}),e.jsx(R,{variant:"light",size:"sm",onClick:()=>{s.some(p=>p.name==="jti")||t([...s,{name:"jti",value:crypto.randomUUID(),type:"string"}])},children:"Add jti (JWT ID)"})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx(R,{variant:"light",onClick:()=>o("header"),children:"Back to Header"}),e.jsx(R,{variant:"primary",onClick:()=>o("signature"),children:"Continue to Signature"})]})]}),fe=()=>{let p="Secret Key",C="Enter the secret key for HMAC signing";return i.startsWith("RS")?(p="Private Key (PKCS#8)",C="Enter the PEM-formatted RSA private key"):i.startsWith("ES")?(p="Private Key (PKCS#8)",C="Enter the PEM-formatted EC private key"):i==="none"&&(p="No Key Required",C="The 'none' algorithm does not use a key"),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-blue-800 dark:text-blue-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ℹ️"}),"You're creating a token with algorithm ",e.jsx("strong",{children:i})," and ",s.length," claims.",i==="none"&&e.jsx("span",{className:"text-red-600 dark:text-red-400 ml-1",children:" (Unsigned Token - Not secure)"})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:p}),e.jsx("textarea",{value:N,onChange:O=>k(O.target.value),placeholder:i==="none"?'No key needed for "none" algorithm':"Enter key here...",disabled:i==="none",className:"w-full font-mono h-32 p-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 dark:text-gray-200"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:C})]}),e.jsx("div",{className:"mt-4",children:e.jsx(R,{variant:"primary",className:"w-full",onClick:ue,disabled:r||i!=="none"&&!N,children:r?"Signing...":"Sign Token"})}),c&&e.jsx("div",{className:"mt-4 bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-red-800 dark:text-red-300 text-sm",children:c})}),e.jsx("div",{className:"mt-6 flex justify-between",children:e.jsx(R,{variant:"light",onClick:()=>o("payload"),children:"Back to Payload"})})]})};return e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mb-6",children:e.jsxs(Y,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(z,{id:"header-tab",isActive:m==="header",onClick:()=>o("header"),children:"1. Header"}),e.jsx(z,{id:"payload-tab",isActive:m==="payload",onClick:()=>o("payload"),children:"2. Payload"}),e.jsx(z,{id:"signature-tab",isActive:m==="signature",onClick:()=>o("signature"),children:"3. Signature"})]}),m==="header"&&ge(),m==="payload"&&ye(),m==="signature"&&fe()]})}),e.jsxs(D,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Generated Token"}),e.jsxs(M,{color:"info",children:["Size: ",v," bytes"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto whitespace-nowrap",children:E||"Your token will appear here..."}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(R,{onClick:pe,variant:"primary",disabled:!E,children:J?"Copied!":"Copy Token"})})]})]})]})};var Z={exports:{}};Z.exports;(function(m){var o=function(){var i=String.fromCharCode,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",h={};function b(s,t){if(!h[s]){h[s]={};for(var l=0;l<s.length;l++)h[s][s.charAt(l)]=l}return h[s][t]}var u={compressToBase64:function(s){if(s==null)return"";var t=u._compress(s,6,function(l){return y.charAt(l)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(s){return s==null?"":s==""?null:u._decompress(s.length,32,function(t){return b(y,s.charAt(t))})},compressToUTF16:function(s){return s==null?"":u._compress(s,15,function(t){return i(t+32)})+" "},decompressFromUTF16:function(s){return s==null?"":s==""?null:u._decompress(s.length,16384,function(t){return s.charCodeAt(t)-32})},compressToUint8Array:function(s){for(var t=u.compress(s),l=new Uint8Array(t.length*2),d=0,a=t.length;d<a;d++){var g=t.charCodeAt(d);l[d*2]=g>>>8,l[d*2+1]=g%256}return l},decompressFromUint8Array:function(s){if(s==null)return u.decompress(s);for(var t=new Array(s.length/2),l=0,d=t.length;l<d;l++)t[l]=s[l*2]*256+s[l*2+1];var a=[];return t.forEach(function(g){a.push(i(g))}),u.decompress(a.join(""))},compressToEncodedURIComponent:function(s){return s==null?"":u._compress(s,6,function(t){return x.charAt(t)})},decompressFromEncodedURIComponent:function(s){return s==null?"":s==""?null:(s=s.replace(/ /g,"+"),u._decompress(s.length,32,function(t){return b(x,s.charAt(t))}))},compress:function(s){return u._compress(s,16,function(t){return i(t)})},_compress:function(s,t,l){if(s==null)return"";var d,a,g={},A={},S="",N="",k="",E=2,T=3,v=2,w=[],r=0,n=0,c;for(c=0;c<s.length;c+=1)if(S=s.charAt(c),Object.prototype.hasOwnProperty.call(g,S)||(g[S]=T++,A[S]=!0),N=k+S,Object.prototype.hasOwnProperty.call(g,N))k=N;else{if(Object.prototype.hasOwnProperty.call(A,k)){if(k.charCodeAt(0)<256){for(d=0;d<v;d++)r=r<<1,n==t-1?(n=0,w.push(l(r)),r=0):n++;for(a=k.charCodeAt(0),d=0;d<8;d++)r=r<<1|a&1,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=a>>1}else{for(a=1,d=0;d<v;d++)r=r<<1|a,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=0;for(a=k.charCodeAt(0),d=0;d<16;d++)r=r<<1|a&1,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=a>>1}E--,E==0&&(E=Math.pow(2,v),v++),delete A[k]}else for(a=g[k],d=0;d<v;d++)r=r<<1|a&1,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=a>>1;E--,E==0&&(E=Math.pow(2,v),v++),g[N]=T++,k=String(S)}if(k!==""){if(Object.prototype.hasOwnProperty.call(A,k)){if(k.charCodeAt(0)<256){for(d=0;d<v;d++)r=r<<1,n==t-1?(n=0,w.push(l(r)),r=0):n++;for(a=k.charCodeAt(0),d=0;d<8;d++)r=r<<1|a&1,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=a>>1}else{for(a=1,d=0;d<v;d++)r=r<<1|a,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=0;for(a=k.charCodeAt(0),d=0;d<16;d++)r=r<<1|a&1,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=a>>1}E--,E==0&&(E=Math.pow(2,v),v++),delete A[k]}else for(a=g[k],d=0;d<v;d++)r=r<<1|a&1,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=a>>1;E--,E==0&&(E=Math.pow(2,v),v++)}for(a=2,d=0;d<v;d++)r=r<<1|a&1,n==t-1?(n=0,w.push(l(r)),r=0):n++,a=a>>1;for(;;)if(r=r<<1,n==t-1){w.push(l(r));break}else n++;return w.join("")},decompress:function(s){return s==null?"":s==""?null:u._decompress(s.length,32768,function(t){return s.charCodeAt(t)})},_decompress:function(s,t,l){var d=[],a=4,g=4,A=3,S="",N=[],k,E,T,v,w,r,n,c={val:l(0),position:t,index:1};for(k=0;k<3;k+=1)d[k]=k;for(T=0,w=Math.pow(2,2),r=1;r!=w;)v=c.val&c.position,c.position>>=1,c.position==0&&(c.position=t,c.val=l(c.index++)),T|=(v>0?1:0)*r,r<<=1;switch(T){case 0:for(T=0,w=Math.pow(2,8),r=1;r!=w;)v=c.val&c.position,c.position>>=1,c.position==0&&(c.position=t,c.val=l(c.index++)),T|=(v>0?1:0)*r,r<<=1;n=i(T);break;case 1:for(T=0,w=Math.pow(2,16),r=1;r!=w;)v=c.val&c.position,c.position>>=1,c.position==0&&(c.position=t,c.val=l(c.index++)),T|=(v>0?1:0)*r,r<<=1;n=i(T);break;case 2:return""}for(d[3]=n,E=n,N.push(n);;){if(c.index>s)return"";for(T=0,w=Math.pow(2,A),r=1;r!=w;)v=c.val&c.position,c.position>>=1,c.position==0&&(c.position=t,c.val=l(c.index++)),T|=(v>0?1:0)*r,r<<=1;switch(n=T){case 0:for(T=0,w=Math.pow(2,8),r=1;r!=w;)v=c.val&c.position,c.position>>=1,c.position==0&&(c.position=t,c.val=l(c.index++)),T|=(v>0?1:0)*r,r<<=1;d[g++]=i(T),n=g-1,a--;break;case 1:for(T=0,w=Math.pow(2,16),r=1;r!=w;)v=c.val&c.position,c.position>>=1,c.position==0&&(c.position=t,c.val=l(c.index++)),T|=(v>0?1:0)*r,r<<=1;d[g++]=i(T),n=g-1,a--;break;case 2:return N.join("")}if(a==0&&(a=Math.pow(2,A),A++),d[n])S=d[n];else if(n===g)S=E+E.charAt(0);else return null;N.push(S),d[g++]=E+S.charAt(0),a--,E=S,a==0&&(a=Math.pow(2,A),A++)}}};return u}();m!=null?m.exports=o:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return o})})(Z);var ee=Z.exports;const le={token:"",decoded:null,isVerified:null,verificationKey:"",error:null,history:[],securityIssues:[]};function Ce(m,o){switch(o.type){case"SET_TOKEN":return{...m,token:o.payload};case"SET_DECODED":return{...m,decoded:o.payload};case"SET_VERIFIED":return{...m,isVerified:o.payload};case"SET_VERIFICATION_KEY":return{...m,verificationKey:o.payload};case"SET_ERROR":return{...m,error:o.payload};case"ADD_HISTORY_ITEM":return{...m,history:[o.payload,...m.history.filter(i=>i.id!==o.payload.id)].slice(0,10)};case"CLEAR_HISTORY":return{...m,history:[]};case"REMOVE_HISTORY_ITEM":return{...m,history:m.history.filter(i=>i.id!==o.payload)};case"SET_SECURITY_ISSUES":return{...m,securityIssues:o.payload};case"RESET":return le;default:return m}}const de=f.createContext(void 0),Ae=({children:m})=>{const[o,i]=f.useReducer(Ce,le);K.useEffect(()=>{u()},[]),K.useEffect(()=>{try{localStorage.setItem("jwt.history",JSON.stringify(o.history))}catch(s){console.error("Failed to save JWT history:",s)}},[o.history]),K.useEffect(()=>{try{const s=localStorage.getItem("jwt.history");s&&JSON.parse(s).forEach(l=>{i({type:"ADD_HISTORY_ITEM",payload:l})})}catch(s){console.error("Failed to load JWT history:",s)}},[]);const y=async s=>{var t,l;if(!s){i({type:"SET_DECODED",payload:null}),i({type:"SET_ERROR",payload:null}),i({type:"SET_VERIFIED",payload:null});return}try{const a=await(await X(()=>Promise.resolve().then(()=>q),void 0)).decode(s);if(a.header&&a.payload&&a.signature){const g={header:a.header,payload:a.payload,signature:a.signature,raw:a.raw};i({type:"SET_TOKEN",payload:s}),i({type:"SET_DECODED",payload:g}),i({type:"SET_ERROR",payload:null}),i({type:"SET_VERIFIED",payload:null});const A=((t=a.payload)==null?void 0:t.sub)||((l=a.payload)==null?void 0:l.name)||`Token ${new Date().toLocaleDateString()}`;i({type:"ADD_HISTORY_ITEM",payload:{id:Math.random().toString(36).substring(2,9),token:s,timestamp:Date.now(),label:A}}),h(s)}else throw new Error("Failed to decode JWT: Invalid token structure")}catch(d){i({type:"SET_ERROR",payload:d instanceof Error?d.message:"Failed to decode JWT"}),i({type:"SET_DECODED",payload:null}),i({type:"SET_VERIFIED",payload:null})}},x=async(s,t)=>{if(!(!o.decoded||!t))try{const d=await(await X(()=>Promise.resolve().then(()=>q),void 0)).verify(o.token,t,s||o.decoded.header.alg);i({type:"SET_VERIFICATION_KEY",payload:t}),i({type:"SET_VERIFIED",payload:d})}catch(l){i({type:"SET_ERROR",payload:l instanceof Error?l.message:"Failed to verify signature"}),i({type:"SET_VERIFIED",payload:!1})}},h=s=>{if(!o.decoded)return;const t=[];if(o.decoded.header.alg==="none"&&t.push({id:"alg-none",severity:"high",title:"UNSIGNED TOKEN",description:'The token uses algorithm "none" and has no signature. Do not accept in production.'}),o.decoded.payload.exp){const l=o.decoded.payload.exp*1e3;Date.now()>l&&t.push({id:"token-expired",severity:"medium",title:"Token Expired",description:`Token expired on ${new Date(l).toLocaleString()}.`});const d=24*60*60*1e3;l-Date.now()<d&&Date.now()<l&&t.push({id:"token-expiring",severity:"low",title:"Token Expiring Soon",description:`Token will expire on ${new Date(l).toLocaleString()}.`})}else t.push({id:"no-expiration",severity:"medium",title:"No Expiration Time",description:"This token has no expiration time (exp claim), which is not recommended."});o.decoded.header.alg&&["HS256","RS256","ES256"].indexOf(o.decoded.header.alg)===-1&&t.push({id:"weak-algorithm",severity:"info",title:"Algorithm Consideration",description:`Algorithm ${o.decoded.header.alg} is used. Consider using HS256, RS256, or ES256.`}),i({type:"SET_SECURITY_ISSUES",payload:t})},b=()=>{if(!o.token)return window.location.href.split("#")[0];const s=ee.compressToEncodedURIComponent(o.token);return`${window.location.href.split("#")[0]}#${s}`},u=async()=>{const s=window.location.hash.substring(1);if(s)try{const t=ee.decompressFromEncodedURIComponent(s);if(t)return await y(t),!0}catch(t){console.error("Failed to load token from URL hash:",t)}return!1};return e.jsx(de.Provider,{value:{state:o,dispatch:i,decodeToken:y,verifySignature:x,analyzeToken:h,shareToken:b,loadFromHash:u},children:m})},ce=()=>{const m=f.useContext(de);if(m===void 0)throw new Error("useJwt must be used within a JwtProvider");return m},Re=()=>{const{state:m,dispatch:o,decodeToken:i,verifySignature:y}=ce(),{token:x,decoded:h,isVerified:b,error:u,securityIssues:s}=m,[t,l]=f.useState(""),[d,a]=f.useState("json"),[g,A]=f.useState(!1);f.useState(!1),f.useEffect(()=>{if(g){const j=setTimeout(()=>A(!1),2e3);return()=>clearTimeout(j)}},[g]);const S=j=>{const J=j.target.value.trim();J!==x&&i(J)},N=()=>{i("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNjE2MjM5MDIyLCJleHAiOjE5MTYyMzkwMjIsInJvbGUiOiJhZG1pbiJ9.8TT2jkQV3a9lQfNSJz7USP9vgKzlhWPMnDxCQfFgj3w")},k=()=>{o({type:"RESET"}),l("")},E=j=>{navigator.clipboard.writeText(j),A(!0)},T=()=>{!h||!t||y(h.header.alg,t)},v=j=>{try{return new Date(j*1e3).toLocaleString()}catch{return"Invalid date"}},w=j=>Date.now()>j*1e3,r=j=>{switch(j){case"high":return"error";case"medium":return"warning";case"low":return"info";default:return"neutral"}},n=j=>{switch(j){case"high":return"⚠️";case"medium":return"⚠";case"low":return"ℹ️";default:return"ℹ️"}},c=()=>s.length===0?null:e.jsx("div",{className:"mb-4",children:s.map(j=>e.jsx(L,{type:r(j.severity),className:"mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:n(j.severity)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:j.title}),e.jsx("div",{className:"text-sm",children:j.description})]})]})},j.id))});return e.jsxs(e.Fragment,{children:[e.jsxs(D,{className:"mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"JWT Token"}),e.jsx(R,{onClick:N,size:"sm",variant:"light",children:"Generate Demo"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-200 dark:border-yellow-800 mb-4",children:e.jsxs("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🔒"}),"All JWT processing happens locally in your browser. Your tokens are never sent to a server."]})}),e.jsx("textarea",{className:"w-full font-mono text-sm p-3 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100 h-28 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:x,onChange:S,placeholder:"Paste your JWT token here...",spellCheck:"false"}),u&&e.jsx(L,{type:"error",className:"mt-4",children:u}),h&&e.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border border-gray-200 dark:border-gray-700 font-mono text-sm overflow-x-auto whitespace-nowrap",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:h.raw.header}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"."}),e.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:h.raw.payload}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"."}),e.jsx("span",{className:"text-red-500 dark:text-red-400",children:h.raw.signature})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("div",{children:e.jsx(R,{onClick:k,variant:"light",children:"Reset"})}),e.jsx(R,{onClick:()=>E(x),variant:"primary",children:g?"Copied!":"Copy Token"})]})]})]}),c(),h&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(D,{children:e.jsxs(Y,{children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx(z,{id:"tab-json",isActive:d==="json",onClick:()=>a("json"),children:"JSON"}),e.jsx(z,{id:"tab-claims",isActive:d==="claims",onClick:()=>a("claims"),children:"Claims Table"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mb-2",children:"HEADER"}),e.jsx($,{id:"panel-json-header",isActive:d==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(h.header,null,2)})})}),e.jsx($,{id:"panel-claims-header",isActive:d==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(h.header).map(([j,J])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:j}),e.jsx("td",{className:"py-2 px-3",children:String(J)})]},j))})]})})}),e.jsx("h3",{className:"font-medium text-gray-800 dark:text-gray-200 mt-6 mb-2",children:"PAYLOAD"}),e.jsx($,{id:"panel-json-payload",isActive:d==="json",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(h.payload,null,2)})})}),e.jsx($,{id:"panel-claims-payload",isActive:d==="claims",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Claim"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Value"})]})}),e.jsx("tbody",{children:Object.entries(h.payload).map(([j,J])=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:j}),e.jsx("td",{className:"py-2 px-3",children:j==="exp"||j==="iat"||j==="nbf"?`${String(J)} (${v(J)})`:String(J)})]},j))})]})})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(R,{onClick:()=>E(JSON.stringify({header:h.header,payload:h.payload},null,2)),variant:"primary",children:g?"Copied!":"Copy JSON"})})]})]})})}),e.jsxs("div",{children:[e.jsxs(D,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Signature Verification"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Verify the signature using your secret key. Algorithm: ",h.header.alg||"unknown"]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"secret-key",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secret/Public Key"}),e.jsx(H,{id:"secret-key",value:t,onChange:j=>l(j.target.value),placeholder:"Enter secret key or paste public key...",className:"font-mono"})]}),e.jsx(R,{onClick:T,variant:"primary",className:"w-full mt-3",disabled:!t,children:"Verify Signature"}),b!==null&&e.jsx("div",{className:`mt-4 p-3 rounded-md ${b?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:b?"✅":"❌"}),e.jsx("span",{className:"font-medium",children:b?"Signature Verified":"Invalid Signature"})]})})]})]}),h.payload.exp&&e.jsxs(D,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Token Status"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:`p-3 rounded-md ${w(h.payload.exp)?"bg-red-50 dark:bg-red-900/20":"bg-green-50 dark:bg-green-900/20"}`,children:[e.jsx("div",{className:"font-medium",children:w(h.payload.exp)?"🕒 Expired":"✅ Valid"}),e.jsx("div",{className:"text-sm mt-1",children:v(h.payload.exp)})]}),h.payload.iat&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Issued at:"}),e.jsx("div",{className:"text-sm",children:v(h.payload.iat)})]})]})]})]})]})})]})},Je=()=>{var w;const{state:m}=ce(),{decoded:o}=m,[i,y]=f.useState(""),[x,h]=f.useState("jwks"),[b,u]=f.useState(!1),[s,t]=f.useState([]),[l,d]=f.useState(null),[a,g]=f.useState(null),[A,S]=f.useState(null);f.useEffect(()=>{var r;if((r=o==null?void 0:o.payload)!=null&&r.iss&&!i){const n=o.payload.iss;n.endsWith("/")?y(`${n}.well-known/openid-configuration`):y(`${n}/.well-known/openid-configuration`),h("oidc")}},[o]),f.useEffect(()=>{var r;if((r=o==null?void 0:o.header)!=null&&r.kid&&s.length>0){const n=o.header.kid,c=s.find(j=>j.kid===n);S(c||null)}else S(null)},[o,s]);const N=async()=>{if(i){u(!0),g(null),t([]),d(null);try{const r=await fetch(i);if(!r.ok)throw new Error(`HTTP error: ${r.status} ${r.statusText}`);const n=await r.json();try{sessionStorage.setItem(`jwks_${i}`,JSON.stringify(n))}catch(c){console.warn("Failed to cache JWKS in sessionStorage:",c)}if(n.keys)t(n.keys);else throw new Error("No keys found in the JWKS response")}catch(r){g(`Failed to fetch JWKS: ${r instanceof Error?r.message:String(r)}`)}finally{u(!1)}}},k=async()=>{if(i){u(!0),g(null),t([]),d(null);try{const r=await fetch(i);if(!r.ok)throw new Error(`HTTP error: ${r.status} ${r.statusText}`);const n=await r.json();d(n);try{sessionStorage.setItem(`oidc_${i}`,JSON.stringify(n))}catch(J){console.warn("Failed to cache OIDC config in sessionStorage:",J)}if(!n.jwks_uri)throw new Error("No JWKS URI found in the OIDC configuration");const c=await fetch(n.jwks_uri);if(!c.ok)throw new Error(`HTTP error fetching JWKS: ${c.status} ${c.statusText}`);const j=await c.json();try{sessionStorage.setItem(`jwks_${n.jwks_uri}`,JSON.stringify(j))}catch(J){console.warn("Failed to cache JWKS in sessionStorage:",J)}if(j.keys)t(j.keys);else throw new Error("No keys found in the JWKS response")}catch(r){g(`Failed to fetch OIDC configuration or JWKS: ${r instanceof Error?r.message:String(r)}`)}finally{u(!1)}}},E=()=>{x==="jwks"?N():k()},T=()=>{y(x==="jwks"?"https://www.googleapis.com/oauth2/v3/certs":"https://accounts.google.com/.well-known/openid-configuration")},v=(r,n)=>{var j;const c=((j=o==null?void 0:o.header)==null?void 0:j.kid)&&r.kid===o.header.kid;return e.jsxs(D,{className:`mb-4 ${c?"border-green-500 dark:border-green-500":""}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("h4",{className:"font-semibold flex items-center",children:[c&&e.jsx("span",{className:"mr-2 text-green-500",children:"✓ "}),"Key ",r.kid?`ID: ${r.kid}`:n+1]}),e.jsxs("div",{className:"flex gap-2",children:[r.alg&&e.jsx(M,{color:"primary",children:r.alg}),e.jsx(M,{color:"info",children:r.kty}),r.use&&e.jsx(M,{color:"success",children:r.use})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",r.kty]}),r.alg&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Algorithm:"})," ",r.alg]}),r.use&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Use:"})," ",r.use]}),r.key_ops&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Operations:"})," ",r.key_ops.join(", ")]}),r.kty==="RSA"&&r.n&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Modulus (n):"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:r.n})]}),r.kty==="RSA"&&r.e&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Exponent (e):"})," ",r.e]}),r.kty==="EC"&&e.jsxs(e.Fragment,{children:[r.crv&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Curve:"})," ",r.crv]}),r.x&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"X:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:r.x})]}),r.y&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-medium",children:"Y:"}),e.jsx("div",{className:"mt-1 font-mono text-xs bg-gray-50 dark:bg-gray-800 p-1 rounded-md break-all",children:r.y})]})]})]})]},r.kid||n)};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"JWKS Probe"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"URL Type"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"jwks",checked:x==="jwks",onChange:()=>h("jwks"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"JWKS Endpoint"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"oidc",checked:x==="oidc",onChange:()=>h("oidc"),className:"form-radio h-4 w-4 text-blue-600"}),e.jsx("span",{className:"ml-2",children:"OIDC Discovery"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"jwks-url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:x==="jwks"?"JWKS URL":"OIDC Discovery URL"}),e.jsxs("div",{className:"flex",children:[e.jsx(H,{id:"jwks-url",value:i,onChange:r=>y(r.target.value),placeholder:x==="jwks"?"https://example.com/.well-known/jwks.json":"https://example.com/.well-known/openid-configuration",className:"flex-grow"}),e.jsx(R,{onClick:T,variant:"light",className:"ml-2",children:"Sample"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:x==="jwks"?"Direct URL to a JWKS endpoint containing public keys":"URL to an OpenID Connect discovery document"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(R,{onClick:E,variant:"primary",disabled:!i||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(V,{size:"sm",className:"mr-2"}),"Fetching..."]}):"Fetch Keys"})})]})]}),a&&e.jsx(L,{type:"error",className:"mb-6",children:a}),l&&e.jsxs(D,{className:"mb-6",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"OIDC Configuration"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.issuer&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Issuer:"})," ",l.issuer]}),l.jwks_uri&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"JWKS URI:"})," ",l.jwks_uri]}),l.token_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Token Endpoint:"})," ",l.token_endpoint]}),l.authorization_endpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Authorization Endpoint:"})," ",l.authorization_endpoint]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(R,{variant:"light",onClick:()=>{const r=JSON.stringify(l,null,2);navigator.clipboard.writeText(r)},children:"Copy Full Config"})})]})]}),s.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Keys Found (",s.length,")"]}),A&&((w=o==null?void 0:o.header)==null?void 0:w.kid)&&e.jsxs(M,{color:"success",children:["Found matching key for KID: ",o.header.kid]})]}),s.map((r,n)=>v(r,n))]})]})},Ie=({onRun:m})=>{const[o,i]=f.useState([]),[y,x]=f.useState(!1),[h,b]=f.useState(null),u=[{name:"HS256",category:"sign"},{name:"HS384",category:"sign"},{name:"HS512",category:"sign"},{name:"RS256",category:"sign"},{name:"RS384",category:"sign"},{name:"RS512",category:"sign"},{name:"ES256",category:"sign"},{name:"ES384",category:"sign"},{name:"ES512",category:"sign"}],s=async()=>{x(!0),b(null),i([]);try{const a=[],g={alg:"none",typ:"JWT"},A={sub:"1234567890",name:"John Doe",iat:1516239022};for(const S of u){try{const N=await oe(S.name);a.push({algorithm:S.name,opsPerSecond:N,category:S.category})}catch(N){a.push({algorithm:S.name,opsPerSecond:0,error:N instanceof Error?N.message:String(N),category:S.category})}i([...a])}}catch(a){b(`Benchmark error: ${a instanceof Error?a.message:String(a)}`)}finally{x(!1)}m&&m()},t=Math.max(...o.map(a=>a.opsPerSecond),100),l=o.filter(a=>a.category==="sign"),d=o.filter(a=>a.category==="verify");return e.jsxs(D,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"JWT Algorithm Benchmark"}),e.jsx(R,{variant:"primary",onClick:s,disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(V,{size:"sm",className:"mr-2"}),"Running..."]}):"Run Benchmark"})]}),e.jsxs("div",{className:"p-4",children:[h&&e.jsx("div",{className:"p-3 mb-4 bg-red-50 dark:bg-red-900/20 rounded-md border border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-red-800 dark:text-red-300 text-sm",children:h})}),y&&!o.length&&e.jsxs("div",{className:"py-12 flex flex-col items-center justify-center text-gray-500 dark:text-gray-400",children:[e.jsx(V,{size:"lg",className:"mb-4"}),e.jsx("p",{children:"Initializing benchmark tests..."}),e.jsx("p",{className:"text-sm mt-1",children:"This may take a few moments"})]}),o.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"mb-4 text-sm text-gray-500 dark:text-gray-400",children:"Results show operations per second. Higher is better. Tests run in this browser."}),e.jsx("h4",{className:"font-semibold mb-2",children:"Signing Performance"}),e.jsx("div",{className:"mb-6",children:l.map((a,g)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"w-16 font-medium",children:a.algorithm}),e.jsx("div",{className:"flex-grow",children:e.jsx("div",{className:"h-6 bg-gray-100 dark:bg-gray-800 rounded-sm overflow-hidden",children:e.jsx("div",{className:`h-full ${a.error?"bg-red-500":"bg-blue-500"}`,style:{width:`${a.opsPerSecond/t*100}%`}})})}),e.jsx("span",{className:"ml-2 w-24 text-right font-mono text-sm",children:a.error?"Error":Math.round(a.opsPerSecond).toLocaleString()})]}),a.error&&e.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs ml-16",children:a.error})]},g))}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Verification Performance"}),e.jsx("div",{children:d.map((a,g)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"w-16 font-medium",children:a.algorithm}),e.jsx("div",{className:"flex-grow",children:e.jsx("div",{className:"h-6 bg-gray-100 dark:bg-gray-800 rounded-sm overflow-hidden",children:e.jsx("div",{className:`h-full ${a.error?"bg-red-500":"bg-green-500"}`,style:{width:`${a.opsPerSecond/t*100}%`}})})}),e.jsx("span",{className:"ml-2 w-24 text-right font-mono text-sm",children:a.error?"Error":Math.round(a.opsPerSecond).toLocaleString()})]}),a.error&&e.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs ml-16",children:a.error})]},g))})]}),e.jsxs("div",{className:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"System:"}),e.jsx("span",{className:"ml-2 text-sm",children:navigator.userAgent})]}),e.jsx("div",{children:e.jsx(M,{color:"info",children:new Date().toLocaleString()})})]})]}),!y&&o.length===0&&e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:'Click "Run Benchmark" to test JWT algorithm performance in your browser.'})]})]})},De=()=>e.jsx(Ae,{children:e.jsxs(be,{children:[e.jsx(W,{path:"/",element:e.jsx(ke,{})}),e.jsx(W,{path:"/build",element:e.jsx(Ee,{})}),e.jsx(W,{path:"/inspect",element:e.jsx(Re,{})}),e.jsx(W,{path:"/jwks",element:e.jsx(Je,{})}),e.jsx(W,{path:"/benchmark",element:e.jsx(Ie,{})}),e.jsx(W,{path:"*",element:e.jsx(ve,{to:"/jwt"})})]})}),Oe={id:"jwt",title:"JWT Toolkit",description:"Comprehensive tool suite for JSON Web Tokens",route:"/jwt",icon:()=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e.jsx("path",{d:"M12 0L1.604 6v12L12 24l10.396-6V6L12 0zm-1 20.5v-17l9 5.2v6.6l-9 5.2z"})}),component:f.lazy(()=>Promise.resolve({default:()=>e.jsx(e.Fragment,{})})),category:"Security",metadata:{keywords:["jwt","token","authentication","json web token"]},uiOptions:{fullWidth:!0}},Pe=()=>{const m=we(),i=Ne().pathname.split("/jwt")[1]||"/",y=[{id:"/",label:"Decoder",title:"Decode & Verify JWT Tokens"},{id:"/inspect",label:"Inspector",title:"Deep Inspection & Security Analysis"},{id:"/build",label:"Builder",title:"Create & Sign JWT Tokens"},{id:"/jwks",label:"JWKS",title:"JWKS Tool & Public Key Discovery"},{id:"/benchmark",label:"Performance",title:"Algorithm Performance Benchmarks"}],x=u=>{m(`/jwt${u}`)},h="JWT Toolkit | MyDebugger",b="Complete JWT toolkit for developers: decode, create, inspect, verify and benchmark JSON Web Tokens with our comprehensive suite of JWT tools.";return e.jsxs(e.Fragment,{children:[e.jsxs(re,{children:[e.jsx("title",{children:h}),e.jsx("meta",{name:"description",content:b}),e.jsx("meta",{property:"og:title",content:h}),e.jsx("meta",{property:"og:description",content:b}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:url",content:"https://mydebugger.vercel.app/jwt"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:h}),e.jsx("meta",{name:"twitter:description",content:b}),e.jsx("link",{rel:"canonical",href:"https://mydebugger.vercel.app/jwt"})]}),e.jsx(je,{tool:Oe,children:e.jsxs(D,{className:"p-0 overflow-visible",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx(Y,{activeTab:i,onChange:x,children:y.map(u=>e.jsx(z,{id:u.id,isActive:i===u.id,children:u.label},u.id))})}),e.jsx("div",{className:"p-5",children:e.jsx(De,{})})]})})]})};export{Pe as default};
//# sourceMappingURL=JwtToolkit-b3514de2.js.map
